<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Impala: impala::ChildQuery Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Impala
   </div>
   <div id="projectbrief">Impalaistheopensource,nativeanalyticdatabaseforApacheHadoop.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classimpala_1_1ChildQuery.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classimpala_1_1ChildQuery-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">impala::ChildQuery Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="child-query_8h_source.html">child-query.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for impala::ChildQuery:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classimpala_1_1ChildQuery__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3b1a869f0d723357fefd2ba3684073b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a3b1a869f0d723357fefd2ba3684073b5">ChildQuery</a> (const std::string &amp;query, <a class="el" href="classimpala_1_1ImpalaServer_1_1QueryExecState.html">ImpalaServer::QueryExecState</a> *parent_exec_state, <a class="el" href="classimpala_1_1ImpalaServer.html">ImpalaServer</a> *parent_server)</td></tr>
<tr class="separator:a3b1a869f0d723357fefd2ba3684073b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab373db9d817d294cb185ec61bdd03877"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#ab373db9d817d294cb185ec61bdd03877">ChildQuery</a> (const <a class="el" href="classimpala_1_1ChildQuery.html">ChildQuery</a> &amp;other)</td></tr>
<tr class="separator:ab373db9d817d294cb185ec61bdd03877"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33bffa929b2780c42dce4a8f8caca6b1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ChildQuery.html">ChildQuery</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a33bffa929b2780c42dce4a8f8caca6b1">operator=</a> (const <a class="el" href="classimpala_1_1ChildQuery.html">ChildQuery</a> &amp;other)</td></tr>
<tr class="separator:a33bffa929b2780c42dce4a8f8caca6b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a528d42ce334d1328fc597bbfe981a0b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a528d42ce334d1328fc597bbfe981a0b7">ExecAndFetch</a> ()</td></tr>
<tr class="memdesc:a528d42ce334d1328fc597bbfe981a0b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes this child query through HiveServer2 and fetches all its results.  <a href="#a528d42ce334d1328fc597bbfe981a0b7">More...</a><br/></td></tr>
<tr class="separator:a528d42ce334d1328fc597bbfe981a0b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4319b30a652d4e4f0d86a9771a551a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#ae4319b30a652d4e4f0d86a9771a551a6">Cancel</a> ()</td></tr>
<tr class="separator:ae4319b30a652d4e4f0d86a9771a551a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb1f6e6142204639521adf761d47ecfa"><td class="memItemLeft" align="right" valign="top">const <br class="typebreak"/>
apache::hive::service::cli::thrift::TTableSchema &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#abb1f6e6142204639521adf761d47ecfa">result_schema</a> ()</td></tr>
<tr class="separator:abb1f6e6142204639521adf761d47ecfa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa27af1c4faca20806a5d8dcbd0b4f6f6"><td class="memItemLeft" align="right" valign="top">const <br class="typebreak"/>
apache::hive::service::cli::thrift::TRowSet &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#aa27af1c4faca20806a5d8dcbd0b4f6f6">result_data</a> ()</td></tr>
<tr class="separator:aa27af1c4faca20806a5d8dcbd0b4f6f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:aa172384bd0f253e7bd28195f43f9c8ac"><td class="memItemLeft" align="right" valign="top">static const string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#aa172384bd0f253e7bd28195f43f9c8ac">PARENT_QUERY_OPT</a> = &quot;impala.parent_query_id&quot;</td></tr>
<tr class="separator:aa172384bd0f253e7bd28195f43f9c8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ac57a5feee933d86825f35953fda8b9da"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#ac57a5feee933d86825f35953fda8b9da">SetQueryOptions</a> (const TQueryOptions &amp;parent_options, apache::hive::service::cli::thrift::TExecuteStatementReq *exec_stmt_req)</td></tr>
<tr class="separator:ac57a5feee933d86825f35953fda8b9da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcce342aa0eb05c84f2be5b8557c6df5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#afcce342aa0eb05c84f2be5b8557c6df5">IsCancelled</a> ()</td></tr>
<tr class="separator:afcce342aa0eb05c84f2be5b8557c6df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a67413c24015ebdbd5811b838444b7994"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a67413c24015ebdbd5811b838444b7994">query_</a></td></tr>
<tr class="memdesc:a67413c24015ebdbd5811b838444b7994"><td class="mdescLeft">&#160;</td><td class="mdescRight">SQL string to be executed.  <a href="#a67413c24015ebdbd5811b838444b7994">More...</a><br/></td></tr>
<tr class="separator:a67413c24015ebdbd5811b838444b7994"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e0cded40004c152f7b256edf4c88c2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ImpalaServer_1_1QueryExecState.html">ImpalaServer::QueryExecState</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a6e0cded40004c152f7b256edf4c88c2e">parent_exec_state_</a></td></tr>
<tr class="separator:a6e0cded40004c152f7b256edf4c88c2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a2f992f447f1d7f1e2da296473daf7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ImpalaServer.html">ImpalaServer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a0a2f992f447f1d7f1e2da296473daf7e">parent_server_</a></td></tr>
<tr class="memdesc:a0a2f992f447f1d7f1e2da296473daf7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parent Impala server used for executing this child query. Not owned.  <a href="#a0a2f992f447f1d7f1e2da296473daf7e">More...</a><br/></td></tr>
<tr class="separator:a0a2f992f447f1d7f1e2da296473daf7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3776ae37ecc1aa5a16af22b753586ce"><td class="memItemLeft" align="right" valign="top">apache::hive::service::cli::thrift::TGetResultSetMetadataResp&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#ab3776ae37ecc1aa5a16af22b753586ce">meta_resp_</a></td></tr>
<tr class="memdesc:ab3776ae37ecc1aa5a16af22b753586ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Result metadata and result rows of query.  <a href="#ab3776ae37ecc1aa5a16af22b753586ce">More...</a><br/></td></tr>
<tr class="separator:ab3776ae37ecc1aa5a16af22b753586ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb0c9eeb3f5ec9da2b58a1e08304cc15"><td class="memItemLeft" align="right" valign="top">apache::hive::service::cli::thrift::TFetchResultsResp&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#acb0c9eeb3f5ec9da2b58a1e08304cc15">fetch_resp_</a></td></tr>
<tr class="separator:acb0c9eeb3f5ec9da2b58a1e08304cc15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4162a7a72b72046d94509f61cf611a2b"><td class="memItemLeft" align="right" valign="top">apache::hive::service::cli::thrift::TOperationHandle&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a4162a7a72b72046d94509f61cf611a2b">hs2_handle_</a></td></tr>
<tr class="memdesc:a4162a7a72b72046d94509f61cf611a2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">HS2 query handle. Set in ExecChildQuery().  <a href="#a4162a7a72b72046d94509f61cf611a2b">More...</a><br/></td></tr>
<tr class="separator:a4162a7a72b72046d94509f61cf611a2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6b525cf48862752b436f001991561f3"><td class="memItemLeft" align="right" valign="top">boost::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#af6b525cf48862752b436f001991561f3">lock_</a></td></tr>
<tr class="memdesc:af6b525cf48862752b436f001991561f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protects is_running_ and is_cancelled_ to ensure idempotent cancellations.  <a href="#af6b525cf48862752b436f001991561f3">More...</a><br/></td></tr>
<tr class="separator:af6b525cf48862752b436f001991561f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fca71bf8236931e99fdc5c3c1ca46c5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#a8fca71bf8236931e99fdc5c3c1ca46c5">is_running_</a></td></tr>
<tr class="separator:a8fca71bf8236931e99fdc5c3c1ca46c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a3363a1bb78a9061bf3b01a6268e94"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ChildQuery.html#aa0a3363a1bb78a9061bf3b01a6268e94">is_cancelled_</a></td></tr>
<tr class="memdesc:aa0a3363a1bb78a9061bf3b01a6268e94"><td class="mdescLeft">&#160;</td><td class="mdescRight">Indicates whether this child query has been cancelled. Set in <a class="el" href="classimpala_1_1ChildQuery.html#ae4319b30a652d4e4f0d86a9771a551a6">Cancel()</a>.  <a href="#aa0a3363a1bb78a9061bf3b01a6268e94">More...</a><br/></td></tr>
<tr class="separator:aa0a3363a1bb78a9061bf3b01a6268e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Child queries are used for implementing statements that consist of one or several query statements (e.g., compute stats) that require independent query handles for fetching results. Such queries are 'children' of a parent exec state in the sense that they are executed in the same session and that child queries are cancelled if the parent is cancelled (but not necessarily vice versa). For simplicity and consistency, child queries are always executed via HiveServer2, regardless of whether the parent session is Beeswax or HiveServer2. Parent queries are expected to call ExecAndWait() of a child query in a separate thread, and then join that thread to wait for child-query completion. The parent QueryExecState is independent of the child query's QueryExecState, with the exception that the child query selectively checks the parent's status for failure/cancellation detection. Child queries should never call into their parent's QueryExecState to avoid deadlock. TODO: Compute stats is the only stmt that requires child queries. Once the CatalogService performs background stats gathering the concept of child queries will likely become obsolete. Remove this class and all child-query related code. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00047">47</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a3b1a869f0d723357fefd2ba3684073b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">impala::ChildQuery::ChildQuery </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>query</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ImpalaServer_1_1QueryExecState.html">ImpalaServer::QueryExecState</a> *&#160;</td>
          <td class="paramname"><em>parent_exec_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ImpalaServer.html">ImpalaServer</a> *&#160;</td>
          <td class="paramname"><em>parent_server</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00049">49</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>References <a class="el" href="child-query_8h_source.html#l00119">parent_exec_state_</a>, <a class="el" href="child-query_8h_source.html#l00122">parent_server_</a>, and <a class="el" href="child-query_8h_source.html#l00115">query_</a>.</p>

</div>
</div>
<a class="anchor" id="ab373db9d817d294cb185ec61bdd03877"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">impala::ChildQuery::ChildQuery </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classimpala_1_1ChildQuery.html">ChildQuery</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allow child queries to be added to std collections. (boost::mutex's operator= and copy c'tor are private) </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00063">63</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae4319b30a652d4e4f0d86a9771a551a6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ChildQuery::Cancel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Cancels and closes the given child query if it is running. Sets is_cancelled_. Child queries can be cancelled by the parent query through <a class="el" href="namespaceimpala.html#a508481848105bae62dd5722fd747572a">QueryExecState::Cancel()</a>. Child queries should never cancel their parent to avoid deadlock (but the parent query may decide to cancel itself based on a non-OK status from a child query). Note that child queries have a different QueryExecState than their parent query, so cancellation of a child query does not call into the parent's QueryExecState. </p>

<p>Definition at line <a class="el" href="child-query_8cc_source.html#l00158">158</a> of file <a class="el" href="child-query_8cc_source.html">child-query.cc</a>.</p>

<p>References <a class="el" href="coordinator_8h_source.html#l00233">impala::lock_</a>, and <a class="el" href="logging_8h_source.html#l00057">VLOG_QUERY</a>.</p>

<p>Referenced by <a class="el" href="query-exec-state_8cc_source.html#l00778">impala::ImpalaServer::QueryExecState::Cancel()</a>.</p>

</div>
</div>
<a class="anchor" id="a528d42ce334d1328fc597bbfe981a0b7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ChildQuery::ExecAndFetch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes this child query through HiveServer2 and fetches all its results. </p>

<p>Definition at line <a class="el" href="child-query_8cc_source.html#l00032">32</a> of file <a class="el" href="child-query_8cc_source.html">child-query.cc</a>.</p>

<p>References <a class="el" href="coordinator_8h_source.html#l00233">impala::lock_</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="debug-util_8cc_source.html#l00097">impala::PrintId()</a>, <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>, <a class="el" href="impala-server_8inline_8h_source.html#l00040">impala::ImpalaServer::TUniqueIdToTHandleIdentifier()</a>, and <a class="el" href="logging_8h_source.html#l00057">VLOG_QUERY</a>.</p>

</div>
</div>
<a class="anchor" id="afcce342aa0eb05c84f2be5b8557c6df5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ChildQuery::IsCancelled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns Status::Cancelled if this child query has been cancelled, otherwise OK. Acquires lock_. </p>

<p>Definition at line <a class="el" href="child-query_8cc_source.html#l00179">179</a> of file <a class="el" href="child-query_8cc_source.html">child-query.cc</a>.</p>

<p>References <a class="el" href="status_8h_source.html#l00088">impala::Status::CANCELLED</a>, <a class="el" href="coordinator_8h_source.html#l00233">impala::lock_</a>, and <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>.</p>

</div>
</div>
<a class="anchor" id="a33bffa929b2780c42dce4a8f8caca6b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ChildQuery.html">ChildQuery</a>&amp; impala::ChildQuery::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classimpala_1_1ChildQuery.html">ChildQuery</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Allow child queries to be added to std collections. (boost::mutex's operator= and copy c'tor are private) </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00072">72</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>References <a class="el" href="child-query_8h_source.html#l00139">is_cancelled_</a>, <a class="el" href="child-query_8h_source.html#l00136">is_running_</a>, <a class="el" href="child-query_8h_source.html#l00119">parent_exec_state_</a>, <a class="el" href="child-query_8h_source.html#l00122">parent_server_</a>, and <a class="el" href="child-query_8h_source.html#l00115">query_</a>.</p>

</div>
</div>
<a class="anchor" id="aa27af1c4faca20806a5d8dcbd0b4f6f6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const apache::hive::service::cli::thrift::TRowSet&amp; impala::ChildQuery::result_data </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00096">96</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>References <a class="el" href="child-query_8h_source.html#l00126">fetch_resp_</a>.</p>

</div>
</div>
<a class="anchor" id="abb1f6e6142204639521adf761d47ecfa"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const apache::hive::service::cli::thrift::TTableSchema&amp; impala::ChildQuery::result_schema </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00092">92</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>References <a class="el" href="child-query_8h_source.html#l00125">meta_resp_</a>.</p>

</div>
</div>
<a class="anchor" id="ac57a5feee933d86825f35953fda8b9da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ChildQuery::SetQueryOptions </td>
          <td>(</td>
          <td class="paramtype">const TQueryOptions &amp;&#160;</td>
          <td class="paramname"><em>parent_options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">apache::hive::service::cli::thrift::TExecuteStatementReq *&#160;</td>
          <td class="paramname"><em>exec_stmt_req</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets the query options from the parent query in child's HS2 request. TODO: Consider moving this function into a more appropriate place. </p>

<p>Definition at line <a class="el" href="child-query_8cc_source.html#l00119">119</a> of file <a class="el" href="child-query_8cc_source.html">child-query.cc</a>.</p>

<p>References <a class="el" href="buffered-tuple-stream-test_8cc_source.html#l00039">BATCH_SIZE</a>, and <a class="el" href="child-query_8cc_source.html#l00113">SET_QUERY_OPTION</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="acb0c9eeb3f5ec9da2b58a1e08304cc15"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">apache::hive::service::cli::thrift::TFetchResultsResp impala::ChildQuery::fetch_resp_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00126">126</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>Referenced by <a class="el" href="child-query_8h_source.html#l00096">result_data()</a>.</p>

</div>
</div>
<a class="anchor" id="a4162a7a72b72046d94509f61cf611a2b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">apache::hive::service::cli::thrift::TOperationHandle impala::ChildQuery::hs2_handle_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>HS2 query handle. Set in ExecChildQuery(). </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00129">129</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa0a3363a1bb78a9061bf3b01a6268e94"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> impala::ChildQuery::is_cancelled_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Indicates whether this child query has been cancelled. Set in <a class="el" href="classimpala_1_1ChildQuery.html#ae4319b30a652d4e4f0d86a9771a551a6">Cancel()</a>. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00139">139</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>Referenced by <a class="el" href="child-query_8h_source.html#l00072">operator=()</a>.</p>

</div>
</div>
<a class="anchor" id="a8fca71bf8236931e99fdc5c3c1ca46c5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> impala::ChildQuery::is_running_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indicates whether this query is running. False if the query has not started yet or if the query has finished either successfully or because of an error. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00136">136</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>Referenced by <a class="el" href="child-query_8h_source.html#l00072">operator=()</a>.</p>

</div>
</div>
<a class="anchor" id="af6b525cf48862752b436f001991561f3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::mutex impala::ChildQuery::lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protects is_running_ and is_cancelled_ to ensure idempotent cancellations. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00132">132</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

</div>
</div>
<a class="anchor" id="ab3776ae37ecc1aa5a16af22b753586ce"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">apache::hive::service::cli::thrift::TGetResultSetMetadataResp impala::ChildQuery::meta_resp_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Result metadata and result rows of query. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00125">125</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>Referenced by <a class="el" href="child-query_8h_source.html#l00092">result_schema()</a>.</p>

</div>
</div>
<a class="anchor" id="a6e0cded40004c152f7b256edf4c88c2e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ImpalaServer_1_1QueryExecState.html">ImpalaServer::QueryExecState</a>* impala::ChildQuery::parent_exec_state_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Execution state of parent query. Used to synchronize and propagate parent cancellations/failures to this child query. Not owned. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00119">119</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>Referenced by <a class="el" href="child-query_8h_source.html#l00049">ChildQuery()</a>, and <a class="el" href="child-query_8h_source.html#l00072">operator=()</a>.</p>

</div>
</div>
<a class="anchor" id="aa172384bd0f253e7bd28195f43f9c8ac"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const string impala::ChildQuery::PARENT_QUERY_OPT = &quot;impala.parent_query_id&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The key in the HS2 conf overlay which indicates to the executing <a class="el" href="classimpala_1_1ImpalaServer.html">ImpalaServer</a> that this query is a child query. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00102">102</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

</div>
</div>
<a class="anchor" id="a0a2f992f447f1d7f1e2da296473daf7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ImpalaServer.html">ImpalaServer</a>* impala::ChildQuery::parent_server_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Parent Impala server used for executing this child query. Not owned. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00122">122</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>Referenced by <a class="el" href="child-query_8h_source.html#l00049">ChildQuery()</a>, and <a class="el" href="child-query_8h_source.html#l00072">operator=()</a>.</p>

</div>
</div>
<a class="anchor" id="a67413c24015ebdbd5811b838444b7994"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string impala::ChildQuery::query_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>SQL string to be executed. </p>

<p>Definition at line <a class="el" href="child-query_8h_source.html#l00115">115</a> of file <a class="el" href="child-query_8h_source.html">child-query.h</a>.</p>

<p>Referenced by <a class="el" href="child-query_8h_source.html#l00049">ChildQuery()</a>, and <a class="el" href="child-query_8h_source.html#l00072">operator=()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>be/src/service/<a class="el" href="child-query_8h_source.html">child-query.h</a></li>
<li>be/src/service/<a class="el" href="child-query_8cc_source.html">child-query.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceimpala.html">impala</a></li><li class="navelem"><a class="el" href="classimpala_1_1ChildQuery.html">ChildQuery</a></li>
    <li class="footer">Generated on Thu May 7 2015 16:10:50 for Impala by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
