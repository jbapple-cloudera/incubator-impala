<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Impala: impala::DiskIoMgr Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Impala
   </div>
   <div id="projectbrief">Impalaistheopensource,nativeanalyticdatabaseforApacheHadoop.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classimpala_1_1DiskIoMgr.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classimpala_1_1DiskIoMgr-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">impala::DiskIoMgr Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for impala::DiskIoMgr:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classimpala_1_1DiskIoMgr__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Per disk state.  <a href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDiskIoMgr_1_1RequestContextCache.html">RequestContextCache</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestRange.html">RequestRange</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structimpala_1_1DiskIoMgr_1_1RequestType.html">RequestType</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The request type, read or write associated with a request range.  <a href="structimpala_1_1DiskIoMgr_1_1RequestType.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:aabb61890cd37be80703ae735e2a075ad"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="classimpala_1_1DiskIoMgr.html#aabb61890cd37be80703ae735e2a075ada4dce4311f2a962cc1e369379f9ffedf2">REMOTE_S3_DISK_OFFSET</a> = 0, 
<a class="el" href="classimpala_1_1DiskIoMgr.html#aabb61890cd37be80703ae735e2a075adaf2d4abf2fb7cedd9b81575e18d2a361a">REMOTE_NUM_DISKS</a>
 }</td></tr>
<tr class="separator:aabb61890cd37be80703ae735e2a075ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aaccc2eb380dbc73014211774b4ac4fb1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#aaccc2eb380dbc73014211774b4ac4fb1">DiskIoMgr</a> (int num_disks, int threads_per_disk, int min_buffer_size, int max_buffer_size)</td></tr>
<tr class="separator:aaccc2eb380dbc73014211774b4ac4fb1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44032d3a2a6760a534540b0d86c52cc6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a44032d3a2a6760a534540b0d86c52cc6">DiskIoMgr</a> ()</td></tr>
<tr class="memdesc:a44032d3a2a6760a534540b0d86c52cc6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create <a class="el" href="classimpala_1_1DiskIoMgr.html">DiskIoMgr</a> with default configs.  <a href="#a44032d3a2a6760a534540b0d86c52cc6">More...</a><br/></td></tr>
<tr class="separator:a44032d3a2a6760a534540b0d86c52cc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8e9f578c5a9e278add1859d37cbd08a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ac8e9f578c5a9e278add1859d37cbd08a">~DiskIoMgr</a> ()</td></tr>
<tr class="separator:ac8e9f578c5a9e278add1859d37cbd08a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1991e70528bab13363e3592d174d7a12"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a1991e70528bab13363e3592d174d7a12">Init</a> (<a class="el" href="classimpala_1_1MemTracker.html">MemTracker</a> *process_mem_tracker)</td></tr>
<tr class="memdesc:a1991e70528bab13363e3592d174d7a12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the IoMgr. Must be called once before any of the other APIs.  <a href="#a1991e70528bab13363e3592d174d7a12">More...</a><br/></td></tr>
<tr class="separator:a1991e70528bab13363e3592d174d7a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47f9eb99e3e705017d17dffddbea38b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a47f9eb99e3e705017d17dffddbea38b2">RegisterContext</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> **request_context, <a class="el" href="classimpala_1_1MemTracker.html">MemTracker</a> *reader_mem_tracker=NULL)</td></tr>
<tr class="separator:a47f9eb99e3e705017d17dffddbea38b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcb3619688e18e6453177dc8bb85e565"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#abcb3619688e18e6453177dc8bb85e565">UnregisterContext</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *context)</td></tr>
<tr class="separator:abcb3619688e18e6453177dc8bb85e565"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0101ab194607143c4e79baaf7a914a64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a0101ab194607143c4e79baaf7a914a64">CancelContext</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *context, <a class="el" href="classbool.html">bool</a> wait_for_disks_completion=false)</td></tr>
<tr class="separator:a0101ab194607143c4e79baaf7a914a64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a1a246f28ee5f8214cfdfd2dd8aa42"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#aa6a1a246f28ee5f8214cfdfd2dd8aa42">AddScanRanges</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader, const std::vector&lt; <a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> * &gt; &amp;ranges, <a class="el" href="classbool.html">bool</a> schedule_immediately=false)</td></tr>
<tr class="separator:aa6a1a246f28ee5f8214cfdfd2dd8aa42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89284efc0d973c8df0e51ca3238c6b52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a89284efc0d973c8df0e51ca3238c6b52">AddWriteRange</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *writer, <a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *write_range)</td></tr>
<tr class="separator:a89284efc0d973c8df0e51ca3238c6b52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cc61c88ae6cbb96791d71aee1664137"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a3cc61c88ae6cbb96791d71aee1664137">GetNextRange</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader, <a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> **range)</td></tr>
<tr class="separator:a3cc61c88ae6cbb96791d71aee1664137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a501f1ef0a0ddce1507c99b8cf78745d2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a501f1ef0a0ddce1507c99b8cf78745d2">Read</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader, <a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *range, <a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> **buffer)</td></tr>
<tr class="separator:a501f1ef0a0ddce1507c99b8cf78745d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab92e887bc1867272f1d0ce80f09bfe11"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ab92e887bc1867272f1d0ce80f09bfe11">AssignQueue</a> (const char *file, int disk_id, <a class="el" href="classbool.html">bool</a> expected_local)</td></tr>
<tr class="separator:ab92e887bc1867272f1d0ce80f09bfe11"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ce912576b754a61f9e1b61f2d2b4ea"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ac5ce912576b754a61f9e1b61f2d2b4ea">context_status</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *context) const </td></tr>
<tr class="separator:ac5ce912576b754a61f9e1b61f2d2b4ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05a2eca77321958ca3e6e3784ab2efcc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a05a2eca77321958ca3e6e3784ab2efcc">num_unstarted_ranges</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader) const </td></tr>
<tr class="memdesc:a05a2eca77321958ca3e6e3784ab2efcc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of unstarted scan ranges for this reader.  <a href="#a05a2eca77321958ca3e6e3784ab2efcc">More...</a><br/></td></tr>
<tr class="separator:a05a2eca77321958ca3e6e3784ab2efcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abcf20ad952f31d948888d9834b64dd94"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#abcf20ad952f31d948888d9834b64dd94">set_bytes_read_counter</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *, <a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *)</td></tr>
<tr class="separator:abcf20ad952f31d948888d9834b64dd94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f81e48ed3492b090a38a8ac9d90cc97"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a9f81e48ed3492b090a38a8ac9d90cc97">set_read_timer</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *, <a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *)</td></tr>
<tr class="separator:a9f81e48ed3492b090a38a8ac9d90cc97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b9c885f997c1151fcb889f727d41fdb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a8b9c885f997c1151fcb889f727d41fdb">set_active_read_thread_counter</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *, <a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *)</td></tr>
<tr class="separator:a8b9c885f997c1151fcb889f727d41fdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b7a12de61dd80ed3b3163192c3cac19"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a7b7a12de61dd80ed3b3163192c3cac19">set_disks_access_bitmap</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *, <a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *)</td></tr>
<tr class="separator:a7b7a12de61dd80ed3b3163192c3cac19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a263b162de531fc234e80ab3b6fc68d6c"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a263b162de531fc234e80ab3b6fc68d6c">queue_size</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader) const </td></tr>
<tr class="separator:a263b162de531fc234e80ab3b6fc68d6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22f6b26648d0b3878e417cf087b2ee89"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a22f6b26648d0b3878e417cf087b2ee89">bytes_read_local</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader) const </td></tr>
<tr class="separator:a22f6b26648d0b3878e417cf087b2ee89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab00029212e1b92f2ecb6014c63c204a2"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ab00029212e1b92f2ecb6014c63c204a2">bytes_read_short_circuit</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader) const </td></tr>
<tr class="separator:ab00029212e1b92f2ecb6014c63c204a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62c6a7658886cefdb5e84e867da6352f"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a62c6a7658886cefdb5e84e867da6352f">bytes_read_dn_cache</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader) const </td></tr>
<tr class="separator:a62c6a7658886cefdb5e84e867da6352f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79bb53859930e7386542d11490c69cff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a79bb53859930e7386542d11490c69cff">num_remote_ranges</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader) const </td></tr>
<tr class="separator:a79bb53859930e7386542d11490c69cff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d1b000a66d4456365e4f9fbf6cb896f"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a1d1b000a66d4456365e4f9fbf6cb896f">unexpected_remote_bytes</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader) const </td></tr>
<tr class="separator:a1d1b000a66d4456365e4f9fbf6cb896f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cad7a32492c51d29a1383d5644c7415"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a8cad7a32492c51d29a1383d5644c7415">GetReadThroughput</a> ()</td></tr>
<tr class="separator:a8cad7a32492c51d29a1383d5644c7415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d68607c8cf8f9003f47891af6627103"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a4d68607c8cf8f9003f47891af6627103">max_read_buffer_size</a> () const </td></tr>
<tr class="memdesc:a4d68607c8cf8f9003f47891af6627103"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the maximum read buffer size.  <a href="#a4d68607c8cf8f9003f47891af6627103">More...</a><br/></td></tr>
<tr class="separator:a4d68607c8cf8f9003f47891af6627103"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c99177a95caa67739c8815c55eb3491"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a3c99177a95caa67739c8815c55eb3491">num_total_disks</a> () const </td></tr>
<tr class="memdesc:a3c99177a95caa67739c8815c55eb3491"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total number of disk queues (both local and remote).  <a href="#a3c99177a95caa67739c8815c55eb3491">More...</a><br/></td></tr>
<tr class="separator:a3c99177a95caa67739c8815c55eb3491"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2881c4eba0bb95ca79de096e0e68b5b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a2881c4eba0bb95ca79de096e0e68b5b1">num_remote_disks</a> () const </td></tr>
<tr class="memdesc:a2881c4eba0bb95ca79de096e0e68b5b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total number of remote "disk" queues.  <a href="#a2881c4eba0bb95ca79de096e0e68b5b1">More...</a><br/></td></tr>
<tr class="separator:a2881c4eba0bb95ca79de096e0e68b5b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a6605b8b52c766d1489af89f0a2ac43"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a3a6605b8b52c766d1489af89f0a2ac43">num_local_disks</a> () const </td></tr>
<tr class="memdesc:a3a6605b8b52c766d1489af89f0a2ac43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of local disks attached to the system.  <a href="#a3a6605b8b52c766d1489af89f0a2ac43">More...</a><br/></td></tr>
<tr class="separator:a3a6605b8b52c766d1489af89f0a2ac43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f67b5041cef54b924855720f877883f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a7f67b5041cef54b924855720f877883f">RemoteS3DiskId</a> () const </td></tr>
<tr class="memdesc:a7f67b5041cef54b924855720f877883f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The disk ID (and therefore disk_queues_ index) used for S3 accesses.  <a href="#a7f67b5041cef54b924855720f877883f">More...</a><br/></td></tr>
<tr class="separator:a7f67b5041cef54b924855720f877883f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab59d92f6e237fcc86112fd39d56196fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ab59d92f6e237fcc86112fd39d56196fe">num_allocated_buffers</a> () const </td></tr>
<tr class="memdesc:ab59d92f6e237fcc86112fd39d56196fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of allocated buffers.  <a href="#ab59d92f6e237fcc86112fd39d56196fe">More...</a><br/></td></tr>
<tr class="separator:ab59d92f6e237fcc86112fd39d56196fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54bb2885167cd44d2ca2469d28f0fa52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a54bb2885167cd44d2ca2469d28f0fa52">num_buffers_in_readers</a> () const </td></tr>
<tr class="memdesc:a54bb2885167cd44d2ca2469d28f0fa52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of buffers currently owned by all readers.  <a href="#a54bb2885167cd44d2ca2469d28f0fa52">More...</a><br/></td></tr>
<tr class="separator:a54bb2885167cd44d2ca2469d28f0fa52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38bde6fa6ddcd0ae546a3e52e00cb5ff"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a38bde6fa6ddcd0ae546a3e52e00cb5ff">DebugString</a> ()</td></tr>
<tr class="memdesc:a38bde6fa6ddcd0ae546a3e52e00cb5ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dumps the disk IoMgr queues (for readers and disks)  <a href="#a38bde6fa6ddcd0ae546a3e52e00cb5ff">More...</a><br/></td></tr>
<tr class="separator:a38bde6fa6ddcd0ae546a3e52e00cb5ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78c14580725060483f5bbd1aaf24fa29"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a78c14580725060483f5bbd1aaf24fa29">Validate</a> () const </td></tr>
<tr class="separator:a78c14580725060483f5bbd1aaf24fa29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a0ba2f86ddaf75389adb493bdb0001929"><td class="memItemLeft" align="right" valign="top">static const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a0ba2f86ddaf75389adb493bdb0001929">DEFAULT_QUEUE_CAPACITY</a> = 2</td></tr>
<tr class="separator:a0ba2f86ddaf75389adb493bdb0001929"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aca591719005e7c9a0cd8212d52f5e533"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#aca591719005e7c9a0cd8212d52f5e533">free_buffers_idx</a> (int64_t buffer_size)</td></tr>
<tr class="memdesc:aca591719005e7c9a0cd8212d52f5e533"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the index into free_buffers_ for a given buffer size.  <a href="#aca591719005e7c9a0cd8212d52f5e533">More...</a><br/></td></tr>
<tr class="separator:aca591719005e7c9a0cd8212d52f5e533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a234649f13d6930779d0fd6ae871f7bee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a234649f13d6930779d0fd6ae871f7bee">GetBufferDesc</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader, <a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *range, char *buffer, int64_t buffer_size)</td></tr>
<tr class="separator:a234649f13d6930779d0fd6ae871f7bee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af56bacb215e699a478c0a5ceee074712"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#af56bacb215e699a478c0a5ceee074712">ReturnBufferDesc</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *desc)</td></tr>
<tr class="memdesc:af56bacb215e699a478c0a5ceee074712"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a buffer desc object which can now be used for another reader.  <a href="#af56bacb215e699a478c0a5ceee074712">More...</a><br/></td></tr>
<tr class="separator:af56bacb215e699a478c0a5ceee074712"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ce84f3fd78ec5c8492026cd22cd69e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a1ce84f3fd78ec5c8492026cd22cd69e0">ReturnBuffer</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *buffer)</td></tr>
<tr class="separator:a1ce84f3fd78ec5c8492026cd22cd69e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3bba021605906306bbbf5daddf95d95"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#aa3bba021605906306bbbf5daddf95d95">GetFreeBuffer</a> (int64_t *buffer_size)</td></tr>
<tr class="separator:aa3bba021605906306bbbf5daddf95d95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4431510659aedf1fa38e042e4196f415"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a4431510659aedf1fa38e042e4196f415">GcIoBuffers</a> ()</td></tr>
<tr class="separator:a4431510659aedf1fa38e042e4196f415"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad69740225431892ddb15723b3e5211c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ad69740225431892ddb15723b3e5211c4">ReturnFreeBuffer</a> (char *buffer, int64_t buffer_size)</td></tr>
<tr class="separator:ad69740225431892ddb15723b3e5211c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8b902783f74a6cc34ca4ea6d2c0131c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#aa8b902783f74a6cc34ca4ea6d2c0131c">ReturnFreeBuffer</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *desc)</td></tr>
<tr class="separator:aa8b902783f74a6cc34ca4ea6d2c0131c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83daff34ce9a9d8eadbfff528e28eb56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a83daff34ce9a9d8eadbfff528e28eb56">WorkLoop</a> (<a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *queue)</td></tr>
<tr class="separator:a83daff34ce9a9d8eadbfff528e28eb56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8550d90be93435c85ea623ed75c02a6a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a8550d90be93435c85ea623ed75c02a6a">GetNextRequestRange</a> (<a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *disk_queue, <a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestRange.html">RequestRange</a> **range, <a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> **request_context)</td></tr>
<tr class="separator:a8550d90be93435c85ea623ed75c02a6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad953550311c262181c52df319cacf540"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ad953550311c262181c52df319cacf540">HandleReadFinished</a> (<a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *, <a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *, <a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *)</td></tr>
<tr class="separator:ad953550311c262181c52df319cacf540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81d5e5e4dbe9e696deb160e45f6d51fb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a81d5e5e4dbe9e696deb160e45f6d51fb">HandleWriteFinished</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *writer, <a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *write_range, const <a class="el" href="classimpala_1_1Status.html">Status</a> &amp;write_status)</td></tr>
<tr class="separator:a81d5e5e4dbe9e696deb160e45f6d51fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a602c11c00e5824f4b75ca325bcb1ff74"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a602c11c00e5824f4b75ca325bcb1ff74">ValidateScanRange</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *range)</td></tr>
<tr class="memdesc:a602c11c00e5824f4b75ca325bcb1ff74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validates that range is correctly initialized.  <a href="#a602c11c00e5824f4b75ca325bcb1ff74">More...</a><br/></td></tr>
<tr class="separator:a602c11c00e5824f4b75ca325bcb1ff74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767af862da36691ad7b4799b5ad82744"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a767af862da36691ad7b4799b5ad82744">Write</a> (<a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *writer_context, <a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *write_range)</td></tr>
<tr class="separator:a767af862da36691ad7b4799b5ad82744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2be4e061eae7032c992a901a7670465"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#aa2be4e061eae7032c992a901a7670465">WriteRangeHelper</a> (FILE *file_handle, <a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *write_range)</td></tr>
<tr class="separator:aa2be4e061eae7032c992a901a7670465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a053f427bbc4edd04f30c17410ff66a27"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a053f427bbc4edd04f30c17410ff66a27">ReadRange</a> (<a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *disk_queue, <a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *reader, <a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *range)</td></tr>
<tr class="memdesc:a053f427bbc4edd04f30c17410ff66a27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the specified scan range and calls HandleReadFinished when done.  <a href="#a053f427bbc4edd04f30c17410ff66a27">More...</a><br/></td></tr>
<tr class="separator:a053f427bbc4edd04f30c17410ff66a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0ca2db2159fc27588ea77dc43c6b32f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ObjectPool.html">ObjectPool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a0ca2db2159fc27588ea77dc43c6b32f1">pool_</a></td></tr>
<tr class="memdesc:a0ca2db2159fc27588ea77dc43c6b32f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Pool to allocate BufferDescriptors.  <a href="#a0ca2db2159fc27588ea77dc43c6b32f1">More...</a><br/></td></tr>
<tr class="separator:a0ca2db2159fc27588ea77dc43c6b32f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90831aea936eafbc9ad831dbfddcf25a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1MemTracker.html">MemTracker</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a90831aea936eafbc9ad831dbfddcf25a">process_mem_tracker_</a></td></tr>
<tr class="memdesc:a90831aea936eafbc9ad831dbfddcf25a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process memory tracker; needed to account for io buffers.  <a href="#a90831aea936eafbc9ad831dbfddcf25a">More...</a><br/></td></tr>
<tr class="separator:a90831aea936eafbc9ad831dbfddcf25a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57d6bef4f87965d26ae0f3ebdb2f747b"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a57d6bef4f87965d26ae0f3ebdb2f747b">num_threads_per_disk_</a></td></tr>
<tr class="separator:a57d6bef4f87965d26ae0f3ebdb2f747b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45a6778f947e194d7665fa340be2a95"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ae45a6778f947e194d7665fa340be2a95">max_buffer_size_</a></td></tr>
<tr class="memdesc:ae45a6778f947e194d7665fa340be2a95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum read size. This is also the maximum size of each allocated buffer.  <a href="#ae45a6778f947e194d7665fa340be2a95">More...</a><br/></td></tr>
<tr class="separator:ae45a6778f947e194d7665fa340be2a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1621cf94056e57b8d67cb38e06e6a3b4"><td class="memItemLeft" align="right" valign="top">const int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a1621cf94056e57b8d67cb38e06e6a3b4">min_buffer_size_</a></td></tr>
<tr class="memdesc:a1621cf94056e57b8d67cb38e06e6a3b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The minimum size of each read buffer.  <a href="#a1621cf94056e57b8d67cb38e06e6a3b4">More...</a><br/></td></tr>
<tr class="separator:a1621cf94056e57b8d67cb38e06e6a3b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18797d98ff8df6a835c37baab65cddcc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ThreadGroup.html">ThreadGroup</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a18797d98ff8df6a835c37baab65cddcc">disk_thread_group_</a></td></tr>
<tr class="memdesc:a18797d98ff8df6a835c37baab65cddcc"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classimpala_1_1Thread.html" title="TODO: Consider allowing fragment IDs as category parameters. ">Thread</a> group containing all the worker threads.  <a href="#a18797d98ff8df6a835c37baab65cddcc">More...</a><br/></td></tr>
<tr class="separator:a18797d98ff8df6a835c37baab65cddcc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3884fdf813f9fb3b2a4b0d6942c45b2"><td class="memItemLeft" align="right" valign="top">struct hadoopRzOptions *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#af3884fdf813f9fb3b2a4b0d6942c45b2">cached_read_options_</a></td></tr>
<tr class="memdesc:af3884fdf813f9fb3b2a4b0d6942c45b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Options object for cached hdfs reads. Set on startup and never modified.  <a href="#af3884fdf813f9fb3b2a4b0d6942c45b2">More...</a><br/></td></tr>
<tr class="separator:af3884fdf813f9fb3b2a4b0d6942c45b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa38c0d8f31a90a97cb7aab33592f6a12"><td class="memItemLeft" align="right" valign="top">volatile <a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#aa38c0d8f31a90a97cb7aab33592f6a12">shut_down_</a></td></tr>
<tr class="separator:aa38c0d8f31a90a97cb7aab33592f6a12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae98884865bff90f5bad4a6d814ac735a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ae98884865bff90f5bad4a6d814ac735a">total_bytes_read_counter_</a></td></tr>
<tr class="memdesc:ae98884865bff90f5bad4a6d814ac735a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total bytes read by the IoMgr.  <a href="#ae98884865bff90f5bad4a6d814ac735a">More...</a><br/></td></tr>
<tr class="separator:ae98884865bff90f5bad4a6d814ac735a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9824ef6a01d96312a2c7a9f7c13b7809"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a9824ef6a01d96312a2c7a9f7c13b7809">read_timer_</a></td></tr>
<tr class="memdesc:a9824ef6a01d96312a2c7a9f7c13b7809"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total time spent in hdfs reading.  <a href="#a9824ef6a01d96312a2c7a9f7c13b7809">More...</a><br/></td></tr>
<tr class="separator:a9824ef6a01d96312a2c7a9f7c13b7809"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ddb2e1d5fc8839916e38775875f44d5"><td class="memItemLeft" align="right" valign="top">boost::scoped_ptr<br class="typebreak"/>
&lt; <a class="el" href="classDiskIoMgr_1_1RequestContextCache.html">RequestContextCache</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a2ddb2e1d5fc8839916e38775875f44d5">request_context_cache_</a></td></tr>
<tr class="separator:a2ddb2e1d5fc8839916e38775875f44d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a495366bfbc69a8a08eda7f6af084e30d"><td class="memItemLeft" align="right" valign="top">boost::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a495366bfbc69a8a08eda7f6af084e30d">free_buffers_lock_</a></td></tr>
<tr class="memdesc:a495366bfbc69a8a08eda7f6af084e30d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protects free_buffers_ and free_buffer_descs_.  <a href="#a495366bfbc69a8a08eda7f6af084e30d">More...</a><br/></td></tr>
<tr class="separator:a495366bfbc69a8a08eda7f6af084e30d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59189dd1e2ba483252dca9043602e32b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::list&lt; char * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a59189dd1e2ba483252dca9043602e32b">free_buffers_</a></td></tr>
<tr class="separator:a59189dd1e2ba483252dca9043602e32b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87763baaff5e691c4881d5147795d0d2"><td class="memItemLeft" align="right" valign="top">std::list&lt; <a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a87763baaff5e691c4881d5147795d0d2">free_buffer_descs_</a></td></tr>
<tr class="memdesc:a87763baaff5e691c4881d5147795d0d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of free buffer desc objects that can be handed out to clients.  <a href="#a87763baaff5e691c4881d5147795d0d2">More...</a><br/></td></tr>
<tr class="separator:a87763baaff5e691c4881d5147795d0d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af197b913784b65e86e0d5601a59c915f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1AtomicInt.html">AtomicInt</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#af197b913784b65e86e0d5601a59c915f">num_allocated_buffers_</a></td></tr>
<tr class="memdesc:af197b913784b65e86e0d5601a59c915f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of allocated buffers, used for debugging.  <a href="#af197b913784b65e86e0d5601a59c915f">More...</a><br/></td></tr>
<tr class="separator:af197b913784b65e86e0d5601a59c915f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc2062330fc1bdd9f1ee14093dbd69b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1AtomicInt.html">AtomicInt</a>&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#afc2062330fc1bdd9f1ee14093dbd69b5">num_buffers_in_readers_</a></td></tr>
<tr class="memdesc:afc2062330fc1bdd9f1ee14093dbd69b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of buffers in readers.  <a href="#afc2062330fc1bdd9f1ee14093dbd69b5">More...</a><br/></td></tr>
<tr class="separator:afc2062330fc1bdd9f1ee14093dbd69b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a998dafa247fd5bcac1b5a30232fb9d17"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#a998dafa247fd5bcac1b5a30232fb9d17">disk_queues_</a></td></tr>
<tr class="separator:a998dafa247fd5bcac1b5a30232fb9d17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:ac9c5947135e52813c03a9c900161c428"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#ac9c5947135e52813c03a9c900161c428">BufferDescriptor</a></td></tr>
<tr class="separator:ac9c5947135e52813c03a9c900161c428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1c05277e3e3ce9b9b00fecbd7130b31"><td class="memItemLeft" align="right" valign="top">class&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1DiskIoMgr.html#af1c05277e3e3ce9b9b00fecbd7130b31">DiskIoMgrTest_Buffers_Test</a></td></tr>
<tr class="separator:af1c05277e3e3ce9b9b00fecbd7130b31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Manager object that schedules IO for all queries on all disks and remote filesystems (such as S3). Each query maps to one or more <a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> objects, each of which has its own queue of scan ranges and/or write ranges. The API splits up requesting scan/write ranges (non-blocking) and reading the data (blocking). The <a class="el" href="classimpala_1_1DiskIoMgr.html">DiskIoMgr</a> has worker threads that will read from and write to disk/hdfs/remote-filesystems, allowing interleaving of IO and CPU. This allows us to keep all disks and all cores as busy as possible. All public APIs are thread-safe. It is not valid to call any of the APIs after <a class="el" href="classimpala_1_1DiskIoMgr.html#abcb3619688e18e6453177dc8bb85e565">UnregisterContext()</a> returns. For Readers: We can model this problem as a multiple producer (threads for each disk), multiple consumer (scan ranges) problem. There are multiple queues that need to be synchronized. Conceptually, there are two queues:</p>
<ol type="1">
<li>The per disk queue: this contains a queue of readers that need reads.</li>
<li>The per scan range ready-buffer queue: this contains buffers that have been read and are ready for the caller. The disk queue contains a queue of readers and is scheduled in a round robin fashion. Readers map to scan nodes. The reader then contains a queue of scan ranges. The caller asks the IoMgr for the next range to process. The IoMgr then selects the best range to read based on disk activity and begins reading and queuing buffers for that range. TODO: We should map readers to queries. A reader is the unit of scheduling and queries that have multiple scan nodes shouldn't have more 'turns'. For Writers: Data is written via <a class="el" href="classimpala_1_1DiskIoMgr.html#a89284efc0d973c8df0e51ca3238c6b52">AddWriteRange()</a>. This is non-blocking and adds a <a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> to a per-disk queue. After the write is complete, a callback in <a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> is invoked. No memory is allocated within IoMgr for writes and no copies are made. It is the responsibility of the client to ensure that the data to be written is valid and that the file to be written to exists until the callback is invoked. The IoMgr provides three key APIs.</li>
</ol>
<p>AddScanRanges: this is non-blocking and tells the IoMgr all the ranges that will eventually need to be read.</p>
<ol type="1">
<li>GetNextRange: returns to the caller the next scan range it should process. This is based on disk load. This also begins reading the data in this scan range. This is blocking.</li>
<li><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html#ad74e32e4d268c24bcfda3b8d30dd3423">ScanRange::GetNext</a>: returns the next buffer for this range. This is blocking. The disk threads do not synchronize with each other. The readers and writers don't synchronize with each other. There is a lock and condition variable for each request context queue and each disk queue. IMPORTANT: whenever both locks are needed, the lock order is to grab the context lock before the disk lock. Scheduling: If there are multiple request contexts with work for a single disk, the request contexts are scheduled in round-robin order. Multiple disk threads can operate on the same request context. Exactly one request range is processed by a disk thread at a time. If there are multiple scan ranges scheduled via <a class="el" href="classimpala_1_1DiskIoMgr.html#a3cc61c88ae6cbb96791d71aee1664137">GetNextRange()</a> for a single context, these are processed in round-robin order. If there are multiple scan and write ranges for a disk, a read is always followed by a write, and a write is followed by a read, i.e. reads and writes alternate. If multiple write ranges are enqueued for a single disk, they will be processed by the disk threads in order, but may complete in any order. No guarantees are made on ordering of writes across disks. Resource Management: effective resource management in the IoMgr is key to good performance. The IoMgr helps coordinate two resources: CPU and disk. For CPU, spinning up too many threads causes thrashing. Memory usage in the IoMgr comes from queued read buffers. If we queue the minimum (i.e. 1), then the disks are idle while we are processing the buffer. If we don't limit the queue, then it possible we end up queueing the entire data set (i.e. CPU is slower than disks) and run out of memory. For both CPU and memory, we want to model the machine as having a fixed amount of resources. If a single query is running, it should saturate either CPU or Disk as well as using as little memory as possible. With multiple queries, each query should get less CPU, therefore need fewer queued buffers and therefore less memory usage. The IoMgr defers CPU management to the caller. The IoMgr provides a GetNextRange API which will return the next scan range the caller should process. The caller can call this from the desired number of reading threads. Once a scan range has been returned via GetNextRange, the IoMgr will start to buffer reads for that range and it is expected the caller will pull those buffers promptly. For example, if the caller would like to have 1 scanner thread, the read loop would look like: while (more_ranges) range = <a class="el" href="classimpala_1_1DiskIoMgr.html#a3cc61c88ae6cbb96791d71aee1664137">GetNextRange()</a> while (!range.eosr) buffer = <a class="el" href="namespaceimpala.html#af279911558f793413306452d5b16e6d6">range.GetNext()</a> To have multiple reading threads, the caller would simply spin up the threads and each would process the loops above. To control the number of IO buffers, each scan range has a soft max capacity for the number of queued buffers. If the number of buffers is at capacity, the IoMgr will no longer read for that scan range until the caller has processed a buffer. This capacity does not need to be fixed, and the caller can dynamically adjust it if necessary. As an example: If we allowed 5 buffers per range on a 24 core, 72 thread (we default to allowing 3x threads) machine, we should see at most 72 * 5 * 8MB = 2.8GB in io buffers memory usage. This should remain roughly constant regardless of how many concurrent readers are running. Buffer Management: Buffers are allocated by the IoMgr as necessary to service reads. These buffers are directly returned to the caller. The caller must call Return() on the buffer when it is done, at which point the buffer will be recycled for another read. In error cases, the IoMgr will recycle the buffers more promptly but regardless, the caller must always call Return() Caching support: Scan ranges contain metadata on whether or not it is cached on the DN. In that case, we use the HDFS APIs to read the cached data without doing any copies. For these ranges, the reads happen on the caller thread (as opposed to the disk threads). It is possible for the cached read APIs to fail, in which case the ranges are then queued on the disk threads and behave identically to the case where the range is not cached. Resources for these ranges are also not accounted against the reader because none are consumed. While a cached block is being processed, the block is mlocked. We want to minimize the time the mlock is held.<ul>
<li>HDFS will time us out if we hold onto the mlock for too long</li>
<li>Holding the lock prevents uncaching this file due to a caching policy change. Therefore, we only issue the cached read when the caller is ready to process the range (<a class="el" href="classimpala_1_1DiskIoMgr.html#a3cc61c88ae6cbb96791d71aee1664137">GetNextRange()</a>) instead of when the ranges are issued. This guarantees that there will be a CPU available to process the buffer and any throttling we do with the number of scanner threads properly controls the amount of files we mlock. With cached scan ranges, we cannot close the scan range until the cached buffer is returned (HDFS does not allow this). We therefore need to defer the close until the cached buffer is returned (<a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html#a258f4e13d2729f1a5fa395376db97cfe">BufferDescriptor::Return()</a>). Remote filesystem support (e.g. S3): Remote filesystems are modeled as "remote disks". That is, there is a seperate disk queue for each supported remote filesystem type. In order to maximize throughput, multiple connections are opened in parallel by having multiple threads running per queue. Also note that reading from a remote filesystem service can be more CPU intensive than local disk/hdfs because of non-direct I/O and SSL processing, and can be CPU bottlenecked especially if not enough I/O threads for these queues are started. TODO: IoMgr should be able to request additional scan ranges from the coordinator to help deal with stragglers. TODO: look into using a lock free queue TODO: simplify the common path (less locking, memory allocations). TODO: Break this up the .h/.cc into multiple files under an /io subdirectory. Structure of the Implementation:</li>
</ul>
</li>
</ol>
<ul>
<li>All client APIs are defined in this file</li>
<li>Internal classes are defined in <a class="el" href="disk-io-mgr-internal_8h.html">disk-io-mgr-internal.h</a></li>
<li><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> APIs are implemented in <a class="el" href="disk-io-mgr-scan-range_8cc.html">disk-io-mgr-scan-range.cc</a> This contains the ready buffer queue logic</li>
<li><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> APIs are implemented in <a class="el" href="disk-io-mgr-reader-context_8cc.html">disk-io-mgr-reader-context.cc</a> This contains the logic for picking scan ranges for a reader.</li>
<li>Disk <a class="el" href="classimpala_1_1Thread.html" title="TODO: Consider allowing fragment IDs as category parameters. ">Thread</a> and general APIs are implemented in <a class="el" href="disk-io-mgr_8cc.html">disk-io-mgr.cc</a>. </li>
</ul>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00188">188</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>
</div><h2 class="groupheader">Member Enumeration Documentation</h2>
<a class="anchor" id="aabb61890cd37be80703ae735e2a075ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>"Disk" queue offsets for remote accesses. Offset 0 corresponds to disk ID (i.e. disk_queue_ index) of <a class="el" href="classimpala_1_1DiskIoMgr.html#a3a6605b8b52c766d1489af89f0a2ac43" title="Returns the number of local disks attached to the system. ">num_local_disks()</a>. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="aabb61890cd37be80703ae735e2a075ada4dce4311f2a962cc1e369379f9ffedf2"></a>REMOTE_S3_DISK_OFFSET</em>&#160;</td><td class="fielddoc">
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aabb61890cd37be80703ae735e2a075adaf2d4abf2fb7cedd9b81575e18d2a361a"></a>REMOTE_NUM_DISKS</em>&#160;</td><td class="fielddoc">
</td></tr>
</table>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00623">623</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aaccc2eb380dbc73014211774b4ac4fb1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DiskIoMgr::DiskIoMgr </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_disks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>threads_per_disk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>min_buffer_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_buffer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a <a class="el" href="classimpala_1_1DiskIoMgr.html">DiskIoMgr</a> object.</p>
<ul>
<li>num_disks: The number of disks the IoMgr should use. This is used for testing. Specify 0, to have the disk IoMgr query the os for the number of disks.</li>
<li>threads_per_disk: number of read threads to create per disk. This is also the max queue depth.</li>
<li>min_buffer_size: minimum io buffer size (in bytes)</li>
<li>max_buffer_size: maximum io buffer size (in bytes). Also the max read size. </li>
</ul>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00234">234</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="bit-util_8h_source.html#l00032">impala::BitUtil::Ceil()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00210">CheckSseSupport()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00701">disk_queues_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00687">free_buffers_</a>, <a class="el" href="bit-util_8h_source.html#l00135">impala::BitUtil::Log2()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00646">max_buffer_size_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00649">min_buffer_size_</a>, <a class="el" href="disk-info_8h_source.html#l00038">impala::DiskInfo::num_disks()</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00625">REMOTE_NUM_DISKS</a>.</p>

</div>
</div>
<a class="anchor" id="a44032d3a2a6760a534540b0d86c52cc6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DiskIoMgr::DiskIoMgr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create <a class="el" href="classimpala_1_1DiskIoMgr.html">DiskIoMgr</a> with default configs. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00219">219</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="bit-util_8h_source.html#l00032">impala::BitUtil::Ceil()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00210">CheckSseSupport()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00701">disk_queues_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00687">free_buffers_</a>, <a class="el" href="bit-util_8h_source.html#l00135">impala::BitUtil::Log2()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00646">max_buffer_size_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00649">min_buffer_size_</a>, <a class="el" href="disk-info_8h_source.html#l00038">impala::DiskInfo::num_disks()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00599">num_local_disks()</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00625">REMOTE_NUM_DISKS</a>.</p>

</div>
</div>
<a class="anchor" id="ac8e9f578c5a9e278add1859d37cbd08a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DiskIoMgr::~DiskIoMgr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Clean up all threads and resources. This is mostly useful for testing since for impalad, this object is never destroyed. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00250">250</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00655">cached_read_options_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00142">DebugString()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00701">disk_queues_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00652">disk_thread_group_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00687">free_buffers_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="gen__ir__descriptions_8py_source.html#l00215">gen_ir_descriptions::idx</a>, <a class="el" href="thread_8cc_source.html#l00327">impala::ThreadGroup::JoinAll()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00693">num_allocated_buffers_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00696">num_buffers_in_readers_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00671">request_context_cache_</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00659">shut_down_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa6a1a246f28ee5f8214cfdfd2dd8aa42"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::AddScanRanges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> * &gt; &amp;&#160;</td>
          <td class="paramname"><em>ranges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>schedule_immediately</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds the scan ranges to the queues. This call is non-blocking. The caller must not deallocate the scan range pointers before <a class="el" href="classimpala_1_1DiskIoMgr.html#abcb3619688e18e6453177dc8bb85e565">UnregisterContext()</a>. If schedule_immediately, the ranges are immediately put on the read queue (i.e. the caller should not/cannot call GetNextRange for these ranges). This can be used to do synchronous reads as well as schedule dependent ranges, as in the case for columnar formats. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00455">455</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00091">impala::DiskIoMgr::RequestContext::AddRequestRange()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00282">impala::DiskIoMgr::RequestContext::cached_ranges_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00131">impala::DiskIoMgr::RequestContext::Cancelled</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00176">impala::DiskIoMgr::RequestContext::DebugString()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00404">impala::DiskIoMgr::ScanRange::ReadFromCache()</a>, <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00270">impala::DiskIoMgr::RequestContext::state_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00273">impala::DiskIoMgr::RequestContext::status_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00379">impala::DiskIoMgr::ScanRange::try_cache_</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00206">impala::DiskIoMgr::RequestContext::Validate()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00444">ValidateScanRange()</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00674">impala::HdfsScanNode::AddDiskIoRanges()</a>, <a class="el" href="hdfs-parquet-scanner_8cc_source.html#l01093">impala::HdfsParquetScanner::InitColumns()</a>, <a class="el" href="buffered-block-mgr_8cc_source.html#l00536">impala::BufferedBlockMgr::PinBlock()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00555">Read()</a>, and <a class="el" href="disk-io-mgr-test_8cc_source.html#l00349">impala::TEST_F()</a>.</p>

</div>
</div>
<a class="anchor" id="a89284efc0d973c8df0e51ca3238c6b52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::AddWriteRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *&#160;</td>
          <td class="paramname"><em>write_range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add a <a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> for the writer. This is non-blocking and schedules the context on the IoMgr disk queue. Does not create any files. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l01103">1103</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00091">impala::DiskIoMgr::RequestContext::AddRequestRange()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00131">impala::DiskIoMgr::RequestContext::Cancelled</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00268">impala::DiskIoMgr::RequestRange::len()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00646">max_buffer_size_</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00270">impala::DiskIoMgr::RequestContext::state_</a>, and <a class="el" href="disk-io-mgr-internal_8h_source.html#l00273">impala::DiskIoMgr::RequestContext::status_</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr-test_8cc_source.html#l00172">impala::TEST_F()</a>, and <a class="el" href="buffered-block-mgr_8cc_source.html#l00659">impala::BufferedBlockMgr::WriteUnpinnedBlock()</a>.</p>

</div>
</div>
<a class="anchor" id="ab92e887bc1867272f1d0ce80f09bfe11"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DiskIoMgr::AssignQueue </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>disk_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>expected_local</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determine which disk queue this file should be assigned to. Returns an index into disk_queues_. The disk_id is the volume ID for the local disk that holds the files, or -1 if unknown. Flag expected_local is true iff this impalad is co-located with the datanode for this file. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l01116">1116</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="hdfs-util_8cc_source.html#l00072">impala::IsS3APath()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00599">num_local_disks()</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00602">RemoteS3DiskId()</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00183">impala::HdfsScanNode::AllocateScanRange()</a>.</p>

</div>
</div>
<a class="anchor" id="a62c6a7658886cefdb5e84e867da6352f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t DiskIoMgr::bytes_read_dn_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00428">428</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00221">impala::DiskIoMgr::RequestContext::bytes_read_dn_cache_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00982">impala::HdfsScanNode::StopAndFinalizeCounters()</a>.</p>

</div>
</div>
<a class="anchor" id="a22f6b26648d0b3878e417cf087b2ee89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t DiskIoMgr::bytes_read_local </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00420">420</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00215">impala::DiskIoMgr::RequestContext::bytes_read_local_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00982">impala::HdfsScanNode::StopAndFinalizeCounters()</a>.</p>

</div>
</div>
<a class="anchor" id="ab00029212e1b92f2ecb6014c63c204a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t DiskIoMgr::bytes_read_short_circuit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00424">424</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00218">impala::DiskIoMgr::RequestContext::bytes_read_short_circuit_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00982">impala::HdfsScanNode::StopAndFinalizeCounters()</a>.</p>

</div>
</div>
<a class="anchor" id="a0101ab194607143c4e79baaf7a914a64"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::CancelContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>wait_for_disks_completion</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function cancels the context asychronously. All outstanding requests are aborted and tracking structures cleaned up. This does not need to be called if the context finishes normally. This will also fail any outstanding <a class="el" href="namespaceimpala.html#af279911558f793413306452d5b16e6d6">GetNext()</a>/Read requests. If wait_for_disks_completion is true, wait for the number of active disks for this context to reach 0. After calling with wait_for_disks_completion = true, the only valid API is returning IO buffers that have already been returned. Takes context-&gt;lock_ if wait_for_disks_completion is true. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00377">377</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00021">impala::DiskIoMgr::RequestContext::Cancel()</a>, <a class="el" href="status_8h_source.html#l00088">impala::Status::CANCELLED</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00176">impala::DiskIoMgr::RequestContext::DebugString()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00298">impala::DiskIoMgr::RequestContext::disks_complete_cond_var_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00277">impala::DiskIoMgr::RequestContext::num_disks_with_ranges_</a>, and <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00206">impala::DiskIoMgr::RequestContext::Validate()</a>.</p>

<p>Referenced by <a class="el" href="buffered-block-mgr_8cc_source.html#l00359">impala::BufferedBlockMgr::Cancel()</a>, <a class="el" href="hdfs-scan-node_8cc_source.html#l00622">impala::HdfsScanNode::Close()</a>, <a class="el" href="hdfs-scan-node_8cc_source.html#l00944">impala::HdfsScanNode::SetDone()</a>, <a class="el" href="disk-io-mgr-test_8cc_source.html#l00284">impala::TEST_F()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00344">UnregisterContext()</a>.</p>

</div>
</div>
<a class="anchor" id="ac5ce912576b754a61f9e1b61f2d2b4ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::context_status </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>TODO: The functions below can be moved to <a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a>. Returns the current status of the context. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00411">411</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, and <a class="el" href="disk-io-mgr-internal_8h_source.html#l00273">impala::DiskIoMgr::RequestContext::status_</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr-test_8cc_source.html#l00558">impala::TEST_F()</a>.</p>

</div>
</div>
<a class="anchor" id="a38bde6fa6ddcd0ae546a3e52e00cb5ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string DiskIoMgr::DebugString </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dumps the disk IoMgr queues (for readers and disks) </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00142">142</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00143">impala::DiskIoMgr::ScanRange::Cancel()</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00070">impala::DiskIoMgr::ScanRange::GetNext()</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00233">impala::DiskIoMgr::ScanRange::InitInternal()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="aca591719005e7c9a0cd8212d52f5e533"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int DiskIoMgr::free_buffers_idx </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>buffer_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the index into free_buffers_ for a given buffer size. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l01095">1095</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="bit-util_8h_source.html#l00032">impala::BitUtil::Ceil()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00687">free_buffers_</a>, <a class="el" href="gen__ir__descriptions_8py_source.html#l00215">gen_ir_descriptions::idx</a>, <a class="el" href="bit-util_8h_source.html#l00135">impala::BitUtil::Log2()</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00649">min_buffer_size_</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>.</p>

</div>
</div>
<a class="anchor" id="a4431510659aedf1fa38e042e4196f415"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::GcIoBuffers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Garbage collect all unused io buffers. This is currently only triggered when the process wide limit is hit. This is not good enough. While it is sufficient for the IoMgr, other components do not trigger this GC. TODO: make this run periodically? </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00661">661</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00687">free_buffers_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00674">free_buffers_lock_</a>, <a class="el" href="gen__ir__descriptions_8py_source.html#l00215">gen_ir_descriptions::idx</a>, <a class="el" href="impalad-metrics_8h_source.html#l00139">impala::ImpaladMetrics::IO_MGR_NUM_BUFFERS</a>, <a class="el" href="impalad-metrics_8h_source.html#l00141">impala::ImpaladMetrics::IO_MGR_NUM_UNUSED_BUFFERS</a>, <a class="el" href="impalad-metrics_8h_source.html#l00142">impala::ImpaladMetrics::IO_MGR_TOTAL_BYTES</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00649">min_buffer_size_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00693">num_allocated_buffers_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00639">process_mem_tracker_</a>, and <a class="el" href="mem-tracker_8h_source.html#l00209">impala::MemTracker::Release()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>, <a class="el" href="disk-io-mgr-test_8cc_source.html#l00964">impala::TEST_F()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a234649f13d6930779d0fd6ae871f7bee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">DiskIoMgr::BufferDescriptor</a> * DiskIoMgr::GetBufferDesc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>buffer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Gets a buffer description object, initialized for this reader, allocating one as necessary. buffer_size / min_buffer_size_ should be a power of 2, and buffer_size should be &lt;= max_buffer_size_. These constraints will be met if buffer was acquired via <a class="el" href="classimpala_1_1DiskIoMgr.html#aa3bba021605906306bbbf5daddf95d95">GetFreeBuffer()</a> (which it should have been). </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00610">610</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="object-pool_8h_source.html#l00042">impala::ObjectPool::Add()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00629">BufferDescriptor</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00690">free_buffer_descs_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00674">free_buffers_lock_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00198">impala::DiskIoMgr::RequestContext::mem_tracker_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00636">pool_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00165">impala::DiskIoMgr::BufferDescriptor::Reset()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00187">impala::DiskIoMgr::BufferDescriptor::SetMemTracker()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>.</p>

</div>
</div>
<a class="anchor" id="aa3bba021605906306bbbf5daddf95d95"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char * DiskIoMgr::GetFreeBuffer </td>
          <td>(</td>
          <td class="paramtype">int64_t *&#160;</td>
          <td class="paramname"><em>buffer_size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns a buffer to read into with size between *buffer_size and max_buffer_size_, and *buffer_size is set to the size of the buffer. If there is an appropriately-sized free buffer in the 'free_buffers_', that is returned, otherwise a new one is allocated. *buffer_size must be between 0 and max_buffer_size_. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00627">627</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="mem-tracker_8h_source.html#l00118">impala::MemTracker::Consume()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00687">free_buffers_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l01095">free_buffers_idx()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00674">free_buffers_lock_</a>, <a class="el" href="gen__ir__descriptions_8py_source.html#l00215">gen_ir_descriptions::idx</a>, <a class="el" href="impalad-metrics_8h_source.html#l00139">impala::ImpaladMetrics::IO_MGR_NUM_BUFFERS</a>, <a class="el" href="impalad-metrics_8h_source.html#l00141">impala::ImpaladMetrics::IO_MGR_NUM_UNUSED_BUFFERS</a>, <a class="el" href="impalad-metrics_8h_source.html#l00142">impala::ImpaladMetrics::IO_MGR_TOTAL_BYTES</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00646">max_buffer_size_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00649">min_buffer_size_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00693">num_allocated_buffers_</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00639">process_mem_tracker_</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>, and <a class="el" href="disk-io-mgr-test_8cc_source.html#l00964">impala::TEST_F()</a>.</p>

</div>
</div>
<a class="anchor" id="a3cc61c88ae6cbb96791d71aee1664137"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::GetNextRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> **&#160;</td>
          <td class="paramname"><em>range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the next unstarted scan range for this reader. When the range is returned, the disk threads in the IoMgr will already have started reading from it. The caller is expected to call <a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html#ad74e32e4d268c24bcfda3b8d30dd3423">ScanRange::GetNext</a> on the returned range. If there are no more unstarted ranges, NULL is returned. This call is blocking. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00501">501</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00091">impala::DiskIoMgr::RequestContext::AddRequestRange()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00282">impala::DiskIoMgr::RequestContext::cached_ranges_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00131">impala::DiskIoMgr::RequestContext::Cancelled</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00176">impala::DiskIoMgr::RequestContext::DebugString()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00464">impala::DiskIoMgr::RequestContext::disk_states_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00239">impala::DiskIoMgr::RequestContext::num_unstarted_scan_ranges_</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00291">impala::DiskIoMgr::RequestContext::ready_to_start_ranges_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00292">impala::DiskIoMgr::RequestContext::ready_to_start_ranges_cv_</a>, <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00165">impala::DiskIoMgr::RequestContext::ScheduleScanRange()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00270">impala::DiskIoMgr::RequestContext::state_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00273">impala::DiskIoMgr::RequestContext::status_</a>, and <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00206">impala::DiskIoMgr::RequestContext::Validate()</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00797">impala::HdfsScanNode::ScannerThread()</a>, <a class="el" href="disk-io-mgr-test_8cc_source.html#l00138">impala::DiskIoMgrTest::ScanRangeThread()</a>, and <a class="el" href="disk-io-mgr-test_8cc_source.html#l00626">impala::TEST_F()</a>.</p>

</div>
</div>
<a class="anchor" id="a8550d90be93435c85ea623ed75c02a6a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> DiskIoMgr::GetNextRequestRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *&#160;</td>
          <td class="paramname"><em>disk_queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestRange.html">RequestRange</a> **&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> **&#160;</td>
          <td class="paramname"><em>request_context</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is called from the disk thread to get the next range to process. It will wait until a scan range and buffer are available, or a write range is available. This functions returns the range to process. Only returns false if the disk thread should be shut down. No locks should be taken before this function call and none are left taken after. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00730">730</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00126">impala::DiskIoMgr::RequestContext::Active</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00131">impala::DiskIoMgr::RequestContext::Cancelled</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00367">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThread()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00373">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThreadAndCheckDone()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00041">impala::DiskIoMgr::DiskQueue::disk_id</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00336">impala::DiskIoMgr::RequestContext::PerDiskState::in_flight_ranges()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00362">impala::DiskIoMgr::RequestContext::PerDiskState::IncrementRequestThreadAndDequeue()</a>, <a class="el" href="mem-tracker_8h_source.html#l00257">impala::MemTracker::LimitExceeded()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00044">impala::DiskIoMgr::DiskQueue::lock</a>, <a class="el" href="status_8h_source.html#l00089">impala::Status::MEM_LIMIT_EXCEEDED</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00310">impala::DiskIoMgr::RequestContext::PerDiskState::next_scan_range_to_start()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00307">impala::DiskIoMgr::RequestContext::PerDiskState::num_remaining_ranges()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00639">process_mem_tracker_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00053">impala::DiskIoMgr::DiskQueue::request_contexts</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00352">impala::DiskIoMgr::RequestContext::PerDiskState::ScheduleContext()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00311">impala::DiskIoMgr::RequestContext::PerDiskState::set_next_scan_range_to_start()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00659">shut_down_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00330">impala::DiskIoMgr::RequestContext::PerDiskState::unstarted_scan_ranges()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00333">impala::DiskIoMgr::RequestContext::PerDiskState::unstarted_write_ranges()</a>, <a class="el" href="logging_8h_source.html#l00058">VLOG_FILE</a>, and <a class="el" href="disk-io-mgr-internal_8h_source.html#l00050">impala::DiskIoMgr::DiskQueue::work_available</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00920">WorkLoop()</a>.</p>

</div>
</div>
<a class="anchor" id="a8cad7a32492c51d29a1383d5644c7415"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t DiskIoMgr::GetReadThroughput </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the read throughput across all readers. TODO: should this be a sliding window? This should report metrics for the last minute, hour and since the beginning. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00440">440</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00665">read_timer_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00662">total_bytes_read_counter_</a>, and <a class="el" href="runtime-profile_8cc_source.html#l00733">impala::RuntimeProfile::UnitsPerSecond()</a>.</p>

</div>
</div>
<a class="anchor" id="ad953550311c262181c52df319cacf540"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::HandleReadFinished </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *&#160;</td>
          <td class="paramname"><em>disk_queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Updates disk queue and reader state after a read is complete. The read result is captured in the buffer descriptor. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00866">866</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00126">impala::DiskIoMgr::RequestContext::Active</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00295">impala::DiskIoMgr::RequestContext::blocked_ranges_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00235">impala::DiskIoMgr::BufferDescriptor::buffer_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00401">impala::DiskIoMgr::ScanRange::cached_buffer_</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00143">impala::DiskIoMgr::ScanRange::Cancel()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00131">impala::DiskIoMgr::RequestContext::Cancelled</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00301">impala::DiskIoMgr::ScanRange::Close()</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00176">impala::DiskIoMgr::RequestContext::DebugString()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00367">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThread()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00373">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThreadAndCheckDone()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00041">impala::DiskIoMgr::DiskQueue::disk_id</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00464">impala::DiskIoMgr::RequestContext::disk_states_</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00036">impala::DiskIoMgr::ScanRange::EnqueueBuffer()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00244">impala::DiskIoMgr::BufferDescriptor::eosr_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00307">impala::DiskIoMgr::RequestContext::PerDiskState::num_remaining_ranges()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00324">impala::DiskIoMgr::RequestContext::PerDiskState::num_threads_in_op()</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00232">impala::DiskIoMgr::BufferDescriptor::scan_range_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00165">impala::DiskIoMgr::RequestContext::ScheduleScanRange()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00270">impala::DiskIoMgr::RequestContext::state_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00247">impala::DiskIoMgr::BufferDescriptor::status_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00273">impala::DiskIoMgr::RequestContext::status_</a>, and <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00206">impala::DiskIoMgr::RequestContext::Validate()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>.</p>

</div>
</div>
<a class="anchor" id="a81d5e5e4dbe9e696deb160e45f6d51fb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::HandleWriteFinished </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>writer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *&#160;</td>
          <td class="paramname"><em>write_range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classimpala_1_1Status.html">Status</a> &amp;&#160;</td>
          <td class="paramname"><em>write_status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Invokes write_range-&gt;callback_ after the range has been written and updates per-disk state and handle state. The status of the write OK/RUNTIME_ERROR etc. is passed via write_status and to the callback. The write_status does not affect the writer-&gt;status_. That is, an write error does not cancel the writer context - that decision is left to the callback handler. TODO: On the read path, consider not canceling the reader context on error. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00845">845</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00480">impala::DiskIoMgr::WriteRange::callback_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00131">impala::DiskIoMgr::RequestContext::Cancelled</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00176">impala::DiskIoMgr::RequestContext::DebugString()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00367">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThread()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00373">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThreadAndCheckDone()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00286">impala::DiskIoMgr::RequestRange::disk_id_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00464">impala::DiskIoMgr::RequestContext::disk_states_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00307">impala::DiskIoMgr::RequestContext::PerDiskState::num_remaining_ranges()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00270">impala::DiskIoMgr::RequestContext::state_</a>, and <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00206">impala::DiskIoMgr::RequestContext::Validate()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l01041">Write()</a>.</p>

</div>
</div>
<a class="anchor" id="a1991e70528bab13363e3592d174d7a12"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1MemTracker.html">MemTracker</a> *&#160;</td>
          <td class="paramname"><em>process_mem_tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the IoMgr. Must be called once before any of the other APIs. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00296">296</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="mem-tracker_8h_source.html#l00313">impala::MemTracker::AddGcFunction()</a>, <a class="el" href="thread_8cc_source.html#l00318">impala::ThreadGroup::AddThread()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00655">cached_read_options_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00701">disk_queues_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00652">disk_thread_group_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="disk-info_8h_source.html#l00070">impala::DiskInfo::is_rotational()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00643">num_threads_per_disk_</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00639">process_mem_tracker_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00602">RemoteS3DiskId()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00671">request_context_cache_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00054">THREADS_PER_FLASH_DISK</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00053">THREADS_PER_ROTATIONAL_DISK</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00920">WorkLoop()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr-test_8cc_source.html#l00172">impala::TEST_F()</a>.</p>

</div>
</div>
<a class="anchor" id="a4d68607c8cf8f9003f47891af6627103"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::DiskIoMgr::max_read_buffer_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the maximum read buffer size. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00590">590</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00646">max_buffer_size_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-parquet-scanner_8cc_source.html#l00916">impala::HdfsParquetScanner::ProcessFooter()</a>, and <a class="el" href="base-sequence-scanner_8cc_source.html#l00284">impala::BaseSequenceScanner::ReadPastSize()</a>.</p>

</div>
</div>
<a class="anchor" id="ab59d92f6e237fcc86112fd39d56196fe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::DiskIoMgr::num_allocated_buffers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the number of allocated buffers. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00605">605</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00693">num_allocated_buffers_</a>.</p>

</div>
</div>
<a class="anchor" id="a54bb2885167cd44d2ca2469d28f0fa52"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::DiskIoMgr::num_buffers_in_readers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the number of buffers currently owned by all readers. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00608">608</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00696">num_buffers_in_readers_</a>.</p>

</div>
</div>
<a class="anchor" id="a3a6605b8b52c766d1489af89f0a2ac43"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::DiskIoMgr::num_local_disks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the number of local disks attached to the system. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00599">599</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00596">num_remote_disks()</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00593">num_total_disks()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l01116">AssignQueue()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00219">DiskIoMgr()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00602">RemoteS3DiskId()</a>, and <a class="el" href="buffered-block-mgr_8cc_source.html#l00659">impala::BufferedBlockMgr::WriteUnpinnedBlock()</a>.</p>

</div>
</div>
<a class="anchor" id="a2881c4eba0bb95ca79de096e0e68b5b1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::DiskIoMgr::num_remote_disks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the total number of remote "disk" queues. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00596">596</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00625">REMOTE_NUM_DISKS</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8h_source.html#l00599">num_local_disks()</a>.</p>

</div>
</div>
<a class="anchor" id="a79bb53859930e7386542d11490c69cff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DiskIoMgr::num_remote_ranges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00432">432</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00235">impala::DiskIoMgr::RequestContext::num_remote_ranges_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00982">impala::HdfsScanNode::StopAndFinalizeCounters()</a>.</p>

</div>
</div>
<a class="anchor" id="a3c99177a95caa67739c8815c55eb3491"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::DiskIoMgr::num_total_disks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the total number of disk queues (both local and remote). </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00593">593</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00701">disk_queues_</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8h_source.html#l00599">num_local_disks()</a>, and <a class="el" href="hdfs-scan-node_8cc_source.html#l00511">impala::HdfsScanNode::Open()</a>.</p>

</div>
</div>
<a class="anchor" id="a05a2eca77321958ca3e6e3784ab2efcc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int DiskIoMgr::num_unstarted_ranges </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the number of unstarted scan ranges for this reader. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00416">416</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00239">impala::DiskIoMgr::RequestContext::num_unstarted_scan_ranges_</a>.</p>

</div>
</div>
<a class="anchor" id="a263b162de531fc234e80ab3b6fc68d6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t DiskIoMgr::queue_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00407">407</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00249">impala::DiskIoMgr::RequestContext::num_ready_buffers_</a>.</p>

</div>
</div>
<a class="anchor" id="a501f1ef0a0ddce1507c99b8cf78745d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::Read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *&#160;</td>
          <td class="paramname"><em>range</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> **&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads the range and returns the result in buffer. This behaves like the typical synchronous read() api, blocking until the data is read. This can be called while there are outstanding ScanRanges and is thread safe. Multiple threads can be calling <a class="el" href="classimpala_1_1DiskIoMgr.html#a501f1ef0a0ddce1507c99b8cf78745d2">Read()</a> per reader at a time. range <em>cannot</em> have already been added via AddScanRanges. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00555">555</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8cc_source.html#l00455">AddScanRanges()</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00070">impala::DiskIoMgr::ScanRange::GetNext()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00268">impala::DiskIoMgr::RequestRange::len()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00646">max_buffer_size_</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, and <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>.</p>

<p>Referenced by <a class="el" href="hdfs-parquet-scanner_8cc_source.html#l00916">impala::HdfsParquetScanner::ProcessFooter()</a>, and <a class="el" href="disk-io-mgr-test_8cc_source.html#l00103">impala::DiskIoMgrTest::ValidateSyncRead()</a>.</p>

</div>
</div>
<a class="anchor" id="a053f427bbc4edd04f30c17410ff66a27"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::ReadRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *&#160;</td>
          <td class="paramname"><em>disk_queue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *&#160;</td>
          <td class="paramname"><em>range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reads the specified scan range and calls HandleReadFinished when done. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00954">954</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00207">impala::DiskIoMgr::RequestContext::active_read_thread_counter_</a>, <a class="el" href="runtime-profile_8h_source.html#l00093">impala::RuntimeProfile::Counter::Add()</a>, <a class="el" href="runtime-profile_8h_source.html#l00098">impala::RuntimeProfile::Counter::BitOr()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00423">impala::DiskIoMgr::ScanRange::blocked_on_queue_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00295">impala::DiskIoMgr::RequestContext::blocked_ranges_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00408">impala::DiskIoMgr::ScanRange::bytes_read_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00201">impala::DiskIoMgr::RequestContext::bytes_read_counter_</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00143">impala::DiskIoMgr::ScanRange::Cancel()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00131">impala::DiskIoMgr::RequestContext::Cancelled</a>, <a class="el" href="runtime-profile_8h_source.html#l00055">COUNTER_ADD</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00176">impala::DiskIoMgr::RequestContext::DebugString()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00367">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThread()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00373">impala::DiskIoMgr::RequestContext::PerDiskState::DecrementRequestThreadAndCheckDone()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00041">impala::DiskIoMgr::DiskQueue::disk_id</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00464">impala::DiskIoMgr::RequestContext::disk_states_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00212">impala::DiskIoMgr::RequestContext::disks_accessed_bitmap_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00244">impala::DiskIoMgr::BufferDescriptor::eosr_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00610">GetBufferDesc()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00866">HandleReadFinished()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00241">impala::DiskIoMgr::BufferDescriptor::len_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00283">impala::DiskIoMgr::RequestRange::len_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00059">LOW_MEMORY</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00646">max_buffer_size_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00198">impala::DiskIoMgr::RequestContext::mem_tracker_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00244">impala::DiskIoMgr::RequestContext::num_used_buffers_</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00251">impala::DiskIoMgr::ScanRange::Open()</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00360">impala::DiskIoMgr::ScanRange::Read()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00204">impala::DiskIoMgr::RequestContext::read_timer_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00665">read_timer_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00428">impala::DiskIoMgr::ScanRange::ready_buffers_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00249">impala::DiskIoMgr::BufferDescriptor::scan_range_offset_</a>, <a class="el" href="runtime-profile_8h_source.html#l00053">SCOPED_TIMER</a>, <a class="el" href="mem-tracker_8h_source.html#l00270">impala::MemTracker::SpareCapacity()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00270">impala::DiskIoMgr::RequestContext::state_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00247">impala::DiskIoMgr::BufferDescriptor::status_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00273">impala::DiskIoMgr::RequestContext::status_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00662">total_bytes_read_counter_</a>, and <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00206">impala::DiskIoMgr::RequestContext::Validate()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00920">WorkLoop()</a>.</p>

</div>
</div>
<a class="anchor" id="a47f9eb99e3e705017d17dffddbea38b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::RegisterContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> **&#160;</td>
          <td class="paramname"><em>request_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1MemTracker.html">MemTracker</a> *&#160;</td>
          <td class="paramname"><em>reader_mem_tracker</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocates tracking structure for a request context. Register a new request context which is returned in *request_context. The IoMgr owns the allocated <a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> object. The caller must call <a class="el" href="classimpala_1_1DiskIoMgr.html#abcb3619688e18e6453177dc8bb85e565">UnregisterContext()</a> for each context. reader_mem_tracker: Is non-null only for readers. IO buffers used for this reader will be tracked by this. If the limit is exceeded the reader will be cancelled and MEM_LIMIT_EXCEEDED will be returned via <a class="el" href="namespaceimpala.html#af279911558f793413306452d5b16e6d6">GetNext()</a>. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00336">336</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00671">request_context_cache_</a>.</p>

<p>Referenced by <a class="el" href="buffered-block-mgr_8cc_source.html#l01105">impala::BufferedBlockMgr::Init()</a>, <a class="el" href="hdfs-scan-node_8cc_source.html#l00511">impala::HdfsScanNode::Open()</a>, and <a class="el" href="disk-io-mgr-test_8cc_source.html#l00172">impala::TEST_F()</a>.</p>

</div>
</div>
<a class="anchor" id="a7f67b5041cef54b924855720f877883f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::DiskIoMgr::RemoteS3DiskId </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The disk ID (and therefore disk_queues_ index) used for S3 accesses. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00602">602</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00599">num_local_disks()</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00624">REMOTE_S3_DISK_OFFSET</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l01116">AssignQueue()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>.</p>

</div>
</div>
<a class="anchor" id="a1ce84f3fd78ec5c8492026cd22cd69e0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::ReturnBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *&#160;</td>
          <td class="paramname"><em>buffer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the buffer desc and underlying buffer to the disk IoMgr. This also updates the reader and disk queue state. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00575">575</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00235">impala::DiskIoMgr::BufferDescriptor::buffer_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00401">impala::DiskIoMgr::ScanRange::cached_buffer_</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00301">impala::DiskIoMgr::ScanRange::Close()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00244">impala::DiskIoMgr::BufferDescriptor::eosr_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00445">impala::DiskIoMgr::ScanRange::is_cancelled_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00228">impala::DiskIoMgr::RequestContext::num_buffers_in_reader_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00696">num_buffers_in_readers_</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00226">impala::DiskIoMgr::BufferDescriptor::reader_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00602">ReturnBufferDesc()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00232">impala::DiskIoMgr::BufferDescriptor::scan_range_</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00247">impala::DiskIoMgr::BufferDescriptor::status_</a>.</p>

</div>
</div>
<a class="anchor" id="af56bacb215e699a478c0a5ceee074712"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::ReturnBufferDesc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *&#160;</td>
          <td class="paramname"><em>desc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a buffer desc object which can now be used for another reader. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00602">602</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00690">free_buffer_descs_</a>, and <a class="el" href="disk-io-mgr_8h_source.html#l00674">free_buffers_lock_</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00575">ReturnBuffer()</a>.</p>

</div>
</div>
<a class="anchor" id="ad69740225431892ddb15723b3e5211c4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::ReturnFreeBuffer </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>buffer_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns a buffer to the free list. buffer_size / min_buffer_size_ should be a power of 2, and buffer_size should be &lt;= max_buffer_size_. These constraints will be met if buffer was acquired via <a class="el" href="classimpala_1_1DiskIoMgr.html#aa3bba021605906306bbbf5daddf95d95">GetFreeBuffer()</a> (which it should have been). </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00696">696</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="bit-util_8h_source.html#l00032">impala::BitUtil::Ceil()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00687">free_buffers_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l01095">free_buffers_idx()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00674">free_buffers_lock_</a>, <a class="el" href="gen__ir__descriptions_8py_source.html#l00215">gen_ir_descriptions::idx</a>, <a class="el" href="impalad-metrics_8h_source.html#l00139">impala::ImpaladMetrics::IO_MGR_NUM_BUFFERS</a>, <a class="el" href="impalad-metrics_8h_source.html#l00141">impala::ImpaladMetrics::IO_MGR_NUM_UNUSED_BUFFERS</a>, <a class="el" href="impalad-metrics_8h_source.html#l00142">impala::ImpaladMetrics::IO_MGR_TOTAL_BYTES</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00649">min_buffer_size_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00693">num_allocated_buffers_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00639">process_mem_tracker_</a>, and <a class="el" href="mem-tracker_8h_source.html#l00209">impala::MemTracker::Release()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00866">HandleReadFinished()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00575">ReturnBuffer()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00690">ReturnFreeBuffer()</a>, and <a class="el" href="disk-io-mgr-test_8cc_source.html#l00964">impala::TEST_F()</a>.</p>

</div>
</div>
<a class="anchor" id="aa8b902783f74a6cc34ca4ea6d2c0131c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::ReturnFreeBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a> *&#160;</td>
          <td class="paramname"><em>desc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the buffer in desc (cannot be NULL), sets buffer to NULL and clears the mem tracker. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00690">690</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00235">impala::DiskIoMgr::BufferDescriptor::buffer_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00238">impala::DiskIoMgr::BufferDescriptor::buffer_len_</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00187">impala::DiskIoMgr::BufferDescriptor::SetMemTracker()</a>.</p>

</div>
</div>
<a class="anchor" id="a8b9c885f997c1151fcb889f727d41fdb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::set_active_read_thread_counter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00397">397</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00207">impala::DiskIoMgr::RequestContext::active_read_thread_counter_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00511">impala::HdfsScanNode::Open()</a>.</p>

</div>
</div>
<a class="anchor" id="abcf20ad952f31d948888d9834b64dd94"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::set_bytes_read_counter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00393">393</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00201">impala::DiskIoMgr::RequestContext::bytes_read_counter_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00511">impala::HdfsScanNode::Open()</a>.</p>

</div>
</div>
<a class="anchor" id="a7b7a12de61dd80ed3b3163192c3cac19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::set_disks_access_bitmap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00402">402</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00212">impala::DiskIoMgr::RequestContext::disks_accessed_bitmap_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00511">impala::HdfsScanNode::Open()</a>.</p>

</div>
</div>
<a class="anchor" id="a9f81e48ed3492b090a38a8ac9d90cc97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::set_read_timer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> *&#160;</td>
          <td class="paramname"><em>c</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00389">389</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00204">impala::DiskIoMgr::RequestContext::read_timer_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00511">impala::HdfsScanNode::Open()</a>.</p>

</div>
</div>
<a class="anchor" id="a1d1b000a66d4456365e4f9fbf6cb896f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int64_t DiskIoMgr::unexpected_remote_bytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>reader</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00436">436</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr-internal_8h_source.html#l00224">impala::DiskIoMgr::RequestContext::unexpected_remote_bytes_</a>.</p>

<p>Referenced by <a class="el" href="hdfs-scan-node_8cc_source.html#l00982">impala::HdfsScanNode::StopAndFinalizeCounters()</a>.</p>

</div>
</div>
<a class="anchor" id="abcb3619688e18e6453177dc8bb85e565"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::UnregisterContext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unregisters context from the disk IoMgr. This must be called for every <a class="el" href="classimpala_1_1DiskIoMgr.html#a47f9eb99e3e705017d17dffddbea38b2">RegisterContext()</a> regardless of cancellation and must be called in the same thread as <a class="el" href="namespaceimpala.html#af279911558f793413306452d5b16e6d6">GetNext()</a> The 'context' cannot be used after this call. This call blocks until all the disk threads have finished cleaning up. UnregisterContext also cancels the reader/writer from the disk IoMgr. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00344">344</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8cc_source.html#l00377">CancelContext()</a>, <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00176">impala::DiskIoMgr::RequestContext::DebugString()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00267">impala::DiskIoMgr::RequestContext::lock_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00228">impala::DiskIoMgr::RequestContext::num_buffers_in_reader_</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00244">impala::DiskIoMgr::RequestContext::num_used_buffers_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00671">request_context_cache_</a>, and <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00206">impala::DiskIoMgr::RequestContext::Validate()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr-test_8cc_source.html#l00172">impala::TEST_F()</a>, and <a class="el" href="buffered-block-mgr_8cc_source.html#l00481">impala::BufferedBlockMgr::~BufferedBlockMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a78c14580725060483f5bbd1aaf24fa29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> impala::DiskIoMgr::Validate </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Validates the internal state is consistent. This is intended to only be used for debugging. </p>

<p>Referenced by <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00143">impala::DiskIoMgr::ScanRange::Cancel()</a>, <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00070">impala::DiskIoMgr::ScanRange::GetNext()</a>, and <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00233">impala::DiskIoMgr::ScanRange::InitInternal()</a>.</p>

</div>
</div>
<a class="anchor" id="a602c11c00e5824f4b75ca325bcb1ff74"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::ValidateScanRange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1ScanRange.html">ScanRange</a> *&#160;</td>
          <td class="paramname"><em>range</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validates that range is correctly initialized. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00444">444</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00286">impala::DiskIoMgr::RequestRange::disk_id_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00701">disk_queues_</a>, and <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00455">AddScanRanges()</a>.</p>

</div>
</div>
<a class="anchor" id="a83daff34ce9a9d8eadbfff528e28eb56"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::WorkLoop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Disk worker thread loop. This function retrieves the next range to process on the disk queue and invokes <a class="el" href="classimpala_1_1DiskIoMgr.html#a053f427bbc4edd04f30c17410ff66a27" title="Reads the specified scan range and calls HandleReadFinished when done. ">ReadRange()</a> or <a class="el" href="classimpala_1_1DiskIoMgr.html#a767af862da36691ad7b4799b5ad82744">Write()</a> depending on the type of Range(). There can be multiple threads per disk running this loop. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l00920">920</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8cc_source.html#l00730">GetNextRequestRange()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00255">impala::DiskIoMgr::RequestType::READ</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00270">impala::DiskIoMgr::RequestRange::request_type()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00659">shut_down_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00256">impala::DiskIoMgr::RequestType::WRITE</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l01041">Write()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>.</p>

</div>
</div>
<a class="anchor" id="a767af862da36691ad7b4799b5ad82744"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void DiskIoMgr::Write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1RequestContext.html">RequestContext</a> *&#160;</td>
          <td class="paramname"><em>writer_context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *&#160;</td>
          <td class="paramname"><em>write_range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Write the specified range to disk and calls HandleWriteFinished when done. Responsible for opening and closing the file that is written. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l01041">1041</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00266">impala::DiskIoMgr::RequestRange::file()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00277">impala::DiskIoMgr::RequestRange::file_</a>, <a class="el" href="error-util_8cc_source.html#l00030">impala::GetStrErrMsg()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00845">HandleWriteFinished()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l01061">WriteRangeHelper()</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00920">WorkLoop()</a>.</p>

</div>
</div>
<a class="anchor" id="aa2be4e061eae7032c992a901a7670465"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> DiskIoMgr::WriteRangeHelper </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>file_handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1DiskIoMgr_1_1WriteRange.html">WriteRange</a> *&#160;</td>
          <td class="paramname"><em>write_range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Helper method to write a range using the specified FILE handle. Returns <a class="el" href="classimpala_1_1Status.html">Status</a>:OK if the write succeeded, or a RUNTIME_ERROR with an appropriate message otherwise. Does not open or close the file that is written. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8cc_source.html#l01061">1061</a> of file <a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a>.</p>

<p>References <a class="el" href="disk-io-mgr_8h_source.html#l00477">impala::DiskIoMgr::WriteRange::data_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00277">impala::DiskIoMgr::RequestRange::file_</a>, <a class="el" href="error-util_8cc_source.html#l00030">impala::GetStrErrMsg()</a>, <a class="el" href="impalad-metrics_8h_source.html#l00147">impala::ImpaladMetrics::IO_MGR_BYTES_WRITTEN</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00283">impala::DiskIoMgr::RequestRange::len_</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00267">impala::DiskIoMgr::RequestRange::offset()</a>, and <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l01041">Write()</a>.</p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="ac9c5947135e52813c03a9c900161c428"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00629">629</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00610">GetBufferDesc()</a>.</p>

</div>
</div>
<a class="anchor" id="af1c05277e3e3ce9b9b00fecbd7130b31"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">friend class DiskIoMgrTest_Buffers_Test</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00631">631</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="af3884fdf813f9fb3b2a4b0d6942c45b2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct hadoopRzOptions* impala::DiskIoMgr::cached_read_options_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Options object for cached hdfs reads. Set on startup and never modified. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00655">655</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a0ba2f86ddaf75389adb493bdb0001929"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int DiskIoMgr::DEFAULT_QUEUE_CAPACITY = 2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Default ready buffer queue capacity. This constant doesn't matter too much since the system dynamically adjusts. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00619">619</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00140">impala::DiskIoMgr::RequestContext::Reset()</a>, and <a class="el" href="exec-env_8cc_source.html#l00282">impala::ExecEnv::StartServices()</a>.</p>

</div>
</div>
<a class="anchor" id="a998dafa247fd5bcac1b5a30232fb9d17"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structimpala_1_1DiskIoMgr_1_1DiskQueue.html">DiskQueue</a>*&gt; impala::DiskIoMgr::disk_queues_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Per disk queues. This is static and created once at <a class="el" href="classimpala_1_1DiskIoMgr.html#a1991e70528bab13363e3592d174d7a12" title="Initialize the IoMgr. Must be called once before any of the other APIs. ">Init()</a> time. One queue is allocated for each local disk on the system and for each remote filesystem type. It is indexed by disk id. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00701">701</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00219">DiskIoMgr()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00593">num_total_disks()</a>, <a class="el" href="disk-io-mgr-internal_8h_source.html#l00352">impala::DiskIoMgr::RequestContext::PerDiskState::ScheduleContext()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00444">ValidateScanRange()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a18797d98ff8df6a835c37baab65cddcc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ThreadGroup.html">ThreadGroup</a> impala::DiskIoMgr::disk_thread_group_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classimpala_1_1Thread.html" title="TODO: Consider allowing fragment IDs as category parameters. ">Thread</a> group containing all the worker threads. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00652">652</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a87763baaff5e691c4881d5147795d0d2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::list&lt;<a class="el" href="classimpala_1_1DiskIoMgr_1_1BufferDescriptor.html">BufferDescriptor</a>*&gt; impala::DiskIoMgr::free_buffer_descs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List of free buffer desc objects that can be handed out to clients. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00690">690</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00610">GetBufferDesc()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00602">ReturnBufferDesc()</a>.</p>

</div>
</div>
<a class="anchor" id="a59189dd1e2ba483252dca9043602e32b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::list&lt;char*&gt; &gt; impala::DiskIoMgr::free_buffers_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Free buffers that can be handed out to clients. There is one list for each buffer size, indexed by the Log2 of the buffer size in units of min_buffer_size_. The maximum buffer size is max_buffer_size_, so the maximum index is Log2(max_buffer_size_ / min_buffer_size_). E.g. if min_buffer_size_ = 1024 bytes: free_buffers_[0] =&gt; list of free buffers with size 1024 B free_buffers_[1] =&gt; list of free buffers with size 2048 B free_buffers_[10] =&gt; list of free buffers with size 1 MB free_buffers_[13] =&gt; list of free buffers with size 8 MB free_buffers_[n] =&gt; list of free buffers with size 2^n * 1024 B </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00687">687</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00219">DiskIoMgr()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l01095">free_buffers_idx()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a495366bfbc69a8a08eda7f6af084e30d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::mutex impala::DiskIoMgr::free_buffers_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protects free_buffers_ and free_buffer_descs_. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00674">674</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00610">GetBufferDesc()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00602">ReturnBufferDesc()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>.</p>

</div>
</div>
<a class="anchor" id="ae45a6778f947e194d7665fa340be2a95"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int impala::DiskIoMgr::max_buffer_size_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximum read size. This is also the maximum size of each allocated buffer. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00646">646</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l01103">AddWriteRange()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00219">DiskIoMgr()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00590">max_read_buffer_size()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00555">Read()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>.</p>

</div>
</div>
<a class="anchor" id="a1621cf94056e57b8d67cb38e06e6a3b4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int impala::DiskIoMgr::min_buffer_size_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The minimum size of each read buffer. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00649">649</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00219">DiskIoMgr()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l01095">free_buffers_idx()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>.</p>

</div>
</div>
<a class="anchor" id="af197b913784b65e86e0d5601a59c915f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1AtomicInt.html">AtomicInt</a>&lt;int&gt; impala::DiskIoMgr::num_allocated_buffers_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of allocated buffers, used for debugging. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00693">693</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00605">num_allocated_buffers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>, <a class="el" href="disk-io-mgr-test_8cc_source.html#l00964">impala::TEST_F()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="afc2062330fc1bdd9f1ee14093dbd69b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1AtomicInt.html">AtomicInt</a>&lt;int&gt; impala::DiskIoMgr::num_buffers_in_readers_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of buffers in readers. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00696">696</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr-scan-range_8cc_source.html#l00036">impala::DiskIoMgr::ScanRange::EnqueueBuffer()</a>, <a class="el" href="disk-io-mgr_8h_source.html#l00608">num_buffers_in_readers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00575">ReturnBuffer()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a57d6bef4f87965d26ae0f3ebdb2f747b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const int impala::DiskIoMgr::num_threads_per_disk_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of worker(read) threads per disk. Also the max depth of queued work to the disk. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00643">643</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>.</p>

</div>
</div>
<a class="anchor" id="a0ca2db2159fc27588ea77dc43c6b32f1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ObjectPool.html">ObjectPool</a> impala::DiskIoMgr::pool_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Pool to allocate BufferDescriptors. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00636">636</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00610">GetBufferDesc()</a>.</p>

</div>
</div>
<a class="anchor" id="a90831aea936eafbc9ad831dbfddcf25a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1MemTracker.html">MemTracker</a>* impala::DiskIoMgr::process_mem_tracker_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process memory tracker; needed to account for io buffers. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00639">639</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00661">GcIoBuffers()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00627">GetFreeBuffer()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00730">GetNextRequestRange()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00696">ReturnFreeBuffer()</a>.</p>

</div>
</div>
<a class="anchor" id="a9824ef6a01d96312a2c7a9f7c13b7809"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> impala::DiskIoMgr::read_timer_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total time spent in hdfs reading. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00665">665</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00440">GetReadThroughput()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>, and <a class="el" href="disk-io-mgr-reader-context_8cc_source.html#l00140">impala::DiskIoMgr::RequestContext::Reset()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ddb2e1d5fc8839916e38775875f44d5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::scoped_ptr&lt;<a class="el" href="classDiskIoMgr_1_1RequestContextCache.html">RequestContextCache</a>&gt; impala::DiskIoMgr::request_context_cache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Contains all contexts that the IoMgr is tracking. This includes contexts that are active as well as those in the process of being cancelled. This is a cache of context objects that get recycled to minimize object allocations and lock contention. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00671">671</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00296">Init()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00336">RegisterContext()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00344">UnregisterContext()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="aa38c0d8f31a90a97cb7aab33592f6a12"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">volatile <a class="el" href="classbool.html">bool</a> impala::DiskIoMgr::shut_down_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>True if the IoMgr should be torn down. Worker threads watch for this to know to terminate. This variable is read/written to by different threads. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00659">659</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00730">GetNextRequestRange()</a>, <a class="el" href="disk-io-mgr_8cc_source.html#l00920">WorkLoop()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00250">~DiskIoMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="ae98884865bff90f5bad4a6d814ac735a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1RuntimeProfile_1_1Counter.html">RuntimeProfile::Counter</a> impala::DiskIoMgr::total_bytes_read_counter_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total bytes read by the IoMgr. </p>

<p>Definition at line <a class="el" href="disk-io-mgr_8h_source.html#l00662">662</a> of file <a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a>.</p>

<p>Referenced by <a class="el" href="disk-io-mgr_8cc_source.html#l00440">GetReadThroughput()</a>, and <a class="el" href="disk-io-mgr_8cc_source.html#l00954">ReadRange()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>be/src/runtime/<a class="el" href="disk-io-mgr_8h_source.html">disk-io-mgr.h</a></li>
<li>be/src/runtime/<a class="el" href="disk-io-mgr_8cc_source.html">disk-io-mgr.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceimpala.html">impala</a></li><li class="navelem"><a class="el" href="classimpala_1_1DiskIoMgr.html">DiskIoMgr</a></li>
    <li class="footer">Generated on Thu May 7 2015 16:10:49 for Impala by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
