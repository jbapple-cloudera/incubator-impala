<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Impala: fe/src/main/java/com/cloudera/impala/planner/AnalyticPlanner.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Impala
   </div>
   <div id="projectbrief">Impalaistheopensource,nativeanalyticdatabaseforApacheHadoop.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('AnalyticPlanner_8java_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AnalyticPlanner.java</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AnalyticPlanner_8java.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2014 Cloudera Inc.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// limitations under the License.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">package </span>com.cloudera.impala.planner;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">import</span> java.util.Collections;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="keyword">import</span> java.util.Comparator;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">import</span> java.util.List;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">import</span> org.slf4j.Logger;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">import</span> org.slf4j.LoggerFactory;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html">com.cloudera.impala.analysis.AggregateInfoBase</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">com.cloudera.impala.analysis.AnalyticExpr</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo.html">com.cloudera.impala.analysis.AnalyticInfo</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticWindow.html">com.cloudera.impala.analysis.AnalyticWindow</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Analyzer.html">com.cloudera.impala.analysis.Analyzer</a>;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate.html">com.cloudera.impala.analysis.BinaryPredicate</a>;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BoolLiteral.html">com.cloudera.impala.analysis.BoolLiteral</a>;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">com.cloudera.impala.analysis.CompoundPredicate</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">import</span> <a class="code" href="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate_1_1Operator.html">com.cloudera.impala.analysis.CompoundPredicate.Operator</a>;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">com.cloudera.impala.analysis.Expr</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">com.cloudera.impala.analysis.ExprSubstitutionMap</a>;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1IsNullPredicate.html">com.cloudera.impala.analysis.IsNullPredicate</a>;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html">com.cloudera.impala.analysis.OrderByElement</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">com.cloudera.impala.analysis.SlotDescriptor</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">com.cloudera.impala.analysis.SlotRef</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SortInfo.html">com.cloudera.impala.analysis.SortInfo</a>;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">com.cloudera.impala.analysis.TupleDescriptor</a>;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">import</span> <a class="code" href="namespaceimpala.html#ae794620bedabff2a726194c228af75ce">com.cloudera.impala.analysis.TupleId</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleIsNullPredicate.html">com.cloudera.impala.analysis.TupleIsNullPredicate</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException.html">com.cloudera.impala.common.ImpalaException</a>;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TPartitionType;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">import</span> com.google.common.base.Preconditions;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">import</span> com.google.common.collect.Lists;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html">   68</a></span>&#160;<span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html">AnalyticPlanner</a> {</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aef94913960307b278150568d0a7b9b36">   69</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> Logger <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aef94913960307b278150568d0a7b9b36">LOG</a> = LoggerFactory.getLogger(AnalyticPlanner.class);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">// List of tuple ids materialized by the originating SelectStmt (i.e., what is returned</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// by SelectStmt.getMaterializedTupleIds()). During analysis, conjuncts have been</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// registered against these tuples, so we need them to find unassigned conjuncts during</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// plan generation.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// If the size of this list is 1 it means the stmt has a sort after the analytics.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">// Otherwise, the last tuple id must be analyticInfo_.getOutputTupleDesc().</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a83d1a5374544dd279ef917831bb7a361">   77</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> List&lt;TupleId&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a83d1a5374544dd279ef917831bb7a361">stmtTupleIds_</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">   79</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo.html">AnalyticInfo</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">analyticInfo_</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">   80</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Analyzer.html">Analyzer</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aebe2ff7b11e2e784bdb6c7d5fa31ea63">   81</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext.html">PlannerContext</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aebe2ff7b11e2e784bdb6c7d5fa31ea63">ctx_</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a567379c294b9b83679a77758e296bf22">   83</a></span>&#160;  <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a567379c294b9b83679a77758e296bf22">AnalyticPlanner</a>(List&lt;TupleId&gt; stmtTupleIds,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo.html">AnalyticInfo</a> analyticInfo, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Analyzer.html">Analyzer</a> analyzer,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext.html">PlannerContext</a> ctx) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    Preconditions.checkState(!stmtTupleIds.isEmpty());</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleId.html">TupleId</a> lastStmtTupleId = stmtTupleIds.get(stmtTupleIds.size() - 1);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    Preconditions.checkState(stmtTupleIds.size() == 1 ||</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        lastStmtTupleId.equals(analyticInfo.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html#a465aee9b3d8997f244cda6f133ea79d6">getOutputTupleId</a>()));</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a83d1a5374544dd279ef917831bb7a361">stmtTupleIds_</a> = stmtTupleIds;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">analyticInfo_</a> = analyticInfo;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a> = analyzer;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aebe2ff7b11e2e784bdb6c7d5fa31ea63">ctx_</a> = ctx;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#af587d92415e4c907f4d7923e5454ecc5">  109</a></span>&#160;  <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html">PlanNode</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#af587d92415e4c907f4d7923e5454ecc5">createSingleNodePlan</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html">PlanNode</a> root,</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      List&lt;Expr&gt; groupingExprs, List&lt;Expr&gt; inputPartitionExprs) <span class="keywordflow">throws</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException.html">ImpalaException</a> {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    List&lt;WindowGroup&gt; windowGroups = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a4799168094cc62e35a7d54c840951e4a">collectWindowGroups</a>();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; windowGroups.size(); ++i) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      windowGroups.get(i).init(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>, <span class="stringliteral">&quot;wg-&quot;</span> + i);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    }</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    List&lt;SortGroup&gt; sortGroups = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#af48ffb66adeb49557fe09af9e7d05e69">collectSortGroups</a>(windowGroups);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#acc8a7a77fd98710c17b2bba335cf81a0">mergeSortGroups</a>(sortGroups);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> g: sortGroups) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      g.init();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    List&lt;PartitionGroup&gt; partitionGroups = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#adc0d961d0d1e9c4745b0f6f51f1e3d1c">collectPartitionGroups</a>(sortGroups);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aada6f570a14350827d094b4b9cf2c952">mergePartitionGroups</a>(partitionGroups, root.getNumNodes());</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a2ed9148363c244cea14339c72fb0d3b4">orderGroups</a>(partitionGroups);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (groupingExprs != null) {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      Preconditions.checkNotNull(inputPartitionExprs);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a7ad5e3a7476e1d0867ff147fcfa35988">computeInputPartitionExprs</a>(</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          partitionGroups, groupingExprs, root.getNumNodes(), inputPartitionExprs);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    }</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> partitionGroup: partitionGroups) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; partitionGroup.sortGroups.size(); ++i) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        root = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#ad95ef6156b7072c08c5adb4c9869b0fe">createSortGroupPlan</a>(root, partitionGroup.sortGroups.get(i),</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            i == 0 ? partitionGroup.partitionByExprs : null);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// create equiv classes for newly added slots</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    analyzer_.createIdentityEquivClasses();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">return</span> root;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#acc8a7a77fd98710c17b2bba335cf81a0">  145</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#acc8a7a77fd98710c17b2bba335cf81a0">mergeSortGroups</a>(List&lt;SortGroup&gt; sortGroups) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">boolean</span> hasMerged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      hasMerged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sg1: sortGroups) {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sg2: sortGroups) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">if</span> (sg1 != sg2 &amp;&amp; sg1.isPrefixOf(sg2)) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            sg1.absorb(sg2);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            sortGroups.remove(sg2);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            hasMerged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;          }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">if</span> (hasMerged) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    } <span class="keywordflow">while</span> (hasMerged);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aada6f570a14350827d094b4b9cf2c952">  168</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aada6f570a14350827d094b4b9cf2c952">mergePartitionGroups</a>(</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      List&lt;PartitionGroup&gt; partitionGroups, <span class="keywordtype">int</span> numNodes) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordtype">boolean</span> hasMerged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      hasMerged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> pg1: partitionGroups) {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> pg2: partitionGroups) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          <span class="keywordflow">if</span> (pg1 != pg2) {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="keywordtype">long</span> ndv = Expr.getNumDistinctValues(</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                Expr.intersect(pg1.partitionByExprs, pg2.partitionByExprs));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="keywordflow">if</span> (ndv == -1 || ndv &lt; 0 || ndv &lt; numNodes) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;              <span class="comment">// didn&#39;t get a usable value or the number of partitions is too small</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;              <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            pg1.merge(pg2);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            partitionGroups.remove(pg2);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            hasMerged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> (hasMerged) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    } <span class="keywordflow">while</span> (hasMerged);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a7ad5e3a7476e1d0867ff147fcfa35988">  200</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a7ad5e3a7476e1d0867ff147fcfa35988">computeInputPartitionExprs</a>(List&lt;PartitionGroup&gt; partitionGroups,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      List&lt;Expr&gt; groupingExprs, <span class="keywordtype">int</span> numNodes, List&lt;Expr&gt; inputPartitionExprs) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    inputPartitionExprs.clear();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// find partition group with maximum intersection</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">long</span> maxNdv = 0;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> maxPg = null;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    List&lt;Expr&gt; maxGroupingExprs = null;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> pg: partitionGroups) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      List&lt;Expr&gt; l1 = Lists.newArrayList();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      List&lt;Expr&gt; l2 = Lists.newArrayList();</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      Expr.intersect(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>, pg.partitionByExprs, groupingExprs,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;          analyzer_.getEquivClassSmap(), l1, l2);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="comment">// TODO: also look at l2 and take the max?</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      <span class="keywordtype">long</span> ndv = Expr.getNumDistinctValues(l1);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">if</span> (ndv &lt; 0 || ndv &lt; numNodes || ndv &lt; maxNdv) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      <span class="comment">// found a better partition group</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      maxPg = pg;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      maxPg.partitionByExprs = l1;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      maxGroupingExprs = l2;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      maxNdv = ndv;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (maxNdv &gt; numNodes) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      Preconditions.checkNotNull(maxPg);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="comment">// we found a partition group that gives us enough parallelism;</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="comment">// move it to the front</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      partitionGroups.remove(maxPg);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      partitionGroups.add(0, maxPg);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      inputPartitionExprs.addAll(maxGroupingExprs);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a2ed9148363c244cea14339c72fb0d3b4">  238</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a2ed9148363c244cea14339c72fb0d3b4">orderGroups</a>(List&lt;PartitionGroup&gt; partitionGroups) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// remove the non-partitioning group from partitionGroups</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> nonPartitioning = null;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> pg: partitionGroups) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">if</span> (pg.partitionByExprs.isEmpty()) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        nonPartitioning = pg;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (nonPartitioning != null) partitionGroups.remove(nonPartitioning);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// order by ascending combined output tuple size</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    Collections.sort(partitionGroups,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keyword">new</span> Comparator&lt;PartitionGroup&gt;() {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="keyword">public</span> <span class="keywordtype">int</span> compare(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> pg1, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> pg2) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            Preconditions.checkState(pg1.totalOutputTupleSize &gt; 0);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            Preconditions.checkState(pg2.totalOutputTupleSize &gt; 0);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="keywordtype">int</span> diff = pg1.totalOutputTupleSize - pg2.totalOutputTupleSize;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="keywordflow">return</span> (diff &lt; 0 ? -1 : (diff &gt; 0 ? 1 : 0));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;          }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        });</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (nonPartitioning != null) partitionGroups.add(nonPartitioning);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> pg: partitionGroups) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      pg.orderSortGroups();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    }</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  }</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa2476aecabc52f2598fe650a8243b927">  270</a></span>&#160;  <span class="keyword">private</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SortInfo.html">SortInfo</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa2476aecabc52f2598fe650a8243b927">createSortInfo</a>(</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html">PlanNode</a> input, List&lt;Expr&gt; sortExprs, List&lt;Boolean&gt; isAsc,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      List&lt;Boolean&gt; nullsFirst) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// create tuple for sort output = the entire materialized input in a single tuple</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">TupleDescriptor</a> sortTupleDesc =</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        analyzer_.getDescTbl().createTupleDescriptor(<span class="stringliteral">&quot;sort-tuple&quot;</span>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a> sortSmap = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a>();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    List&lt;Expr&gt; sortSlotExprs = Lists.newArrayList();</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    sortTupleDesc.setIsMaterialized(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleId.html">TupleId</a> tid: input.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html#ac7d0db4439c91a8935884d153887b088">getTupleIds</a>()) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">TupleDescriptor</a> tupleDesc = analyzer_.getTupleDesc(tid);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> inputSlotDesc: tupleDesc.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html#a9a335d81cfb69d3d2a6f85554489b852">getSlots</a>()) {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">if</span> (!inputSlotDesc.isMaterialized()) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> sortSlotDesc =</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            analyzer_.copySlotDescriptor(inputSlotDesc, sortTupleDesc);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="comment">// all output slots need to be materialized</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        sortSlotDesc.setIsMaterialized(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        sortSmap.put(<span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">SlotRef</a>(inputSlotDesc), <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">SlotRef</a>(sortSlotDesc));</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        sortSlotExprs.add(<span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">SlotRef</a>(inputSlotDesc));</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      }</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// Lhs exprs to be substituted in ancestor plan nodes could have a rhs that contains</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// TupleIsNullPredicates. TupleIsNullPredicates require specific tuple ids for</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// evaluation. Since this sort materializes a new tuple, it&#39;s impossible to evaluate</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// TupleIsNullPredicates referring to this sort&#39;s input after this sort,</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// To preserve the information whether an input tuple was null or not this sort node,</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// we materialize those rhs TupleIsNullPredicates, which are then substituted</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// by a SlotRef into the sort&#39;s tuple in ancestor nodes (IMPALA-1519).</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a> inputSmap = input.getOutputSmap();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (inputSmap != null) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;      List&lt;Expr&gt; tupleIsNullPredsToMaterialize = Lists.newArrayList();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; inputSmap.size(); ++i) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> rhsExpr = inputSmap.getRhs().<span class="keyword">get</span>(i);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// Ignore substitutions that are irrelevant at this plan node and its ancestors.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keywordflow">if</span> (!rhsExpr.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#ac5e146d6d77a3dcdec4ad8d51489638a">isBoundByTupleIds</a>(input.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html#ac7d0db4439c91a8935884d153887b088">getTupleIds</a>())) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        rhsExpr.collect(TupleIsNullPredicate.class, tupleIsNullPredsToMaterialize);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      Expr.removeDuplicates(tupleIsNullPredsToMaterialize);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="comment">// Materialize relevant unique TupleIsNullPredicates.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> tupleIsNullPred: tupleIsNullPredsToMaterialize) {</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> sortSlotDesc = analyzer_.addSlotDescriptor(sortTupleDesc);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        sortSlotDesc.setType(tupleIsNullPred.getType());</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        sortSlotDesc.setIsMaterialized(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        sortSlotDesc.setSourceExpr(tupleIsNullPred);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        sortSlotDesc.setLabel(tupleIsNullPred.toSql());</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        sortSlotExprs.add(tupleIsNullPred.clone());</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SortInfo.html">SortInfo</a> sortInfo = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SortInfo.html">SortInfo</a>(</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#a3a3d69ce201a6b24ead2ed5ed96f0063">substituteList</a>(sortExprs, sortSmap, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>, <span class="keyword">false</span>), isAsc, nullsFirst);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    LOG.trace(<span class="stringliteral">&quot;sortinfo exprs: &quot;</span> + Expr.debugString(sortInfo.getOrderingExprs()));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    sortInfo.setMaterializedTupleInfo(sortTupleDesc, sortSlotExprs);</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> sortInfo;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#ad95ef6156b7072c08c5adb4c9869b0fe">  334</a></span>&#160;  <span class="keyword">private</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html">PlanNode</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#ad95ef6156b7072c08c5adb4c9869b0fe">createSortGroupPlan</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html">PlanNode</a> root, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sortGroup,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      List&lt;Expr&gt; partitionExprs) <span class="keywordflow">throws</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException.html">ImpalaException</a> {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    List&lt;Expr&gt; partitionByExprs = sortGroup.partitionByExprs;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    List&lt;OrderByElement&gt; orderByElements = sortGroup.orderByElements;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a> sortSmap = null;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleId.html">TupleId</a> sortTupleId = null;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">TupleDescriptor</a> bufferedTupleDesc = null;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// map from input to buffered tuple</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a> bufferedSmap = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a>();</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// sort on partition by (pb) + order by (ob) exprs and create pb/ob predicates</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> (!partitionByExprs.isEmpty() || !orderByElements.isEmpty()) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="comment">// first sort on partitionExprs (direction doesn&#39;t matter)</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      List&lt;Expr&gt; sortExprs = Lists.newArrayList(partitionByExprs);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      List&lt;Boolean&gt; isAsc =</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;          Lists.newArrayList(Collections.nCopies(sortExprs.size(), <span class="keyword">new</span> Boolean(<span class="keyword">true</span>)));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="comment">// TODO: utilize a direction and nulls/first last that has benefit</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <span class="comment">// for subsequent sort groups</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      List&lt;Boolean&gt; nullsFirst =</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          Lists.newArrayList(Collections.nCopies(sortExprs.size(), <span class="keyword">new</span> Boolean(<span class="keyword">true</span>)));</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="comment">// then sort on orderByExprs</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html">OrderByElement</a> orderByElement: sortGroup.orderByElements) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        sortExprs.add(orderByElement.getExpr());</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        isAsc.add(orderByElement.isAsc());</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        nullsFirst.add(orderByElement.getNullsFirstParam());</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SortInfo.html">SortInfo</a> sortInfo = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa2476aecabc52f2598fe650a8243b927">createSortInfo</a>(root, sortExprs, isAsc, nullsFirst);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1SortNode.html">SortNode</a> sortNode = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1SortNode.html">SortNode</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aebe2ff7b11e2e784bdb6c7d5fa31ea63">ctx_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext.html#af60cf05e54d6c00065ff1036cdddd62b">getNextNodeId</a>(), root, sortInfo, <span class="keyword">false</span>, 0);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="comment">// if this sort group does not have partitioning exprs, we want the sort</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      <span class="comment">// to be executed like a regular distributed sort</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      <span class="keywordflow">if</span> (!partitionByExprs.isEmpty()) sortNode.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1SortNode.html#aa33fa6981f0627ced86d8fc4acacacda">setIsAnalyticSort</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">if</span> (partitionExprs != null) {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="comment">// create required input partition</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1DataPartition.html">DataPartition</a> inputPartition = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1DataPartition.html#a087a59b75a1c5d168e82041f69a6e32b">DataPartition.UNPARTITIONED</a>;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">if</span> (!partitionExprs.isEmpty()) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;          inputPartition =</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;              <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1DataPartition.html">DataPartition</a>(TPartitionType.HASH_PARTITIONED, partitionExprs);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        sortNode.setInputPartition(inputPartition);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      root = sortNode;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      root.init(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      sortSmap = sortNode.getOutputSmap();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="comment">// create bufferedTupleDesc and bufferedSmap</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      sortTupleId = sortNode.tupleIds_.get(0);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      bufferedTupleDesc =</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          analyzer_.getDescTbl().copyTupleDescriptor(sortTupleId, <span class="stringliteral">&quot;buffered-tuple&quot;</span>);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      LOG.trace(<span class="stringliteral">&quot;desctbl: &quot;</span> + analyzer_.getDescTbl().debugString());</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      List&lt;SlotDescriptor&gt; inputSlots = analyzer_.getTupleDesc(sortTupleId).getSlots();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      List&lt;SlotDescriptor&gt; bufferedSlots = bufferedTupleDesc.getSlots();</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; inputSlots.size(); ++i) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        bufferedSmap.put(</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">SlotRef</a>(inputSlots.get(i)), <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">SlotRef</a>(bufferedSlots.get(i)));</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// create one AnalyticEvalNode per window group</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> windowGroup: sortGroup.windowGroups) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// Create partition-by (pb) and order-by (ob) less-than predicates between the</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="comment">// input tuple (the output of the preceding sort) and a buffered tuple that is</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">// identical to the input tuple. We need a different tuple descriptor for the</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="comment">// buffered tuple because the generated predicates should compare two different</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="comment">// tuple instances from the same input stream (i.e., the predicates should be</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="comment">// evaluated over a row that is composed of the input and the buffered tuple).</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="comment">// we need to remap the pb/ob exprs to a) the sort output, b) our buffer of the</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="comment">// sort input</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> partitionByEq = null;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">if</span> (!windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ace82f20ee91054a88ef27287772cc326">partitionByExprs</a>.isEmpty()) {</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        partitionByEq = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa0650cf538f56f9c4c36227e70f80d9c">createNullMatchingEquals</a>(</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#a3a3d69ce201a6b24ead2ed5ed96f0063">substituteList</a>(windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ace82f20ee91054a88ef27287772cc326">partitionByExprs</a>, sortSmap, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>, <span class="keyword">false</span>),</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            sortTupleId, bufferedSmap);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        LOG.trace(<span class="stringliteral">&quot;partitionByEq: &quot;</span> + partitionByEq.debugString());</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> orderByEq = null;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="keywordflow">if</span> (!windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">orderByElements</a>.isEmpty()) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        orderByEq = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa0650cf538f56f9c4c36227e70f80d9c">createNullMatchingEquals</a>(</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html">OrderByElement</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#ada2c54ea1c130631bb2bb59b7a2ad430">getOrderByExprs</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html">OrderByElement</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#a696851e1f4d283e7338e7db9a1da98b9">substitute</a>(</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">orderByElements</a>, sortSmap, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>)),</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            sortTupleId, bufferedSmap);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        LOG.trace(<span class="stringliteral">&quot;orderByEq: &quot;</span> + orderByEq.debugString());</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      root = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticEvalNode.html">AnalyticEvalNode</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aebe2ff7b11e2e784bdb6c7d5fa31ea63">ctx_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext.html#af60cf05e54d6c00065ff1036cdddd62b">getNextNodeId</a>(), root, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a83d1a5374544dd279ef917831bb7a361">stmtTupleIds_</a>,</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;          windowGroup.analyticFnCalls, windowGroup.partitionByExprs,</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;          windowGroup.orderByElements,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;          windowGroup.window, analyticInfo_.getOutputTupleDesc(),</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;          windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a277042303d29b2e5fc177fc30aae283f">physicalIntermediateTuple</a>,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;          windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">physicalOutputTuple</a>, windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ad840484db6ed1f1d74a8d42c12ec8564">logicalToPhysicalSmap</a>,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;          partitionByEq, orderByEq, bufferedTupleDesc);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      root.init(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">return</span> root;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa0650cf538f56f9c4c36227e70f80d9c">  439</a></span>&#160;  <span class="keyword">private</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa0650cf538f56f9c4c36227e70f80d9c">createNullMatchingEquals</a>(List&lt;Expr&gt; exprs, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleId.html">TupleId</a> inputTid,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a> bufferedSmap) {</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    Preconditions.checkState(!exprs.isEmpty());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> result = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a87789bb6ddb150cb70c4dcda5c087b24">createNullMatchingEqualsAux</a>(exprs, 0, inputTid, bufferedSmap);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    result.analyzeNoThrow(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a87789bb6ddb150cb70c4dcda5c087b24">  456</a></span>&#160;  <span class="keyword">private</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a87789bb6ddb150cb70c4dcda5c087b24">createNullMatchingEqualsAux</a>(List&lt;Expr&gt; elements, <span class="keywordtype">int</span> i,</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleId.html">TupleId</a> inputTid, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a> bufferedSmap) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (i &gt; elements.size() - 1) <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BoolLiteral.html">BoolLiteral</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// compare elements[i]</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> lhs = elements.get(i);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    Preconditions.checkState(lhs.isBound(inputTid));</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> rhs = lhs.substitute(bufferedSmap, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">analyzer_</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> bothNull = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">CompoundPredicate</a>(<a class="code" href="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate_1_1Operator.html">Operator</a>.AND,</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1IsNullPredicate.html">IsNullPredicate</a>(lhs, <span class="keyword">false</span>), <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1IsNullPredicate.html">IsNullPredicate</a>(rhs, <span class="keyword">false</span>));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> lhsEqRhsNotNull = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">CompoundPredicate</a>(<a class="code" href="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate_1_1Operator.html">Operator</a>.AND,</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">CompoundPredicate</a>(<a class="code" href="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate_1_1Operator.html">Operator</a>.AND,</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1IsNullPredicate.html">IsNullPredicate</a>(lhs, <span class="keyword">true</span>), <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1IsNullPredicate.html">IsNullPredicate</a>(rhs, <span class="keyword">true</span>)),</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate.html">BinaryPredicate</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate.html">BinaryPredicate</a>.Operator.EQ, lhs, rhs));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a> remainder = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a87789bb6ddb150cb70c4dcda5c087b24">createNullMatchingEqualsAux</a>(elements, i + 1, inputTid, bufferedSmap);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">CompoundPredicate</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">CompoundPredicate</a>.Operator.AND,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">CompoundPredicate</a>(<a class="code" href="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate_1_1Operator.html">Operator</a>.OR, bothNull, lhsEqRhsNotNull),</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        remainder);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">  481</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class </span><a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> {</div>
<div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ace82f20ee91054a88ef27287772cc326">  482</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> List&lt;Expr&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ace82f20ee91054a88ef27287772cc326">partitionByExprs</a>;</div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">  483</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> List&lt;OrderByElement&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">orderByElements</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a1aa9e9bd910cb379bc11e637e3047062">  484</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticWindow.html">AnalyticWindow</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a1aa9e9bd910cb379bc11e637e3047062">window</a>; <span class="comment">// not null</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// Analytic exprs belonging to this window group and their corresponding logical</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// intermediate and output slots from AnalyticInfo.intermediateTupleDesc_</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// and AnalyticInfo.outputTupleDesc_.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ae7cc99e88143d41a667509ed9c2ed47a">  489</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> List&lt;AnalyticExpr&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ae7cc99e88143d41a667509ed9c2ed47a">analyticExprs</a> = Lists.newArrayList();</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// Result of getFnCall() for every analytic expr.</span></div>
<div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a8b490027b14b5ced5a3043f5a705e7ba">  491</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> List&lt;Expr&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a8b490027b14b5ced5a3043f5a705e7ba">analyticFnCalls</a> = Lists.newArrayList();</div>
<div class="line"><a name="l00492"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a9ae8eecf3981ea3aa7eb525d1a88d36f">  492</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> List&lt;SlotDescriptor&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a9ae8eecf3981ea3aa7eb525d1a88d36f">logicalOutputSlots</a> = Lists.newArrayList();</div>
<div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#aaf93f7bfc7f14b6248916082285acf08">  493</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> List&lt;SlotDescriptor&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#aaf93f7bfc7f14b6248916082285acf08">logicalIntermediateSlots</a> = Lists.newArrayList();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="comment">// Physical output and intermediate tuples as well as an smap that maps the</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="comment">// corresponding logical output slots to their physical slots in physicalOutputTuple.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">// Set in init().</span></div>
<div class="line"><a name="l00498"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">  498</a></span>&#160;    <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">TupleDescriptor</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">physicalOutputTuple</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a277042303d29b2e5fc177fc30aae283f">  499</a></span>&#160;    <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">TupleDescriptor</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a277042303d29b2e5fc177fc30aae283f">physicalIntermediateTuple</a>;</div>
<div class="line"><a name="l00500"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ad840484db6ed1f1d74a8d42c12ec8564">  500</a></span>&#160;    <span class="keyword">public</span> <span class="keyword">final</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ad840484db6ed1f1d74a8d42c12ec8564">logicalToPhysicalSmap</a> = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">ExprSubstitutionMap</a>();</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a894edb79f11585d3f2e7bf00b2b2ae62">  502</a></span>&#160;    <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a894edb79f11585d3f2e7bf00b2b2ae62">WindowGroup</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a> analyticExpr, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> logicalOutputSlot,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> logicalIntermediateSlot) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ace82f20ee91054a88ef27287772cc326">partitionByExprs</a> = analyticExpr.getPartitionExprs();</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">orderByElements</a> = analyticExpr.getOrderByElements();</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a1aa9e9bd910cb379bc11e637e3047062">window</a> = analyticExpr.getWindow();</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      analyticExprs.add(analyticExpr);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      analyticFnCalls.add(analyticExpr.getFnCall());</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      logicalOutputSlots.add(logicalOutputSlot);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      logicalIntermediateSlots.add(logicalIntermediateSlot);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a743de5e978bb184733c4a707e00da154">  516</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">boolean</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a743de5e978bb184733c4a707e00da154">requiresIndependentEval</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a> analyticExpr) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      <span class="keywordflow">return</span> analyticExpr.getFnCall().getFnName().getFunction().equals(</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html#afc814cb7972eaaea2d81ab90cb959384">FIRST_VALUE_REWRITE</a>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a0a5435f887afafe8c197550d8986861b">  525</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a0a5435f887afafe8c197550d8986861b">isCompatible</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a> analyticExpr) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a743de5e978bb184733c4a707e00da154">requiresIndependentEval</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ae7cc99e88143d41a667509ed9c2ed47a">analyticExprs</a>.get(0)) ||</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;          <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a743de5e978bb184733c4a707e00da154">requiresIndependentEval</a>(analyticExpr)) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#a1485f2d014b72fd3912c79779ad1e74c">equalSets</a>(analyticExpr.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html#ad58b40be48af423047c6e8c6f42cbc89">getPartitionExprs</a>(), <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ace82f20ee91054a88ef27287772cc326">partitionByExprs</a>)) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      <span class="keywordflow">if</span> (!analyticExpr.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html#aa2c7f3bcd93a9c00c5c9b97844ea779a">getOrderByElements</a>().equals(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">orderByElements</a>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a1aa9e9bd910cb379bc11e637e3047062">window</a> == null) != (analyticExpr.getWindow() == null)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a1aa9e9bd910cb379bc11e637e3047062">window</a> == null) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">return</span> analyticExpr.getWindow().equals(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a1aa9e9bd910cb379bc11e637e3047062">window</a>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a45d0b8160226eb23c48b64af2cddcdba">  544</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a45d0b8160226eb23c48b64af2cddcdba">add</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a> analyticExpr, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> logicalOutputSlot,</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> logicalIntermediateSlot) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      Preconditions.checkState(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a0a5435f887afafe8c197550d8986861b">isCompatible</a>(analyticExpr));</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;      analyticExprs.add(analyticExpr);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      analyticFnCalls.add(analyticExpr.getFnCall());</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      logicalOutputSlots.add(logicalOutputSlot);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      logicalIntermediateSlots.add(logicalIntermediateSlot);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div>
<div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a848e63426ebe90446c956b93894a9b57">  558</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a848e63426ebe90446c956b93894a9b57">init</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Analyzer.html">Analyzer</a> analyzer, String tupleName) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;      Preconditions.checkState(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">physicalOutputTuple</a> == null);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      Preconditions.checkState(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a277042303d29b2e5fc177fc30aae283f">physicalIntermediateTuple</a> == null);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      Preconditions.checkState(analyticFnCalls.size() == <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ae7cc99e88143d41a667509ed9c2ed47a">analyticExprs</a>.size());</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="comment">// If needed, create the intermediate tuple first to maintain</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="comment">// intermediateTupleId &lt; outputTupleId for debugging purposes and consistency with</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      <span class="comment">// tuple creation for aggregations.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <span class="keywordtype">boolean</span> requiresIntermediateTuple =</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;          AggregateInfoBase.requiresIntermediateTuple(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a8b490027b14b5ced5a3043f5a705e7ba">analyticFnCalls</a>);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">if</span> (requiresIntermediateTuple) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        physicalIntermediateTuple =</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            analyzer.getDescTbl().createTupleDescriptor(tupleName + <span class="stringliteral">&quot;intermed&quot;</span>);</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        physicalOutputTuple =</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            analyzer.getDescTbl().createTupleDescriptor(tupleName + <span class="stringliteral">&quot;out&quot;</span>);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        physicalOutputTuple =</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            analyzer.getDescTbl().createTupleDescriptor(tupleName + <span class="stringliteral">&quot;out&quot;</span>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        physicalIntermediateTuple = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">physicalOutputTuple</a>;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      Preconditions.checkState(analyticExprs.size() == <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#aaf93f7bfc7f14b6248916082285acf08">logicalIntermediateSlots</a>.size());</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      Preconditions.checkState(analyticExprs.size() == <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a9ae8eecf3981ea3aa7eb525d1a88d36f">logicalOutputSlots</a>.size());</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; analyticExprs.size(); ++i) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> logicalOutputSlot = logicalOutputSlots.get(i);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> physicalOutputSlot =</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            analyzer.copySlotDescriptor(logicalOutputSlot, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">physicalOutputTuple</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        physicalOutputSlot.setIsMaterialized(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keywordflow">if</span> (requiresIntermediateTuple) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;          <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> logicalIntermediateSlot = logicalIntermediateSlots.get(i);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;          <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">SlotDescriptor</a> physicalIntermediateSlot = analyzer.copySlotDescriptor(</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;              logicalIntermediateSlot, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a277042303d29b2e5fc177fc30aae283f">physicalIntermediateTuple</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;          physicalIntermediateSlot.setIsMaterialized(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        logicalToPhysicalSmap.put(</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">SlotRef</a>(logicalOutputSlot), <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">SlotRef</a>(physicalOutputSlot));</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      physicalOutputTuple.computeMemLayout();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="keywordflow">if</span> (requiresIntermediateTuple) physicalIntermediateTuple.computeMemLayout();</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    }</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div>
<div class="line"><a name="l00603"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a4799168094cc62e35a7d54c840951e4a">  603</a></span>&#160;  <span class="keyword">private</span> List&lt;WindowGroup&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a4799168094cc62e35a7d54c840951e4a">collectWindowGroups</a>() {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    List&lt;Expr&gt; analyticExprs = analyticInfo_.getAnalyticExprs();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    List&lt;WindowGroup&gt; groups = Lists.newArrayList();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; analyticExprs.size(); ++i) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a> analyticExpr = (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a>) analyticExprs.get(i);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="comment">// Do not generate the plan for non-materialized analytic exprs.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">analyticInfo_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html#a7f990d7e9a35a541063c545e483bf8ba">getOutputTupleDesc</a>().getSlots().<span class="keyword">get</span>(i).isMaterialized()) {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordtype">boolean</span> match = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> group: groups) {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">if</span> (group.isCompatible(analyticExpr)) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          group.add((<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a>) <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">analyticInfo_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo.html#a9f0acfb0782601d4ab4acc199edc302f">getAnalyticExprs</a>().get(i),</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;              <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">analyticInfo_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html#a7f990d7e9a35a541063c545e483bf8ba">getOutputTupleDesc</a>().getSlots().<span class="keyword">get</span>(i),</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;              analyticInfo_.getIntermediateTupleDesc().getSlots().get(i));</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          match = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">if</span> (!match) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        groups.add(<span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a>(</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">AnalyticExpr</a>) <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">analyticInfo_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo.html#a9f0acfb0782601d4ab4acc199edc302f">getAnalyticExprs</a>().get(i),</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">analyticInfo_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html#a7f990d7e9a35a541063c545e483bf8ba">getOutputTupleDesc</a>().getSlots().<span class="keyword">get</span>(i),</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            analyticInfo_.getIntermediateTupleDesc().getSlots().get(i)));</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">return</span> groups;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  }</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div>
<div class="line"><a name="l00636"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">  636</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class </span><a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> {</div>
<div class="line"><a name="l00637"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ab919c45198d454e10facc7b13cc653af">  637</a></span>&#160;    <span class="keyword">public</span> List&lt;Expr&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ab919c45198d454e10facc7b13cc653af">partitionByExprs</a>;</div>
<div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9f47bdebc93fdab981d8476578788b90">  638</a></span>&#160;    <span class="keyword">public</span> List&lt;OrderByElement&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9f47bdebc93fdab981d8476578788b90">orderByElements</a>;</div>
<div class="line"><a name="l00639"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9dc160af1954132d863387b147a5f0d8">  639</a></span>&#160;    <span class="keyword">public</span> List&lt;WindowGroup&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9dc160af1954132d863387b147a5f0d8">windowGroups</a> = Lists.newArrayList();</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="comment">// sum of windowGroups.physicalOutputTuple.getByteSize()</span></div>
<div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ac61f963a0ff96d91b5bd164ef1bd3c59">  642</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ac61f963a0ff96d91b5bd164ef1bd3c59">totalOutputTupleSize</a> = -1;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a6715693a5cabb7c6248c8b9ecab77d9d">  644</a></span>&#160;    <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a6715693a5cabb7c6248c8b9ecab77d9d">SortGroup</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> windowGroup) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ab919c45198d454e10facc7b13cc653af">partitionByExprs</a> = windowGroup.partitionByExprs;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9f47bdebc93fdab981d8476578788b90">orderByElements</a> = windowGroup.orderByElements;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      windowGroups.add(windowGroup);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div>
<div class="line"><a name="l00653"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a7fb10fd7b59e57bbd2a01188248c2e36">  653</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a7fb10fd7b59e57bbd2a01188248c2e36">isCompatible</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> windowGroup) {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">return</span> Expr.equalSets(windowGroup.partitionByExprs, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ab919c45198d454e10facc7b13cc653af">partitionByExprs</a>)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          &amp;&amp; windowGroup.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">orderByElements</a>.equals(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9f47bdebc93fdab981d8476578788b90">orderByElements</a>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div>
<div class="line"><a name="l00658"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a063c3f6412e1fda6e9ba60c3a63d5881">  658</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a063c3f6412e1fda6e9ba60c3a63d5881">add</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> windowGroup) {</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      Preconditions.checkState(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a7fb10fd7b59e57bbd2a01188248c2e36">isCompatible</a>(windowGroup));</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      windowGroups.add(windowGroup);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a6dcc9b1423d3bf7ebb09ac7f7accfe9f">  667</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a6dcc9b1423d3bf7ebb09ac7f7accfe9f">isPrefixOf</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> other) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      <span class="keywordflow">if</span> (other.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9f47bdebc93fdab981d8476578788b90">orderByElements</a>.size() &gt; orderByElements.size()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">Expr</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#a1485f2d014b72fd3912c79779ad1e74c">equalSets</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ab919c45198d454e10facc7b13cc653af">partitionByExprs</a>, other.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ab919c45198d454e10facc7b13cc653af">partitionByExprs</a>)) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; other.orderByElements.size(); ++i) {</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html">OrderByElement</a> ob = orderByElements.get(i);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html">OrderByElement</a> otherOb = other.orderByElements.get(i);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <span class="comment">// TODO: compare equiv classes by comparing each equiv class&#39;s placeholder</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="comment">// slotref</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <span class="keywordflow">if</span> (!ob.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#a3da9f5b0a801fc0644041a21b60bfdd1">getExpr</a>().equals(otherOb.getExpr())) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">if</span> (ob.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#ad693100793ddb9e4f8fb4db3c9fe66d3">isAsc</a>() != otherOb.isAsc()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">if</span> (ob.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#a9f2cceb5f987f4ac5cb3bbf7309f26de">nullsFirst</a>() != otherOb.nullsFirst()) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a2cd582ee326ebcffca0a424c43f488ab">  685</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a2cd582ee326ebcffca0a424c43f488ab">absorb</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> other) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      Preconditions.checkState(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a6dcc9b1423d3bf7ebb09ac7f7accfe9f">isPrefixOf</a>(other));</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      windowGroups.addAll(other.windowGroups);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div>
<div class="line"><a name="l00693"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a591098850808a58a179decc6c4cefe6f">  693</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a591098850808a58a179decc6c4cefe6f">init</a>() {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ac61f963a0ff96d91b5bd164ef1bd3c59">totalOutputTupleSize</a> = 0;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> g: <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9dc160af1954132d863387b147a5f0d8">windowGroups</a>) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">TupleDescriptor</a> outputTuple = g.physicalOutputTuple;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        Preconditions.checkState(outputTuple.isMaterialized());</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        Preconditions.checkState(outputTuple.getByteSize() != -1);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ac61f963a0ff96d91b5bd164ef1bd3c59">totalOutputTupleSize</a> += outputTuple.getByteSize();</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div>
<div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html">  703</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class </span><a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html">SizeLt</a> <span class="keyword">implements</span> Comparator&lt;WindowGroup&gt; {</div>
<div class="line"><a name="l00704"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html#a490995a534aa1e9021f2cbd609f39c75">  704</a></span>&#160;      <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html#a490995a534aa1e9021f2cbd609f39c75">compare</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> wg1, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> wg2) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        Preconditions.checkState(wg1.physicalOutputTuple != null</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            &amp;&amp; wg1.physicalOutputTuple.getByteSize() != -1);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        Preconditions.checkState(wg2.physicalOutputTuple != null</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            &amp;&amp; wg2.physicalOutputTuple.getByteSize() != -1);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="keywordtype">int</span> diff = wg1.physicalOutputTuple.getByteSize()</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            - wg2.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">physicalOutputTuple</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html#a76ab4e904b0f62f0831838828cc12eb9">getByteSize</a>();</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">return</span> (diff &lt; 0 ? -1 : (diff &gt; 0 ? 1 : 0));</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div>
<div class="line"><a name="l00715"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a06c64f2f53ccc9bafc922f62fc3d4e85">  715</a></span>&#160;    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html">SizeLt</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a06c64f2f53ccc9bafc922f62fc3d4e85">SIZE_LT</a>;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keyword">static</span> {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a06c64f2f53ccc9bafc922f62fc3d4e85">SIZE_LT</a> = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html">SizeLt</a>();</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a58f90914037b9488f21cea025b37b4e1">  724</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a58f90914037b9488f21cea025b37b4e1">orderWindowGroups</a>() {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      Collections.sort(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9dc160af1954132d863387b147a5f0d8">windowGroups</a>, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a06c64f2f53ccc9bafc922f62fc3d4e85">SIZE_LT</a>);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#af48ffb66adeb49557fe09af9e7d05e69">  732</a></span>&#160;  <span class="keyword">private</span> List&lt;SortGroup&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#af48ffb66adeb49557fe09af9e7d05e69">collectSortGroups</a>(List&lt;WindowGroup&gt; windowGroups) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    List&lt;SortGroup&gt; sortGroups = Lists.newArrayList();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">WindowGroup</a> windowGroup: windowGroups) {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordtype">boolean</span> match = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sortGroup: sortGroups) {</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">if</span> (sortGroup.isCompatible(windowGroup)) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          sortGroup.add(windowGroup);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;          match = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        }</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="keywordflow">if</span> (!match) sortGroups.add(<span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a>(windowGroup));</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">return</span> sortGroups;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div>
<div class="line"><a name="l00751"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">  751</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class </span><a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> {</div>
<div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">  752</a></span>&#160;    <span class="keyword">public</span> List&lt;Expr&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">partitionByExprs</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#aef8b61b9032122ea1e22a271d2788b9f">  753</a></span>&#160;    <span class="keyword">public</span> List&lt;SortGroup&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#aef8b61b9032122ea1e22a271d2788b9f">sortGroups</a> = Lists.newArrayList();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// sum of sortGroups.windowGroups.physicalOutputTuple.getByteSize()</span></div>
<div class="line"><a name="l00756"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a69496490e5bd0ff978776ee83b755b85">  756</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a69496490e5bd0ff978776ee83b755b85">totalOutputTupleSize</a> = -1;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div>
<div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a64d9338cb0e99da4b172bcb72834cd02">  758</a></span>&#160;    <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a64d9338cb0e99da4b172bcb72834cd02">PartitionGroup</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sortGroup) {</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">partitionByExprs</a> = sortGroup.partitionByExprs;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      sortGroups.add(sortGroup);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a69496490e5bd0ff978776ee83b755b85">totalOutputTupleSize</a> = sortGroup.totalOutputTupleSize;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a00b5c51d096d1e361a6239a8ac6626f7">  768</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a00b5c51d096d1e361a6239a8ac6626f7">isCompatible</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sortGroup) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      <span class="keywordflow">return</span> Expr.equalSets(sortGroup.partitionByExprs, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">partitionByExprs</a>);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div>
<div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a1a47bba35d510e3f05b95f49f797c9c3">  772</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a1a47bba35d510e3f05b95f49f797c9c3">add</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sortGroup) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      Preconditions.checkState(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a00b5c51d096d1e361a6239a8ac6626f7">isCompatible</a>(sortGroup));</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      sortGroups.add(sortGroup);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a69496490e5bd0ff978776ee83b755b85">totalOutputTupleSize</a> += sortGroup.totalOutputTupleSize;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00783"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a2a311db04c05dfdf16a0b203d2372cc9">  783</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a2a311db04c05dfdf16a0b203d2372cc9">merge</a>(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> other) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">partitionByExprs</a> = Expr.intersect(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">partitionByExprs</a>, other.partitionByExprs);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      Preconditions.checkState(Expr.getNumDistinctValues(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">partitionByExprs</a>) &gt;= 0);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      sortGroups.addAll(other.sortGroups);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a585a0db005c719775f29939a85eedc82">  793</a></span>&#160;    <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a585a0db005c719775f29939a85eedc82">orderSortGroups</a>() {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      Collections.sort(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#aef8b61b9032122ea1e22a271d2788b9f">sortGroups</a>,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;          <span class="keyword">new</span> Comparator&lt;SortGroup&gt;() {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;            <span class="keyword">public</span> <span class="keywordtype">int</span> compare(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sg1, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sg2) {</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;              Preconditions.checkState(sg1.totalOutputTupleSize &gt; 0);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;              Preconditions.checkState(sg2.totalOutputTupleSize &gt; 0);</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;              <span class="keywordtype">int</span> diff = sg1.totalOutputTupleSize - sg2.totalOutputTupleSize;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;              <span class="keywordflow">return</span> (diff &lt; 0 ? -1 : (diff &gt; 0 ? 1 : 0));</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;          });</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sortGroup: sortGroups) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        sortGroup.orderWindowGroups();</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#adc0d961d0d1e9c4745b0f6f51f1e3d1c">  812</a></span>&#160;  <span class="keyword">private</span> List&lt;PartitionGroup&gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#adc0d961d0d1e9c4745b0f6f51f1e3d1c">collectPartitionGroups</a>(List&lt;SortGroup&gt; sortGroups) {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    List&lt;PartitionGroup&gt; partitionGroups = Lists.newArrayList();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">SortGroup</a> sortGroup: sortGroups) {</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordtype">boolean</span> match = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a> partitionGroup: partitionGroups) {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">if</span> (partitionGroup.isCompatible(sortGroup)) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;          partitionGroup.add(sortGroup);</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;          match = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">if</span> (!match) partitionGroups.add(<span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">PartitionGroup</a>(sortGroup));</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">return</span> partitionGroups;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;  }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;}</div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_a00b5c51d096d1e361a6239a8ac6626f7"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a00b5c51d096d1e361a6239a8ac6626f7">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.isCompatible</a></div><div class="ttdeci">boolean isCompatible(SortGroup sortGroup)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00768">AnalyticPlanner.java:768</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement_html_a9f2cceb5f987f4ac5cb3bbf7309f26de"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#a9f2cceb5f987f4ac5cb3bbf7309f26de">com.cloudera.impala.analysis.OrderByElement.nullsFirst</a></div><div class="ttdeci">boolean nullsFirst()</div><div class="ttdef"><b>Definition:</b> <a href="OrderByElement_8java_source.html#l00049">OrderByElement.java:49</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a591098850808a58a179decc6c4cefe6f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a591098850808a58a179decc6c4cefe6f">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00693">AnalyticPlanner.java:693</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html">com.cloudera.impala.analysis.TupleDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="TupleDescriptor_8java_source.html#l00054">TupleDescriptor.java:54</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a9f47bdebc93fdab981d8476578788b90"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9f47bdebc93fdab981d8476578788b90">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.orderByElements</a></div><div class="ttdeci">List&lt; OrderByElement &gt; orderByElements</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00638">AnalyticPlanner.java:638</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_a41e8454f141b0c09078da11544605ed1"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a41e8454f141b0c09078da11544605ed1">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.partitionByExprs</a></div><div class="ttdeci">List&lt; Expr &gt; partitionByExprs</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00752">AnalyticPlanner.java:752</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a06c64f2f53ccc9bafc922f62fc3d4e85"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a06c64f2f53ccc9bafc922f62fc3d4e85">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.SIZE_LT</a></div><div class="ttdeci">static final SizeLt SIZE_LT</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00715">AnalyticPlanner.java:715</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_acc8a7a77fd98710c17b2bba335cf81a0"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#acc8a7a77fd98710c17b2bba335cf81a0">com.cloudera.impala.planner.AnalyticPlanner.mergeSortGroups</a></div><div class="ttdeci">void mergeSortGroups(List&lt; SortGroup &gt; sortGroups)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00145">AnalyticPlanner.java:145</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo_html_a9f0acfb0782601d4ab4acc199edc302f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo.html#a9f0acfb0782601d4ab4acc199edc302f">com.cloudera.impala.analysis.AnalyticInfo.getAnalyticExprs</a></div><div class="ttdeci">ArrayList&lt; Expr &gt; getAnalyticExprs()</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticInfo_8java_source.html#l00056">AnalyticInfo.java:56</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_ae7cc99e88143d41a667509ed9c2ed47a"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ae7cc99e88143d41a667509ed9c2ed47a">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.analyticExprs</a></div><div class="ttdeci">final List&lt; AnalyticExpr &gt; analyticExprs</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00489">AnalyticPlanner.java:489</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a9ae8eecf3981ea3aa7eb525d1a88d36f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a9ae8eecf3981ea3aa7eb525d1a88d36f">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.logicalOutputSlots</a></div><div class="ttdeci">final List&lt; SlotDescriptor &gt; logicalOutputSlots</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00492">AnalyticPlanner.java:492</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_a83d1a5374544dd279ef917831bb7a361"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a83d1a5374544dd279ef917831bb7a361">com.cloudera.impala.planner.AnalyticPlanner.stmtTupleIds_</a></div><div class="ttdeci">final List&lt; TupleId &gt; stmtTupleIds_</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00077">AnalyticPlanner.java:77</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate.html">com.cloudera.impala.analysis.BinaryPredicate</a></div><div class="ttdef"><b>Definition:</b> <a href="BinaryPredicate_8java_source.html#l00042">BinaryPredicate.java:42</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html">com.cloudera.impala.analysis.AggregateInfoBase</a></div><div class="ttdef"><b>Definition:</b> <a href="AggregateInfoBase_8java_source.html#l00020">AggregateInfoBase.java:20</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_aef94913960307b278150568d0a7b9b36"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aef94913960307b278150568d0a7b9b36">com.cloudera.impala.planner.AnalyticPlanner.LOG</a></div><div class="ttdeci">static final Logger LOG</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00069">AnalyticPlanner.java:69</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_a64d9338cb0e99da4b172bcb72834cd02"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a64d9338cb0e99da4b172bcb72834cd02">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.PartitionGroup</a></div><div class="ttdeci">PartitionGroup(SortGroup sortGroup)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00758">AnalyticPlanner.java:758</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement_html_a3da9f5b0a801fc0644041a21b60bfdd1"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#a3da9f5b0a801fc0644041a21b60bfdd1">com.cloudera.impala.analysis.OrderByElement.getExpr</a></div><div class="ttdeci">Expr getExpr()</div><div class="ttdef"><b>Definition:</b> <a href="OrderByElement_8java_source.html#l00045">OrderByElement.java:45</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1DataPartition_html_a087a59b75a1c5d168e82041f69a6e32b"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1DataPartition.html#a087a59b75a1c5d168e82041f69a6e32b">com.cloudera.impala.planner.DataPartition.UNPARTITIONED</a></div><div class="ttdeci">static final DataPartition UNPARTITIONED</div><div class="ttdef"><b>Definition:</b> <a href="DataPartition_8java_source.html#l00063">DataPartition.java:63</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor_html_a76ab4e904b0f62f0831838828cc12eb9"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html#a76ab4e904b0f62f0831838828cc12eb9">com.cloudera.impala.analysis.TupleDescriptor.getByteSize</a></div><div class="ttdeci">int getByteSize()</div><div class="ttdef"><b>Definition:</b> <a href="TupleDescriptor_8java_source.html#l00122">TupleDescriptor.java:122</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_aa0650cf538f56f9c4c36227e70f80d9c"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa0650cf538f56f9c4c36227e70f80d9c">com.cloudera.impala.planner.AnalyticPlanner.createNullMatchingEquals</a></div><div class="ttdeci">Expr createNullMatchingEquals(List&lt; Expr &gt; exprs, TupleId inputTid, ExprSubstitutionMap bufferedSmap)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00439">AnalyticPlanner.java:439</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a1aa9e9bd910cb379bc11e637e3047062"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a1aa9e9bd910cb379bc11e637e3047062">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.window</a></div><div class="ttdeci">final AnalyticWindow window</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00484">AnalyticPlanner.java:484</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html">com.cloudera.impala.planner.PlanNode</a></div><div class="ttdef"><b>Definition:</b> <a href="PlanNode_8java_source.html#l00059">PlanNode.java:59</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_af587d92415e4c907f4d7923e5454ecc5"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#af587d92415e4c907f4d7923e5454ecc5">com.cloudera.impala.planner.AnalyticPlanner.createSingleNodePlan</a></div><div class="ttdeci">PlanNode createSingleNodePlan(PlanNode root, List&lt; Expr &gt; groupingExprs, List&lt; Expr &gt; inputPartitionExprs)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00109">AnalyticPlanner.java:109</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SortInfo_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SortInfo.html">com.cloudera.impala.analysis.SortInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="SortInfo_8java_source.html#l00029">SortInfo.java:29</a></div></div>
<div class="ttc" id="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate_1_1Operator_html"><div class="ttname"><a href="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate_1_1Operator.html">com.cloudera.impala.analysis.CompoundPredicate.Operator</a></div><div class="ttdef"><b>Definition:</b> <a href="CompoundPredicate_8java_source.html#l00036">CompoundPredicate.java:36</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotRef.html">com.cloudera.impala.analysis.SlotRef</a></div><div class="ttdef"><b>Definition:</b> <a href="SlotRef_8java_source.html#l00035">SlotRef.java:35</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_aada6f570a14350827d094b4b9cf2c952"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aada6f570a14350827d094b4b9cf2c952">com.cloudera.impala.planner.AnalyticPlanner.mergePartitionGroups</a></div><div class="ttdeci">void mergePartitionGroups(List&lt; PartitionGroup &gt; partitionGroups, int numNodes)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00168">AnalyticPlanner.java:168</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.SizeLt</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00703">AnalyticPlanner.java:703</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_ace82f20ee91054a88ef27287772cc326"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ace82f20ee91054a88ef27287772cc326">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.partitionByExprs</a></div><div class="ttdeci">final List&lt; Expr &gt; partitionByExprs</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00482">AnalyticPlanner.java:482</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase_html_a465aee9b3d8997f244cda6f133ea79d6"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html#a465aee9b3d8997f244cda6f133ea79d6">com.cloudera.impala.analysis.AggregateInfoBase.getOutputTupleId</a></div><div class="ttdeci">TupleId getOutputTupleId()</div><div class="ttdef"><b>Definition:</b> <a href="AggregateInfoBase_8java_source.html#l00161">AggregateInfoBase.java:161</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr_html_ad58b40be48af423047c6e8c6f42cbc89"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html#ad58b40be48af423047c6e8c6f42cbc89">com.cloudera.impala.analysis.AnalyticExpr.getPartitionExprs</a></div><div class="ttdeci">List&lt; Expr &gt; getPartitionExprs()</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticExpr_8java_source.html#l00119">AnalyticExpr.java:119</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a45d0b8160226eb23c48b64af2cddcdba"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a45d0b8160226eb23c48b64af2cddcdba">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.add</a></div><div class="ttdeci">void add(AnalyticExpr analyticExpr, SlotDescriptor logicalOutputSlot, SlotDescriptor logicalIntermediateSlot)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00544">AnalyticPlanner.java:544</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_adc0d961d0d1e9c4745b0f6f51f1e3d1c"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#adc0d961d0d1e9c4745b0f6f51f1e3d1c">com.cloudera.impala.planner.AnalyticPlanner.collectPartitionGroups</a></div><div class="ttdeci">List&lt; PartitionGroup &gt; collectPartitionGroups(List&lt; SortGroup &gt; sortGroups)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00812">AnalyticPlanner.java:812</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a0a5435f887afafe8c197550d8986861b"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a0a5435f887afafe8c197550d8986861b">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.isCompatible</a></div><div class="ttdeci">boolean isCompatible(AnalyticExpr analyticExpr)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00525">AnalyticPlanner.java:525</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement_html_ada2c54ea1c130631bb2bb59b7a2ad430"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#ada2c54ea1c130631bb2bb59b7a2ad430">com.cloudera.impala.analysis.OrderByElement.getOrderByExprs</a></div><div class="ttdeci">static List&lt; Expr &gt; getOrderByExprs(List&lt; OrderByElement &gt; src)</div><div class="ttdef"><b>Definition:</b> <a href="OrderByElement_8java_source.html#l00123">OrderByElement.java:123</a></div></div>
<div class="ttc" id="namespaceimpala_html_ae794620bedabff2a726194c228af75ce"><div class="ttname"><a href="namespaceimpala.html#ae794620bedabff2a726194c228af75ce">impala::TupleId</a></div><div class="ttdeci">int TupleId</div><div class="ttdef"><b>Definition:</b> <a href="global-types_8h_source.html#l00023">global-types.h:23</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_aebe2ff7b11e2e784bdb6c7d5fa31ea63"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aebe2ff7b11e2e784bdb6c7d5fa31ea63">com.cloudera.impala.planner.AnalyticPlanner.ctx_</a></div><div class="ttdeci">final PlannerContext ctx_</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00081">AnalyticPlanner.java:81</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticInfo.html">com.cloudera.impala.analysis.AnalyticInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticInfo_8java_source.html#l00032">AnalyticInfo.java:32</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr_html_a3a3d69ce201a6b24ead2ed5ed96f0063"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#a3a3d69ce201a6b24ead2ed5ed96f0063">com.cloudera.impala.analysis.Expr.substituteList</a></div><div class="ttdeci">static ArrayList&lt; Expr &gt; substituteList(Iterable&lt;?extends Expr &gt; exprs, ExprSubstitutionMap smap, Analyzer analyzer, boolean preserveRootTypes)</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8java_source.html#l00730">Expr.java:730</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticWindow_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticWindow.html">com.cloudera.impala.analysis.AnalyticWindow</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticWindow_8java_source.html#l00035">AnalyticWindow.java:35</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1IsNullPredicate_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1IsNullPredicate.html">com.cloudera.impala.analysis.IsNullPredicate</a></div><div class="ttdef"><b>Definition:</b> <a href="IsNullPredicate_8java_source.html#l00032">IsNullPredicate.java:32</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_aa2476aecabc52f2598fe650a8243b927"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa2476aecabc52f2598fe650a8243b927">com.cloudera.impala.planner.AnalyticPlanner.createSortInfo</a></div><div class="ttdeci">SortInfo createSortInfo(PlanNode input, List&lt; Expr &gt; sortExprs, List&lt; Boolean &gt; isAsc, List&lt; Boolean &gt; nullsFirst)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00270">AnalyticPlanner.java:270</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_a585a0db005c719775f29939a85eedc82"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a585a0db005c719775f29939a85eedc82">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.orderSortGroups</a></div><div class="ttdeci">void orderSortGroups()</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00793">AnalyticPlanner.java:793</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr_html_afc814cb7972eaaea2d81ab90cb959384"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html#afc814cb7972eaaea2d81ab90cb959384">com.cloudera.impala.analysis.AnalyticExpr.FIRST_VALUE_REWRITE</a></div><div class="ttdeci">static String FIRST_VALUE_REWRITE</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticExpr_8java_source.html#l00090">AnalyticExpr.java:90</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_a567379c294b9b83679a77758e296bf22"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a567379c294b9b83679a77758e296bf22">com.cloudera.impala.planner.AnalyticPlanner.AnalyticPlanner</a></div><div class="ttdeci">AnalyticPlanner(List&lt; TupleId &gt; stmtTupleIds, AnalyticInfo analyticInfo, Analyzer analyzer, PlannerContext ctx)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00083">AnalyticPlanner.java:83</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_a69bf180e8494a7b929f8c4e7fa1829e9"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a69bf180e8494a7b929f8c4e7fa1829e9">com.cloudera.impala.planner.AnalyticPlanner.analyzer_</a></div><div class="ttdeci">final Analyzer analyzer_</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00080">AnalyticPlanner.java:80</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BoolLiteral_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1BoolLiteral.html">com.cloudera.impala.analysis.BoolLiteral</a></div><div class="ttdef"><b>Definition:</b> <a href="BoolLiteral_8java_source.html#l00024">BoolLiteral.java:24</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr_html_aa2c7f3bcd93a9c00c5c9b97844ea779a"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html#aa2c7f3bcd93a9c00c5c9b97844ea779a">com.cloudera.impala.analysis.AnalyticExpr.getOrderByElements</a></div><div class="ttdeci">List&lt; OrderByElement &gt; getOrderByElements()</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticExpr_8java_source.html#l00120">AnalyticExpr.java:120</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_a87789bb6ddb150cb70c4dcda5c087b24"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a87789bb6ddb150cb70c4dcda5c087b24">com.cloudera.impala.planner.AnalyticPlanner.createNullMatchingEqualsAux</a></div><div class="ttdeci">Expr createNullMatchingEqualsAux(List&lt; Expr &gt; elements, int i, TupleId inputTid, ExprSubstitutionMap bufferedSmap)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00456">AnalyticPlanner.java:456</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00481">AnalyticPlanner.java:481</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode_html_ac7d0db4439c91a8935884d153887b088"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlanNode.html#ac7d0db4439c91a8935884d153887b088">com.cloudera.impala.planner.PlanNode.getTupleIds</a></div><div class="ttdeci">ArrayList&lt; TupleId &gt; getTupleIds()</div><div class="ttdef"><b>Definition:</b> <a href="PlanNode_8java_source.html#l00196">PlanNode.java:196</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_aef8b61b9032122ea1e22a271d2788b9f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#aef8b61b9032122ea1e22a271d2788b9f">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.sortGroups</a></div><div class="ttdeci">List&lt; SortGroup &gt; sortGroups</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00753">AnalyticPlanner.java:753</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a2cd582ee326ebcffca0a424c43f488ab"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a2cd582ee326ebcffca0a424c43f488ab">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.absorb</a></div><div class="ttdeci">void absorb(SortGroup other)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00685">AnalyticPlanner.java:685</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html">com.cloudera.impala.analysis.Expr</a></div><div class="ttdef"><b>Definition:</b> <a href="Expr_8java_source.html#l00048">Expr.java:48</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a49420de9e9f0b68c7a4311707c9acc11"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a49420de9e9f0b68c7a4311707c9acc11">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.physicalOutputTuple</a></div><div class="ttdeci">TupleDescriptor physicalOutputTuple</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00498">AnalyticPlanner.java:498</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement_html_a696851e1f4d283e7338e7db9a1da98b9"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#a696851e1f4d283e7338e7db9a1da98b9">com.cloudera.impala.analysis.OrderByElement.substitute</a></div><div class="ttdeci">static List&lt; OrderByElement &gt; substitute(List&lt; OrderByElement &gt; src, ExprSubstitutionMap smap, Analyzer analyzer)</div><div class="ttdef"><b>Definition:</b> <a href="OrderByElement_8java_source.html#l00110">OrderByElement.java:110</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_a69496490e5bd0ff978776ee83b755b85"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a69496490e5bd0ff978776ee83b755b85">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.totalOutputTupleSize</a></div><div class="ttdeci">int totalOutputTupleSize</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00756">AnalyticPlanner.java:756</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1SlotDescriptor.html">com.cloudera.impala.analysis.SlotDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="SlotDescriptor_8java_source.html#l00029">SlotDescriptor.java:29</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_aaf93f7bfc7f14b6248916082285acf08"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#aaf93f7bfc7f14b6248916082285acf08">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.logicalIntermediateSlots</a></div><div class="ttdeci">final List&lt; SlotDescriptor &gt; logicalIntermediateSlots</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00493">AnalyticPlanner.java:493</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor_html_a9a335d81cfb69d3d2a6f85554489b852"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleDescriptor.html#a9a335d81cfb69d3d2a6f85554489b852">com.cloudera.impala.analysis.TupleDescriptor.getSlots</a></div><div class="ttdeci">ArrayList&lt; SlotDescriptor &gt; getSlots()</div><div class="ttdef"><b>Definition:</b> <a href="TupleDescriptor_8java_source.html#l00096">TupleDescriptor.java:96</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_a2ed9148363c244cea14339c72fb0d3b4"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a2ed9148363c244cea14339c72fb0d3b4">com.cloudera.impala.planner.AnalyticPlanner.orderGroups</a></div><div class="ttdeci">void orderGroups(List&lt; PartitionGroup &gt; partitionGroups)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00238">AnalyticPlanner.java:238</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_aa5b4aeaad644ed3db5e09aa57fd9f373"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#aa5b4aeaad644ed3db5e09aa57fd9f373">com.cloudera.impala.planner.AnalyticPlanner.analyticInfo_</a></div><div class="ttdeci">final AnalyticInfo analyticInfo_</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00079">AnalyticPlanner.java:79</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a063c3f6412e1fda6e9ba60c3a63d5881"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a063c3f6412e1fda6e9ba60c3a63d5881">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.add</a></div><div class="ttdeci">void add(WindowGroup windowGroup)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00658">AnalyticPlanner.java:658</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a6dcc9b1423d3bf7ebb09ac7f7accfe9f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a6dcc9b1423d3bf7ebb09ac7f7accfe9f">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.isPrefixOf</a></div><div class="ttdeci">boolean isPrefixOf(SortGroup other)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00667">AnalyticPlanner.java:667</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a848e63426ebe90446c956b93894a9b57"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a848e63426ebe90446c956b93894a9b57">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.init</a></div><div class="ttdeci">void init(Analyzer analyzer, String tupleName)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00558">AnalyticPlanner.java:558</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AnalyticExpr.html">com.cloudera.impala.analysis.AnalyticExpr</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticExpr_8java_source.html#l00060">AnalyticExpr.java:60</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a58f90914037b9488f21cea025b37b4e1"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a58f90914037b9488f21cea025b37b4e1">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.orderWindowGroups</a></div><div class="ttdeci">void orderWindowGroups()</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00724">AnalyticPlanner.java:724</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement_html_ad693100793ddb9e4f8fb4db3c9fe66d3"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html#ad693100793ddb9e4f8fb4db3c9fe66d3">com.cloudera.impala.analysis.OrderByElement.isAsc</a></div><div class="ttdeci">boolean isAsc()</div><div class="ttdef"><b>Definition:</b> <a href="OrderByElement_8java_source.html#l00047">OrderByElement.java:47</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Analyzer_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Analyzer.html">com.cloudera.impala.analysis.Analyzer</a></div><div class="ttdef"><b>Definition:</b> <a href="Analyzer_8java_source.html#l00105">Analyzer.java:105</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a7fb10fd7b59e57bbd2a01188248c2e36"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a7fb10fd7b59e57bbd2a01188248c2e36">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.isCompatible</a></div><div class="ttdeci">boolean isCompatible(WindowGroup windowGroup)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00653">AnalyticPlanner.java:653</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_af48ffb66adeb49557fe09af9e7d05e69"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#af48ffb66adeb49557fe09af9e7d05e69">com.cloudera.impala.planner.AnalyticPlanner.collectSortGroups</a></div><div class="ttdeci">List&lt; SortGroup &gt; collectSortGroups(List&lt; WindowGroup &gt; windowGroups)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00732">AnalyticPlanner.java:732</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_a4799168094cc62e35a7d54c840951e4a"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a4799168094cc62e35a7d54c840951e4a">com.cloudera.impala.planner.AnalyticPlanner.collectWindowGroups</a></div><div class="ttdeci">List&lt; WindowGroup &gt; collectWindowGroups()</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00603">AnalyticPlanner.java:603</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_ac61f963a0ff96d91b5bd164ef1bd3c59"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ac61f963a0ff96d91b5bd164ef1bd3c59">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.totalOutputTupleSize</a></div><div class="ttdeci">int totalOutputTupleSize</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00642">AnalyticPlanner.java:642</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_a2a311db04c05dfdf16a0b203d2372cc9"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a2a311db04c05dfdf16a0b203d2372cc9">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.merge</a></div><div class="ttdeci">void merge(PartitionGroup other)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00783">AnalyticPlanner.java:783</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00751">AnalyticPlanner.java:751</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a894edb79f11585d3f2e7bf00b2b2ae62"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a894edb79f11585d3f2e7bf00b2b2ae62">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.WindowGroup</a></div><div class="ttdeci">WindowGroup(AnalyticExpr analyticExpr, SlotDescriptor logicalOutputSlot, SlotDescriptor logicalIntermediateSlot)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00502">AnalyticPlanner.java:502</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt_html_a490995a534aa1e9021f2cbd609f39c75"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_1_1SizeLt.html#a490995a534aa1e9021f2cbd609f39c75">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.SizeLt.compare</a></div><div class="ttdeci">int compare(WindowGroup wg1, WindowGroup wg2)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00704">AnalyticPlanner.java:704</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1OrderByElement.html">com.cloudera.impala.analysis.OrderByElement</a></div><div class="ttdef"><b>Definition:</b> <a href="OrderByElement_8java_source.html#l00025">OrderByElement.java:25</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext.html">com.cloudera.impala.planner.PlannerContext</a></div><div class="ttdef"><b>Definition:</b> <a href="PlannerContext_8java_source.html#l00028">PlannerContext.java:28</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1CompoundPredicate.html">com.cloudera.impala.analysis.CompoundPredicate</a></div><div class="ttdef"><b>Definition:</b> <a href="CompoundPredicate_8java_source.html#l00035">CompoundPredicate.java:35</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_ab919c45198d454e10facc7b13cc653af"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#ab919c45198d454e10facc7b13cc653af">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.partitionByExprs</a></div><div class="ttdeci">List&lt; Expr &gt; partitionByExprs</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00637">AnalyticPlanner.java:637</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a6312bb112346ebe2fde5d77a19b470cf"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a6312bb112346ebe2fde5d77a19b470cf">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.orderByElements</a></div><div class="ttdeci">final List&lt; OrderByElement &gt; orderByElements</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00483">AnalyticPlanner.java:483</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleId_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleId.html">com.cloudera.impala.analysis.TupleId</a></div><div class="ttdef"><b>Definition:</b> <a href="TupleId_8java_source.html#l00023">TupleId.java:23</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1ExprSubstitutionMap.html">com.cloudera.impala.analysis.ExprSubstitutionMap</a></div><div class="ttdef"><b>Definition:</b> <a href="ExprSubstitutionMap_8java_source.html#l00020">ExprSubstitutionMap.java:20</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext_html_af60cf05e54d6c00065ff1036cdddd62b"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1PlannerContext.html#af60cf05e54d6c00065ff1036cdddd62b">com.cloudera.impala.planner.PlannerContext.getNextNodeId</a></div><div class="ttdeci">PlanNodeId getNextNodeId()</div><div class="ttdef"><b>Definition:</b> <a href="PlannerContext_8java_source.html#l00063">PlannerContext.java:63</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr_html_a1485f2d014b72fd3912c79779ad1e74c"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#a1485f2d014b72fd3912c79779ad1e74c">com.cloudera.impala.analysis.Expr.equalSets</a></div><div class="ttdeci">static&lt; CextendsExpr &gt; boolean equalSets(List&lt; C &gt; l1, List&lt; C &gt; l2)</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8java_source.html#l00598">Expr.java:598</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html">com.cloudera.impala.planner.AnalyticPlanner</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00068">AnalyticPlanner.java:68</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticEvalNode_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticEvalNode.html">com.cloudera.impala.planner.AnalyticEvalNode</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticEvalNode_8java_source.html#l00043">AnalyticEvalNode.java:43</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a9dc160af1954132d863387b147a5f0d8"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a9dc160af1954132d863387b147a5f0d8">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.windowGroups</a></div><div class="ttdeci">List&lt; WindowGroup &gt; windowGroups</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00639">AnalyticPlanner.java:639</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a8b490027b14b5ced5a3043f5a705e7ba"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a8b490027b14b5ced5a3043f5a705e7ba">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.analyticFnCalls</a></div><div class="ttdeci">final List&lt; Expr &gt; analyticFnCalls</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00491">AnalyticPlanner.java:491</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleIsNullPredicate_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1TupleIsNullPredicate.html">com.cloudera.impala.analysis.TupleIsNullPredicate</a></div><div class="ttdef"><b>Definition:</b> <a href="TupleIsNullPredicate_8java_source.html#l00039">TupleIsNullPredicate.java:39</a></div></div>
<div class="ttc" id="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate_1_1Operator_html"><div class="ttname"><a href="enumcom_1_1cloudera_1_1impala_1_1analysis_1_1BinaryPredicate_1_1Operator.html">com.cloudera.impala.analysis.BinaryPredicate.Operator</a></div><div class="ttdef"><b>Definition:</b> <a href="BinaryPredicate_8java_source.html#l00045">BinaryPredicate.java:45</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_ad840484db6ed1f1d74a8d42c12ec8564"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#ad840484db6ed1f1d74a8d42c12ec8564">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.logicalToPhysicalSmap</a></div><div class="ttdeci">final ExprSubstitutionMap logicalToPhysicalSmap</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00500">AnalyticPlanner.java:500</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1SortNode_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1SortNode.html">com.cloudera.impala.planner.SortNode</a></div><div class="ttdef"><b>Definition:</b> <a href="SortNode_8java_source.html#l00047">SortNode.java:47</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_a7ad5e3a7476e1d0867ff147fcfa35988"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#a7ad5e3a7476e1d0867ff147fcfa35988">com.cloudera.impala.planner.AnalyticPlanner.computeInputPartitionExprs</a></div><div class="ttdeci">void computeInputPartitionExprs(List&lt; PartitionGroup &gt; partitionGroups, List&lt; Expr &gt; groupingExprs, int numNodes, List&lt; Expr &gt; inputPartitionExprs)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00200">AnalyticPlanner.java:200</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a277042303d29b2e5fc177fc30aae283f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a277042303d29b2e5fc177fc30aae283f">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.physicalIntermediateTuple</a></div><div class="ttdeci">TupleDescriptor physicalIntermediateTuple</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00499">AnalyticPlanner.java:499</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1DataPartition_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1DataPartition.html">com.cloudera.impala.planner.DataPartition</a></div><div class="ttdef"><b>Definition:</b> <a href="DataPartition_8java_source.html#l00039">DataPartition.java:39</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1SortNode_html_aa33fa6981f0627ced86d8fc4acacacda"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1SortNode.html#aa33fa6981f0627ced86d8fc4acacacda">com.cloudera.impala.planner.SortNode.setIsAnalyticSort</a></div><div class="ttdeci">void setIsAnalyticSort(boolean v)</div><div class="ttdef"><b>Definition:</b> <a href="SortNode_8java_source.html#l00085">SortNode.java:85</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr_html_ac5e146d6d77a3dcdec4ad8d51489638a"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1Expr.html#ac5e146d6d77a3dcdec4ad8d51489638a">com.cloudera.impala.analysis.Expr.isBoundByTupleIds</a></div><div class="ttdeci">boolean isBoundByTupleIds(List&lt; TupleId &gt; tids)</div><div class="ttdef"><b>Definition:</b> <a href="Expr_8java_source.html#l00852">Expr.java:852</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup_html_a743de5e978bb184733c4a707e00da154"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1WindowGroup.html#a743de5e978bb184733c4a707e00da154">com.cloudera.impala.planner.AnalyticPlanner.WindowGroup.requiresIndependentEval</a></div><div class="ttdeci">static boolean requiresIndependentEval(AnalyticExpr analyticExpr)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00516">AnalyticPlanner.java:516</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase_html_a7f990d7e9a35a541063c545e483bf8ba"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1analysis_1_1AggregateInfoBase.html#a7f990d7e9a35a541063c545e483bf8ba">com.cloudera.impala.analysis.AggregateInfoBase.getOutputTupleDesc</a></div><div class="ttdeci">TupleDescriptor getOutputTupleDesc()</div><div class="ttdef"><b>Definition:</b> <a href="AggregateInfoBase_8java_source.html#l00158">AggregateInfoBase.java:158</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException.html">com.cloudera.impala.common.ImpalaException</a></div><div class="ttdef"><b>Definition:</b> <a href="ImpalaException_8java_source.html#l00022">ImpalaException.java:22</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html">com.cloudera.impala.planner.AnalyticPlanner.SortGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00636">AnalyticPlanner.java:636</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup_html_a1a47bba35d510e3f05b95f49f797c9c3"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1PartitionGroup.html#a1a47bba35d510e3f05b95f49f797c9c3">com.cloudera.impala.planner.AnalyticPlanner.PartitionGroup.add</a></div><div class="ttdeci">void add(SortGroup sortGroup)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00772">AnalyticPlanner.java:772</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup_html_a6715693a5cabb7c6248c8b9ecab77d9d"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_1_1SortGroup.html#a6715693a5cabb7c6248c8b9ecab77d9d">com.cloudera.impala.planner.AnalyticPlanner.SortGroup.SortGroup</a></div><div class="ttdeci">SortGroup(WindowGroup windowGroup)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00644">AnalyticPlanner.java:644</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner_html_ad95ef6156b7072c08c5adb4c9869b0fe"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1planner_1_1AnalyticPlanner.html#ad95ef6156b7072c08c5adb4c9869b0fe">com.cloudera.impala.planner.AnalyticPlanner.createSortGroupPlan</a></div><div class="ttdeci">PlanNode createSortGroupPlan(PlanNode root, SortGroup sortGroup, List&lt; Expr &gt; partitionExprs)</div><div class="ttdef"><b>Definition:</b> <a href="AnalyticPlanner_8java_source.html#l00334">AnalyticPlanner.java:334</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_ca2797c59c2e868cd2eca72571423f6a.html">fe</a></li><li class="navelem"><a class="el" href="dir_9456c03c9c6e5a96e843b28fc5c6395b.html">src</a></li><li class="navelem"><a class="el" href="dir_31c8d7a6e8855be2d8d6fa4227c487c3.html">main</a></li><li class="navelem"><a class="el" href="dir_d2615d3423c50009d0fa2801d3e0150c.html">java</a></li><li class="navelem"><a class="el" href="dir_df2af9fb37a2f3aedd0dd3e7b116eedc.html">com</a></li><li class="navelem"><a class="el" href="dir_48ee7e70be44cce637301d7ac948c4e1.html">cloudera</a></li><li class="navelem"><a class="el" href="dir_c062777d65f1b5dc463ca31df638b83a.html">impala</a></li><li class="navelem"><a class="el" href="dir_a3fab68f30a0ffb6d333069c8ce7d28d.html">planner</a></li><li class="navelem"><a class="el" href="AnalyticPlanner_8java.html">AnalyticPlanner.java</a></li>
    <li class="footer">Generated on Thu May 7 2015 16:10:39 for Impala by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
