<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Impala: impala::ResourceBroker Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Impala
   </div>
   <div id="projectbrief">Impalaistheopensource,nativeanalyticdatabaseforApacheHadoop.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classimpala_1_1ResourceBroker.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classimpala_1_1ResourceBroker-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">impala::ResourceBroker Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for impala::ResourceBroker:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="classimpala_1_1ResourceBroker__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker_1_1AllocatedRequest.html">AllocatedRequest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker_1_1PendingRequest.html">PendingRequest</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a46b553aaf925f929fcf8330dd9c7025f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a46b553aaf925f929fcf8330dd9c7025f">ResourceBroker</a> (const std::vector&lt; TNetworkAddress &gt; &amp;llama_addresses, const TNetworkAddress &amp;llama_callback_address, <a class="el" href="classimpala_1_1MetricGroup.html">MetricGroup</a> *metrics)</td></tr>
<tr class="separator:a46b553aaf925f929fcf8330dd9c7025f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a539dbf49f28e8b4486218eb3b563182a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a539dbf49f28e8b4486218eb3b563182a">Init</a> ()</td></tr>
<tr class="separator:a539dbf49f28e8b4486218eb3b563182a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66f4fe163f978d811e96159a5666e080"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a66f4fe163f978d811e96159a5666e080">Close</a> ()</td></tr>
<tr class="memdesc:a66f4fe163f978d811e96159a5666e080"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes the llama_client_cache_ and joins the llama_callback_server_.  <a href="#a66f4fe163f978d811e96159a5666e080">More...</a><br/></td></tr>
<tr class="separator:a66f4fe163f978d811e96159a5666e080"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a661415ec36606ea6262b639c621c4cf8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a661415ec36606ea6262b639c621c4cf8">Reserve</a> (const TResourceBrokerReservationRequest &amp;request, TResourceBrokerReservationResponse *response)</td></tr>
<tr class="memdesc:a661415ec36606ea6262b639c621c4cf8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Requests resources from Llama. Blocks until the request has been granted or denied.  <a href="#a661415ec36606ea6262b639c621c4cf8">More...</a><br/></td></tr>
<tr class="separator:a661415ec36606ea6262b639c621c4cf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bdb13443a9e76bf23a2ff7635df179b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a4bdb13443a9e76bf23a2ff7635df179b">Expand</a> (const TResourceBrokerExpansionRequest &amp;request, TResourceBrokerExpansionResponse *response)</td></tr>
<tr class="separator:a4bdb13443a9e76bf23a2ff7635df179b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a5711b7000bc4574c632b078fa735c4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a3a5711b7000bc4574c632b078fa735c4">ClearRequests</a> (const TUniqueId &amp;reservation_id, <a class="el" href="classbool.html">bool</a> include_reservation)</td></tr>
<tr class="separator:a3a5711b7000bc4574c632b078fa735c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5a74c3cf3a91d95638220314c44731b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ac5a74c3cf3a91d95638220314c44731b">Release</a> (const TResourceBrokerReleaseRequest &amp;request, TResourceBrokerReleaseResponse *response)</td></tr>
<tr class="separator:ac5a74c3cf3a91d95638220314c44731b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f9d61bd7149aa826e16c471e0e8e299"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a1f9d61bd7149aa826e16c471e0e8e299">AMNotification</a> (const llama::TLlamaAMNotificationRequest &amp;request, llama::TLlamaAMNotificationResponse &amp;response)</td></tr>
<tr class="separator:a1f9d61bd7149aa826e16c471e0e8e299"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42346d67de3cda6f3ae50b0910c488d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ad42346d67de3cda6f3ae50b0910c488d">NMNotification</a> (const llama::TLlamaNMNotificationRequest &amp;request, llama::TLlamaNMNotificationResponse &amp;response)</td></tr>
<tr class="separator:ad42346d67de3cda6f3ae50b0910c488d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c0aefde39c980a0ac942508c6e4ac8"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; std::string &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a31c0aefde39c980a0ac942508c6e4ac8">llama_nodes</a> ()</td></tr>
<tr class="separator:a31c0aefde39c980a0ac942508c6e4ac8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a942a5a76e066d9574dd17092e3ba20fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a942a5a76e066d9574dd17092e3ba20fe">RefreshLlamaNodes</a> ()</td></tr>
<tr class="memdesc:a942a5a76e066d9574dd17092e3ba20fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieves the nodes known to Llama and stores them in llama_nodes_.  <a href="#a942a5a76e066d9574dd17092e3ba20fe">More...</a><br/></td></tr>
<tr class="separator:a942a5a76e066d9574dd17092e3ba20fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a9ba760d68b2bdc4c9afd68cdc567fc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a3a9ba760d68b2bdc4c9afd68cdc567fc">set_scheduler</a> (<a class="el" href="classimpala_1_1Scheduler.html">Scheduler</a> *scheduler)</td></tr>
<tr class="separator:a3a9ba760d68b2bdc4c9afd68cdc567fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bf00c31acee9869116e4113c1e40211"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a7bf00c31acee9869116e4113c1e40211">GetQueryResourceMgr</a> (const TUniqueId &amp;<a class="el" href="namespaceimpala.html#af9bbe2e7657f31e00eb4adbf126c2ce1">query_id</a>, const TUniqueId &amp;reservation_id, const TNetworkAddress &amp;local_resource_address, <a class="el" href="classimpala_1_1QueryResourceMgr.html">QueryResourceMgr</a> **res_mgr)</td></tr>
<tr class="separator:a7bf00c31acee9869116e4113c1e40211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40ab0a2508ebd057f9947b4a09bdb392"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a40ab0a2508ebd057f9947b4a09bdb392">UnregisterQueryResourceMgr</a> (const TUniqueId &amp;<a class="el" href="namespaceimpala.html#af9bbe2e7657f31e00eb4adbf126c2ce1">query_id</a>)</td></tr>
<tr class="separator:a40ab0a2508ebd057f9947b4a09bdb392"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae69e80760f5cbae5583e862162b99502"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ae69e80760f5cbae5583e862162b99502"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ae69e80760f5cbae5583e862162b99502">SendLlamaRpc</a> (<a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *llama_client, const llama::TLlamaAMGetNodesRequest &amp;request, llama::TLlamaAMGetNodesResponse *response)</td></tr>
<tr class="separator:ae69e80760f5cbae5583e862162b99502"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae53503b23012b4022eabe7128a11d674"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ae53503b23012b4022eabe7128a11d674"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ae53503b23012b4022eabe7128a11d674">SendLlamaRpc</a> (<a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *llama_client, const llama::TLlamaAMReservationRequest &amp;request, llama::TLlamaAMReservationResponse *response)</td></tr>
<tr class="separator:ae53503b23012b4022eabe7128a11d674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab557aeffffb0b758e5bea6949d965b2e"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:ab557aeffffb0b758e5bea6949d965b2e"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ab557aeffffb0b758e5bea6949d965b2e">SendLlamaRpc</a> (<a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *llama_client, const llama::TLlamaAMReservationExpansionRequest &amp;request, llama::TLlamaAMReservationExpansionResponse *response)</td></tr>
<tr class="separator:ab557aeffffb0b758e5bea6949d965b2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48cb59ad77a9a35fedca5acac5215ba2"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:a48cb59ad77a9a35fedca5acac5215ba2"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a48cb59ad77a9a35fedca5acac5215ba2">SendLlamaRpc</a> (<a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *llama_client, const llama::TLlamaAMReleaseRequest &amp;request, llama::TLlamaAMReleaseResponse *response)</td></tr>
<tr class="separator:a48cb59ad77a9a35fedca5acac5215ba2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25def71cd830f5d5f398ad7801237d50"><td class="memTemplParams" colspan="2">template&lt;&gt; </td></tr>
<tr class="memitem:a25def71cd830f5d5f398ad7801237d50"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a25def71cd830f5d5f398ad7801237d50">ReRegisterWithLlama</a> (const llama::TLlamaAMGetNodesRequest &amp;request, llama::TLlamaAMGetNodesResponse *response)</td></tr>
<tr class="separator:a25def71cd830f5d5f398ad7801237d50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:abac98ca868a97e61f640c14371bc3f46"><td class="memItemLeft" align="right" valign="top">typedef std::map<br class="typebreak"/>
&lt; TNetworkAddress, <br class="typebreak"/>
llama::TAllocatedResource &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#abac98ca868a97e61f640c14371bc3f46">ResourceMap</a></td></tr>
<tr class="separator:abac98ca868a97e61f640c14371bc3f46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7624a16056e33855586aade1c76ea09c"><td class="memItemLeft" align="right" valign="top">typedef boost::unordered_map<br class="typebreak"/>
&lt; llama::TUniqueId, <br class="typebreak"/>
<a class="el" href="classimpala_1_1ResourceBroker_1_1PendingRequest.html">PendingRequest</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a7624a16056e33855586aade1c76ea09c">PendingRequestMap</a></td></tr>
<tr class="separator:a7624a16056e33855586aade1c76ea09c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3c5f34e30f1dc3b3b9122a141aefaf5"><td class="memItemLeft" align="right" valign="top">typedef boost::unordered_map<br class="typebreak"/>
&lt; llama::TUniqueId, <br class="typebreak"/>
std::vector&lt; <a class="el" href="classimpala_1_1ResourceBroker_1_1AllocatedRequest.html">AllocatedRequest</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ae3c5f34e30f1dc3b3b9122a141aefaf5">AllocatedRequestMap</a></td></tr>
<tr class="separator:ae3c5f34e30f1dc3b3b9122a141aefaf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77799f9a86d4f1f6707333899a26bce3"><td class="memItemLeft" align="right" valign="top">typedef boost::unordered_map<br class="typebreak"/>
&lt; TUniqueId, std::pair<br class="typebreak"/>
&lt; int32_t, <a class="el" href="classimpala_1_1QueryResourceMgr.html">QueryResourceMgr</a> * &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a77799f9a86d4f1f6707333899a26bce3">QueryResourceMgrsMap</a></td></tr>
<tr class="separator:a77799f9a86d4f1f6707333899a26bce3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a57107e940e275ae73d6b63bbb540e798"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a57107e940e275ae73d6b63bbb540e798">has_standby_llama</a> ()</td></tr>
<tr class="separator:a57107e940e275ae73d6b63bbb540e798"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c717a7553f6a32e54ca88436d7714da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a5c717a7553f6a32e54ca88436d7714da">RegisterWithLlama</a> ()</td></tr>
<tr class="separator:a5c717a7553f6a32e54ca88436d7714da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5d66b9dffa456ee9d12338f7d1d0dc8"><td class="memTemplParams" colspan="2">template&lt;typename LlamaReqType , typename LlamaRespType &gt; </td></tr>
<tr class="memitem:ac5d66b9dffa456ee9d12338f7d1d0dc8"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ac5d66b9dffa456ee9d12338f7d1d0dc8">LlamaRpc</a> (LlamaReqType *request, LlamaRespType *response, <a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt; double &gt; *rpc_time_metric)</td></tr>
<tr class="separator:ac5d66b9dffa456ee9d12338f7d1d0dc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe30a78120647287056faa110820c25c"><td class="memTemplParams" colspan="2">template&lt;typename LlamaReqType , typename LlamaRespType &gt; </td></tr>
<tr class="memitem:afe30a78120647287056faa110820c25c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#afe30a78120647287056faa110820c25c">SendLlamaRpc</a> (<a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *llama_client, const LlamaReqType &amp;request, LlamaRespType *response)</td></tr>
<tr class="separator:afe30a78120647287056faa110820c25c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb60d4cc0e5c92c900861a4f4e8d693f"><td class="memTemplParams" colspan="2">template&lt;typename LlamaReqType , typename LlamaRespType &gt; </td></tr>
<tr class="memitem:abb60d4cc0e5c92c900861a4f4e8d693f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Status.html">Status</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#abb60d4cc0e5c92c900861a4f4e8d693f">ReRegisterWithLlama</a> (const LlamaReqType &amp;request, LlamaRespType *response)</td></tr>
<tr class="separator:abb60d4cc0e5c92c900861a4f4e8d693f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f1c6f71555234d64986e7ded200d82e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a8f1c6f71555234d64986e7ded200d82e">LlamaHasRestarted</a> (const llama::TStatus &amp;status) const </td></tr>
<tr class="memdesc:a8f1c6f71555234d64986e7ded200d82e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects Llama restarts from the given return status of a Llama RPC.  <a href="#a8f1c6f71555234d64986e7ded200d82e">More...</a><br/></td></tr>
<tr class="separator:a8f1c6f71555234d64986e7ded200d82e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3358a4b178295298637691fc47600849"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a3358a4b178295298637691fc47600849">CreateLlamaReservationRequest</a> (const TResourceBrokerReservationRequest &amp;src, llama::TLlamaAMReservationRequest &amp;dest)</td></tr>
<tr class="memdesc:a3358a4b178295298637691fc47600849"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a Llama reservation request from a resource broker reservation request.  <a href="#a3358a4b178295298637691fc47600849">More...</a><br/></td></tr>
<tr class="separator:a3358a4b178295298637691fc47600849"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c8832fe1facfe9030dfbfad057569bc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a3c8832fe1facfe9030dfbfad057569bc">CreateLlamaReleaseRequest</a> (const TResourceBrokerReleaseRequest &amp;src, llama::TLlamaAMReleaseRequest &amp;dest)</td></tr>
<tr class="memdesc:a3c8832fe1facfe9030dfbfad057569bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a Llama release request from a resource broker release request.  <a href="#a3c8832fe1facfe9030dfbfad057569bc">More...</a><br/></td></tr>
<tr class="separator:a3c8832fe1facfe9030dfbfad057569bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a695622288d18a987e71f5133e0667000"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classbool.html">bool</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a695622288d18a987e71f5133e0667000">WaitForNotification</a> (int64_t timeout, <a class="el" href="classimpala_1_1ResourceBroker.html#abac98ca868a97e61f640c14371bc3f46">ResourceMap</a> *resources, <a class="el" href="classbool.html">bool</a> *timed_out, <a class="el" href="classimpala_1_1ResourceBroker_1_1PendingRequest.html">PendingRequest</a> *reservation)</td></tr>
<tr class="separator:a695622288d18a987e71f5133e0667000"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afd757296aa096be7bb8d25cbde4c1285"><td class="memItemLeft" align="right" valign="top">std::vector&lt; TNetworkAddress &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#afd757296aa096be7bb8d25cbde4c1285">llama_addresses_</a></td></tr>
<tr class="memdesc:afd757296aa096be7bb8d25cbde4c1285"><td class="mdescLeft">&#160;</td><td class="mdescRight">Llama availability group.  <a href="#afd757296aa096be7bb8d25cbde4c1285">More...</a><br/></td></tr>
<tr class="separator:afd757296aa096be7bb8d25cbde4c1285"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7523e83c46ffa8c93c3dd10321b5c8fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a7523e83c46ffa8c93c3dd10321b5c8fd">active_llama_addr_idx_</a></td></tr>
<tr class="separator:a7523e83c46ffa8c93c3dd10321b5c8fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae44644eae8cb901d2fc02fd98dd0d122"><td class="memItemLeft" align="right" valign="top">TNetworkAddress&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ae44644eae8cb901d2fc02fd98dd0d122">llama_callback_address_</a></td></tr>
<tr class="separator:ae44644eae8cb901d2fc02fd98dd0d122"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae32e2e6a125d739fa15e77d4f6de28dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1MetricGroup.html">MetricGroup</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ae32e2e6a125d739fa15e77d4f6de28dc">metrics_</a></td></tr>
<tr class="separator:ae32e2e6a125d739fa15e77d4f6de28dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c6255918c3dffed5506a456b3e4fa2d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1Scheduler.html">Scheduler</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a4c6255918c3dffed5506a456b3e4fa2d">scheduler_</a></td></tr>
<tr class="separator:a4c6255918c3dffed5506a456b3e4fa2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0730bf0f19ea7dad5562d9aeced4df99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#afcf5d0484c3833cf0f4f6c681412e398">StringProperty</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a0730bf0f19ea7dad5562d9aeced4df99">active_llama_metric_</a></td></tr>
<tr class="separator:a0730bf0f19ea7dad5562d9aeced4df99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34da4ee1e1c67d4aefa45ed15c69070b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#afcf5d0484c3833cf0f4f6c681412e398">StringProperty</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a34da4ee1e1c67d4aefa45ed15c69070b">active_llama_handle_metric_</a></td></tr>
<tr class="separator:a34da4ee1e1c67d4aefa45ed15c69070b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a081d1c45c55ade7bde75ce7265b4b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a3a081d1c45c55ade7bde75ce7265b4b5">reservation_rpc_time_metric_</a></td></tr>
<tr class="separator:a3a081d1c45c55ade7bde75ce7265b4b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b38c4368e876904a6a7f7f643581cd3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a0b38c4368e876904a6a7f7f643581cd3">reservation_response_time_metric_</a></td></tr>
<tr class="separator:a0b38c4368e876904a6a7f7f643581cd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a7778b4a46ce7245eea75005ec14e45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a8a7778b4a46ce7245eea75005ec14e45">reservation_requests_total_metric_</a></td></tr>
<tr class="memdesc:a8a7778b4a46ce7245eea75005ec14e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of reservation requests.  <a href="#a8a7778b4a46ce7245eea75005ec14e45">More...</a><br/></td></tr>
<tr class="separator:a8a7778b4a46ce7245eea75005ec14e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0804621474d2150b65a1f6eb4c384646"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a0804621474d2150b65a1f6eb4c384646">reservation_requests_fulfilled_metric_</a></td></tr>
<tr class="memdesc:a0804621474d2150b65a1f6eb4c384646"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of fulfilled reservation requests.  <a href="#a0804621474d2150b65a1f6eb4c384646">More...</a><br/></td></tr>
<tr class="separator:a0804621474d2150b65a1f6eb4c384646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b81e77222ad7df3485db8551084d68f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a7b81e77222ad7df3485db8551084d68f">reservation_requests_failed_metric_</a></td></tr>
<tr class="separator:a7b81e77222ad7df3485db8551084d68f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79587bbb49612d9644328b1d1702b100"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a79587bbb49612d9644328b1d1702b100">reservation_requests_rejected_metric_</a></td></tr>
<tr class="memdesc:a79587bbb49612d9644328b1d1702b100"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of well-formed reservation requests rejected by the central scheduler.  <a href="#a79587bbb49612d9644328b1d1702b100">More...</a><br/></td></tr>
<tr class="separator:a79587bbb49612d9644328b1d1702b100"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78b20e64f265f83204185e15ab04de50"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a78b20e64f265f83204185e15ab04de50">reservation_requests_timedout_metric_</a></td></tr>
<tr class="separator:a78b20e64f265f83204185e15ab04de50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76cb0d1826b49793b67a6c69bff1db06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a76cb0d1826b49793b67a6c69bff1db06">expansion_rpc_time_metric_</a></td></tr>
<tr class="separator:a76cb0d1826b49793b67a6c69bff1db06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f7fe372f509bbef0ffe9e84d58ebcd7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt; double &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a2f7fe372f509bbef0ffe9e84d58ebcd7">expansion_response_time_metric_</a></td></tr>
<tr class="separator:a2f7fe372f509bbef0ffe9e84d58ebcd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a630ee49a24793bbed51db52d5f7e068d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a630ee49a24793bbed51db52d5f7e068d">expansion_requests_total_metric_</a></td></tr>
<tr class="memdesc:a630ee49a24793bbed51db52d5f7e068d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of expansion requests.  <a href="#a630ee49a24793bbed51db52d5f7e068d">More...</a><br/></td></tr>
<tr class="separator:a630ee49a24793bbed51db52d5f7e068d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ddb1066c623744d72ff3739aff9f5b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a55ddb1066c623744d72ff3739aff9f5b">expansion_requests_fulfilled_metric_</a></td></tr>
<tr class="memdesc:a55ddb1066c623744d72ff3739aff9f5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of fulfilled expansion requests.  <a href="#a55ddb1066c623744d72ff3739aff9f5b">More...</a><br/></td></tr>
<tr class="separator:a55ddb1066c623744d72ff3739aff9f5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2d9429dd657d9c1e68a52a0a98367e5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ab2d9429dd657d9c1e68a52a0a98367e5">expansion_requests_failed_metric_</a></td></tr>
<tr class="separator:ab2d9429dd657d9c1e68a52a0a98367e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d91d40a9070e10f54c2610c34f924c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ac9d91d40a9070e10f54c2610c34f924c">expansion_requests_rejected_metric_</a></td></tr>
<tr class="memdesc:ac9d91d40a9070e10f54c2610c34f924c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of well-formed expansion requests rejected by the central scheduler.  <a href="#ac9d91d40a9070e10f54c2610c34f924c">More...</a><br/></td></tr>
<tr class="separator:ac9d91d40a9070e10f54c2610c34f924c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c3d22bd10d3daa33bd289adde7782cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a7c3d22bd10d3daa33bd289adde7782cb">expansion_requests_timedout_metric_</a></td></tr>
<tr class="separator:a7c3d22bd10d3daa33bd289adde7782cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf702f177d0b6f11c31d0e9e0d2db56c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#a0ac05a476d08e3a556ef87c24d693af1">UIntGauge</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#acf702f177d0b6f11c31d0e9e0d2db56c">allocated_memory_metric_</a></td></tr>
<tr class="memdesc:acf702f177d0b6f11c31d0e9e0d2db56c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total amount of memory currently allocated by Llama to this node.  <a href="#acf702f177d0b6f11c31d0e9e0d2db56c">More...</a><br/></td></tr>
<tr class="separator:acf702f177d0b6f11c31d0e9e0d2db56c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0ebd2724e61ae0bcf539ad8cf56cf38"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#a0ac05a476d08e3a556ef87c24d693af1">UIntGauge</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ac0ebd2724e61ae0bcf539ad8cf56cf38">allocated_vcpus_metric_</a></td></tr>
<tr class="memdesc:ac0ebd2724e61ae0bcf539ad8cf56cf38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of vcpu cores currently allocated by Llama to this node.  <a href="#ac0ebd2724e61ae0bcf539ad8cf56cf38">More...</a><br/></td></tr>
<tr class="separator:ac0ebd2724e61ae0bcf539ad8cf56cf38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c442b1a7d0a88686d57853b889e8b41"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a0c442b1a7d0a88686d57853b889e8b41">requests_released_metric_</a></td></tr>
<tr class="memdesc:a0c442b1a7d0a88686d57853b889e8b41"><td class="mdescLeft">&#160;</td><td class="mdescRight">Total number of fulfilled reservation requests that have been released.  <a href="#a0c442b1a7d0a88686d57853b889e8b41">More...</a><br/></td></tr>
<tr class="separator:a0c442b1a7d0a88686d57853b889e8b41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7335ca4cb78dd0c94262683bbb11289"><td class="memItemLeft" align="right" valign="top">boost::uuids::uuid&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ac7335ca4cb78dd0c94262683bbb11289">llama_client_id_</a></td></tr>
<tr class="separator:ac7335ca4cb78dd0c94262683bbb11289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83bcc5d2873069e6fadd8d912b5f01a2"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr<br class="typebreak"/>
&lt; llama::LlamaNotificationServiceIf &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a83bcc5d2873069e6fadd8d912b5f01a2">llama_callback_thrift_iface_</a></td></tr>
<tr class="memdesc:a83bcc5d2873069e6fadd8d912b5f01a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thrift API implementation which proxies Llama notifications onto this <a class="el" href="classimpala_1_1ResourceBroker.html">ResourceBroker</a>.  <a href="#a83bcc5d2873069e6fadd8d912b5f01a2">More...</a><br/></td></tr>
<tr class="separator:a83bcc5d2873069e6fadd8d912b5f01a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d40782a608cd464a09320ba19cbbb5"><td class="memItemLeft" align="right" valign="top">boost::scoped_ptr&lt; <a class="el" href="classimpala_1_1ThriftServer.html">ThriftServer</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a97d40782a608cd464a09320ba19cbbb5">llama_callback_server_</a></td></tr>
<tr class="separator:a97d40782a608cd464a09320ba19cbbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af39436bc450fae778143525af4b376ea"><td class="memItemLeft" align="right" valign="top">boost::scoped_ptr&lt; <a class="el" href="classimpala_1_1ClientCache.html">ClientCache</a><br class="typebreak"/>
&lt; llama::LlamaAMServiceClient &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#af39436bc450fae778143525af4b376ea">llama_client_cache_</a></td></tr>
<tr class="memdesc:af39436bc450fae778143525af4b376ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cache of Llama client connections.  <a href="#af39436bc450fae778143525af4b376ea">More...</a><br/></td></tr>
<tr class="separator:af39436bc450fae778143525af4b376ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adae716281df80e64f0ee222b9784f264"><td class="memItemLeft" align="right" valign="top">boost::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#adae716281df80e64f0ee222b9784f264">llama_registration_lock_</a></td></tr>
<tr class="separator:adae716281df80e64f0ee222b9784f264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7fd6192aba5ae524c723d32343804a6"><td class="memItemLeft" align="right" valign="top">llama::TUniqueId&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#ae7fd6192aba5ae524c723d32343804a6">llama_handle_</a></td></tr>
<tr class="memdesc:ae7fd6192aba5ae524c723d32343804a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle received from Llama during registration. Set in <a class="el" href="classimpala_1_1ResourceBroker.html#a5c717a7553f6a32e54ca88436d7714da">RegisterWithLlama()</a>.  <a href="#ae7fd6192aba5ae524c723d32343804a6">More...</a><br/></td></tr>
<tr class="separator:ae7fd6192aba5ae524c723d32343804a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a617f4592442383de35f23e94ce6dfb31"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a617f4592442383de35f23e94ce6dfb31">llama_nodes_</a></td></tr>
<tr class="memdesc:a617f4592442383de35f23e94ce6dfb31"><td class="mdescLeft">&#160;</td><td class="mdescRight">List of nodes registered with Llama. Set in <a class="el" href="classimpala_1_1ResourceBroker.html#a942a5a76e066d9574dd17092e3ba20fe" title="Retrieves the nodes known to Llama and stores them in llama_nodes_. ">RefreshLlamaNodes()</a>.  <a href="#a617f4592442383de35f23e94ce6dfb31">More...</a><br/></td></tr>
<tr class="separator:a617f4592442383de35f23e94ce6dfb31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a452e18532a741a10dfa64e6ac58bc729"><td class="memItemLeft" align="right" valign="top">boost::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a452e18532a741a10dfa64e6ac58bc729">pending_requests_lock_</a></td></tr>
<tr class="memdesc:a452e18532a741a10dfa64e6ac58bc729"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protects pending_requests_.  <a href="#a452e18532a741a10dfa64e6ac58bc729">More...</a><br/></td></tr>
<tr class="separator:a452e18532a741a10dfa64e6ac58bc729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02511adc8b156edb160533527edcce9e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ResourceBroker.html#a7624a16056e33855586aade1c76ea09c">PendingRequestMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a02511adc8b156edb160533527edcce9e">pending_requests_</a></td></tr>
<tr class="separator:a02511adc8b156edb160533527edcce9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a701360ab5e21dac4ce7ea968013abadf"><td class="memItemLeft" align="right" valign="top">boost::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a701360ab5e21dac4ce7ea968013abadf">allocated_requests_lock_</a></td></tr>
<tr class="memdesc:a701360ab5e21dac4ce7ea968013abadf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protectes allocated_requests_.  <a href="#a701360ab5e21dac4ce7ea968013abadf">More...</a><br/></td></tr>
<tr class="separator:a701360ab5e21dac4ce7ea968013abadf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99f92bb4485bacda3270216f480fbab7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ResourceBroker.html#ae3c5f34e30f1dc3b3b9122a141aefaf5">AllocatedRequestMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a99f92bb4485bacda3270216f480fbab7">allocated_requests_</a></td></tr>
<tr class="separator:a99f92bb4485bacda3270216f480fbab7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26aed4ffd908fd4882c4ded3d29eac44"><td class="memItemLeft" align="right" valign="top">boost::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#a26aed4ffd908fd4882c4ded3d29eac44">query_resource_mgrs_lock_</a></td></tr>
<tr class="memdesc:a26aed4ffd908fd4882c4ded3d29eac44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protects query_resource_mgrs_.  <a href="#a26aed4ffd908fd4882c4ded3d29eac44">More...</a><br/></td></tr>
<tr class="separator:a26aed4ffd908fd4882c4ded3d29eac44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae54d739345788e7d4929828d3f593f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classimpala_1_1ResourceBroker.html#a77799f9a86d4f1f6707333899a26bce3">QueryResourceMgrsMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classimpala_1_1ResourceBroker.html#aae54d739345788e7d4929828d3f593f5">query_resource_mgrs_</a></td></tr>
<tr class="separator:aae54d739345788e7d4929828d3f593f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Mediates resource-reservation requests between Impala and Yarn via the Llama service. The resource broker requests resources via the Llama's thrift interface and exposes a thrift server for the Llama to notify it of granted/denied/preempted resource reservations. The reserve/release API of the resource broker is blocking. The resource broker is configured with a list of Llama addresses that are cycled through for failover. TODO: Implement NM notification service. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00044">44</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a class="anchor" id="ae3c5f34e30f1dc3b3b9122a141aefaf5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef boost::unordered_map&lt;llama::TUniqueId, std::vector&lt;<a class="el" href="classimpala_1_1ResourceBroker_1_1AllocatedRequest.html">AllocatedRequest</a>&gt; &gt; <a class="el" href="classimpala_1_1ResourceBroker.html#ae3c5f34e30f1dc3b3b9122a141aefaf5">impala::ResourceBroker::AllocatedRequestMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map from reservation ID to all satisfied requests - reservation and expansion - associated with that reservation. Used only for bookkeeping so that Impala can report on the current resource usage. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00377">377</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

</div>
</div>
<a class="anchor" id="a7624a16056e33855586aade1c76ea09c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef boost::unordered_map&lt;llama::TUniqueId, <a class="el" href="classimpala_1_1ResourceBroker_1_1PendingRequest.html">PendingRequest</a>*&gt; <a class="el" href="classimpala_1_1ResourceBroker.html#a7624a16056e33855586aade1c76ea09c">impala::ResourceBroker::PendingRequestMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map from unique request ID provided to Llama (for both reservation and expansion requests) to <a class="el" href="classimpala_1_1ResourceBroker_1_1PendingRequest.html">PendingRequest</a> object used to coordinate when a response is received from Llama. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00339">339</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

</div>
</div>
<a class="anchor" id="a77799f9a86d4f1f6707333899a26bce3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef boost::unordered_map&lt;TUniqueId, std::pair&lt;int32_t, <a class="el" href="classimpala_1_1QueryResourceMgr.html">QueryResourceMgr</a>*&gt; &gt; <a class="el" href="classimpala_1_1ResourceBroker.html#a77799f9a86d4f1f6707333899a26bce3">impala::ResourceBroker::QueryResourceMgrsMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00383">383</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

</div>
</div>
<a class="anchor" id="abac98ca868a97e61f640c14371bc3f46"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;TNetworkAddress, llama::TAllocatedResource&gt; <a class="el" href="classimpala_1_1ResourceBroker.html#abac98ca868a97e61f640c14371bc3f46">impala::ResourceBroker::ResourceMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00111">111</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a46b553aaf925f929fcf8330dd9c7025f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">impala::ResourceBroker::ResourceBroker </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; TNetworkAddress &gt; &amp;&#160;</td>
          <td class="paramname"><em>llama_addresses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TNetworkAddress &amp;&#160;</td>
          <td class="paramname"><em>llama_callback_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1MetricGroup.html">MetricGroup</a> *&#160;</td>
          <td class="paramname"><em>metrics</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00089">89</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00184">active_llama_handle_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00180">active_llama_metric_</a>, <a class="el" href="metrics_8h_source.html#l00239">impala::MetricGroup::AddCounter()</a>, <a class="el" href="metrics_8h_source.html#l00223">impala::MetricGroup::AddGauge()</a>, <a class="el" href="metrics_8h_source.html#l00231">impala::MetricGroup::AddProperty()</a>, <a class="el" href="resource-broker_8h_source.html#l00241">allocated_memory_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00244">allocated_vcpus_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00231">expansion_requests_failed_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00227">expansion_requests_fulfilled_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00234">expansion_requests_rejected_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00238">expansion_requests_timedout_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00224">expansion_requests_total_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00221">expansion_response_time_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00215">expansion_rpc_time_metric_</a>, <a class="el" href="metrics_8h_source.html#l00211">impala::MetricGroup::RegisterMetric()</a>, <a class="el" href="resource-broker_8h_source.html#l00247">requests_released_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00204">reservation_requests_failed_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00200">reservation_requests_fulfilled_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00207">reservation_requests_rejected_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00211">reservation_requests_timedout_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00197">reservation_requests_total_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00194">reservation_response_time_metric_</a>, and <a class="el" href="resource-broker_8h_source.html#l00188">reservation_rpc_time_metric_</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a1f9d61bd7149aa826e16c471e0e8e299"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::AMNotification </td>
          <td>(</td>
          <td class="paramtype">const llama::TLlamaAMNotificationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMNotificationResponse &amp;&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handles asynchronous Llama Application Master (AM) notifications including granted/denied/preempted reservations and resources. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00691">691</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="classimpala_1_1Scheduler.html#aefd4dc897813e36fafe31dbcd8e1cd00">impala::Scheduler::HandlePreemptedReservation()</a>, <a class="el" href="classimpala_1_1Scheduler.html#a1806571a367d4bac0c302aeb12d98e64">impala::Scheduler::HandlePreemptedResource()</a>, <a class="el" href="resource-broker_8h_source.html#l00269">llama_handle_</a>, <a class="el" href="resource-broker_8h_source.html#l00266">llama_registration_lock_</a>, <a class="el" href="webserver_8cc_source.html#l00115">impala::OK</a>, <a class="el" href="resource-broker_8h_source.html#l00340">pending_requests_</a>, <a class="el" href="resource-broker_8h_source.html#l00334">pending_requests_lock_</a>, <a class="el" href="resource-broker_8h_source.html#l00176">scheduler_</a>, <a class="el" href="logging_8h_source.html#l00057">VLOG_QUERY</a>, and <a class="el" href="logging_8h_source.html#l00056">VLOG_RPC</a>.</p>

</div>
</div>
<a class="anchor" id="a3a5711b7000bc4574c632b078fa735c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::ClearRequests </td>
          <td>(</td>
          <td class="paramtype">const TUniqueId &amp;&#160;</td>
          <td class="paramname"><em>reservation_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>include_reservation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes the record of all resource requests associated with this reservationID (except the reservation request itself, if include_reservation is false) so that the per-node accounting is correct when plan fragments finish. Does not communicate this to Llama (i.e. only updates the local node's accounting), so the coordinator should always call <a class="el" href="classimpala_1_1ResourceBroker.html#ac5a74c3cf3a91d95638220314c44731b">Release()</a> to make sure that Llama knows the resources have gone. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00636">636</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00241">allocated_memory_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00378">allocated_requests_</a>, <a class="el" href="resource-broker_8h_source.html#l00371">allocated_requests_lock_</a>, <a class="el" href="resource-broker_8h_source.html#l00244">allocated_vcpus_metric_</a>, <a class="el" href="pretty-printer_8h_source.html#l00033">impala::PrettyPrinter::Print()</a>, and <a class="el" href="logging_8h_source.html#l00057">VLOG_QUERY</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00666">Release()</a>, and <a class="el" href="query-resource-mgr_8cc_source.html#l00234">impala::QueryResourceMgr::Shutdown()</a>.</p>

</div>
</div>
<a class="anchor" id="a66f4fe163f978d811e96159a5666e080"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::Close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes the llama_client_cache_ and joins the llama_callback_server_. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00302">302</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00164">llama_addresses_</a>, <a class="el" href="resource-broker_8h_source.html#l00259">llama_callback_server_</a>, and <a class="el" href="resource-broker_8h_source.html#l00262">llama_client_cache_</a>.</p>

</div>
</div>
<a class="anchor" id="a3c8832fe1facfe9030dfbfad057569bc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::CreateLlamaReleaseRequest </td>
          <td>(</td>
          <td class="paramtype">const TResourceBrokerReleaseRequest &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMReleaseRequest &amp;&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a Llama release request from a resource broker release request. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00328">328</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00269">llama_handle_</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00666">Release()</a>.</p>

</div>
</div>
<a class="anchor" id="a3358a4b178295298637691fc47600849"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::CreateLlamaReservationRequest </td>
          <td>(</td>
          <td class="paramtype">const TResourceBrokerReservationRequest &amp;&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMReservationRequest &amp;&#160;</td>
          <td class="paramname"><em>dest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a Llama reservation request from a resource broker reservation request. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00310">310</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00269">llama_handle_</a>, and <a class="el" href="uid-util_8h_source.html#l00038">impala::UUIDToTUniqueId()</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>.</p>

</div>
</div>
<a class="anchor" id="a4bdb13443a9e76bf23a2ff7635df179b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::Expand </td>
          <td>(</td>
          <td class="paramtype">const TResourceBrokerExpansionRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TResourceBrokerExpansionResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Requests more resources from Llama for an existing reservation. Blocks until the request has been granted or denied. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00503">503</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="stopwatch_8h_source.html#l00105">impala::MonotonicStopWatch::ElapsedTime()</a>, <a class="el" href="resource-broker_8h_source.html#l00231">expansion_requests_failed_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00227">expansion_requests_fulfilled_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00234">expansion_requests_rejected_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00238">expansion_requests_timedout_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00221">expansion_response_time_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00215">expansion_rpc_time_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00269">llama_handle_</a>, <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, <a class="el" href="llama-util_8cc_source.html#l00127">llama::LlamaStatusToImpalaStatus()</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="resource-broker_8h_source.html#l00340">pending_requests_</a>, <a class="el" href="resource-broker_8h_source.html#l00334">pending_requests_lock_</a>, <a class="el" href="pretty-printer_8h_source.html#l00033">impala::PrettyPrinter::Print()</a>, <a class="el" href="resource-broker_8h_source.html#l00307">impala::ResourceBroker::PendingRequest::request_id()</a>, <a class="el" href="stopwatch_8h_source.html#l00081">impala::MonotonicStopWatch::Start()</a>, <a class="el" href="collection-metrics_8h_source.html#l00112">impala::StatsMetric&lt; T &gt;::Update()</a>, <a class="el" href="uid-util_8h_source.html#l00038">impala::UUIDToTUniqueId()</a>, <a class="el" href="logging_8h_source.html#l00057">VLOG_QUERY</a>, <a class="el" href="logging_8h_source.html#l00056">VLOG_RPC</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

<p>Referenced by <a class="el" href="query-resource-mgr_8cc_source.html#l00162">impala::QueryResourceMgr::AcquireVcoreResources()</a>, and <a class="el" href="mem-tracker_8cc_source.html#l00294">impala::MemTracker::ExpandRmReservation()</a>.</p>

</div>
</div>
<a class="anchor" id="a7bf00c31acee9869116e4113c1e40211"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> impala::ResourceBroker::GetQueryResourceMgr </td>
          <td>(</td>
          <td class="paramtype">const TUniqueId &amp;&#160;</td>
          <td class="paramname"><em>query_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TUniqueId &amp;&#160;</td>
          <td class="paramname"><em>reservation_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TNetworkAddress &amp;&#160;</td>
          <td class="paramname"><em>local_resource_address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1QueryResourceMgr.html">QueryResourceMgr</a> **&#160;</td>
          <td class="paramname"><em>res_mgr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieves or creates a new <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a> for the given query ID. Returns true if this is the first 'checkout' of this <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a>, false otherwise. The other parameters are passed to the <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a> constructor. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00779">779</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="coordinator_8h_source.html#l00152">impala::query_id()</a>, <a class="el" href="resource-broker_8h_source.html#l00388">query_resource_mgrs_</a>, and <a class="el" href="resource-broker_8h_source.html#l00381">query_resource_mgrs_lock_</a>.</p>

<p>Referenced by <a class="el" href="plan-fragment-executor_8cc_source.html#l00080">impala::PlanFragmentExecutor::Prepare()</a>.</p>

</div>
</div>
<a class="anchor" id="a57107e940e275ae73d6b63bbb540e798"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> impala::ResourceBroker::has_standby_llama </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00113">113</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00164">llama_addresses_</a>.</p>

</div>
</div>
<a class="anchor" id="a539dbf49f28e8b4486218eb3b563182a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Register this resource broker with LLama and starts the Llama callback service. Returns a non-OK status if the callback service failed to start (e.g., port in use) or if registration with the Llama failed (e.g., connection to Llama failed). </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00182">182</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00164">llama_addresses_</a>, <a class="el" href="resource-broker_8h_source.html#l00172">llama_callback_address_</a>, <a class="el" href="resource-broker_8h_source.html#l00259">llama_callback_server_</a>, <a class="el" href="resource-broker_8h_source.html#l00258">llama_callback_thrift_iface_</a>, <a class="el" href="resource-broker_8h_source.html#l00255">llama_client_id_</a>, <a class="el" href="resource-broker_8h_source.html#l00174">metrics_</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="resource-broker_8cc_source.html#l00766">RefreshLlamaNodes()</a>, <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>, <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>, and <a class="el" href="resource-broker_8h_source.html#l00176">scheduler_</a>.</p>

</div>
</div>
<a class="anchor" id="a31c0aefde39c980a0ac942508c6e4ac8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;std::string&gt;&amp; impala::ResourceBroker::llama_nodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00091">91</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00272">llama_nodes_</a>.</p>

<p>Referenced by <a class="el" href="query-resource-mgr_8cc_source.html#l00059">impala::ResourceResolver::CreateLocalLlamaNodeMapping()</a>.</p>

</div>
</div>
<a class="anchor" id="a8f1c6f71555234d64986e7ded200d82e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> impala::ResourceBroker::LlamaHasRestarted </td>
          <td>(</td>
          <td class="paramtype">const llama::TStatus &amp;&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Detects Llama restarts from the given return status of a Llama RPC. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00286">286</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8cc_source.html#l00065">impala::LLAMA_RESTART_SEARCH_STRING</a>, and <a class="el" href="webserver_8cc_source.html#l00115">impala::OK</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>.</p>

</div>
</div>
<a class="anchor" id="ac5d66b9dffa456ee9d12338f7d1d0dc8"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LlamaReqType , typename LlamaRespType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::LlamaRpc </td>
          <td>(</td>
          <td class="paramtype">LlamaReqType *&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LlamaRespType *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt; double &gt; *&#160;</td>
          <td class="paramname"><em>rpc_time_metric</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Issues the Llama RPC corresponding to the LlamaReqType and LlamaRespType. This function encapsulates the complex connect/rpc/retry logic for all Llama RPCs except Register(). If rpc_time_metric is non-NULL, the metric is updated upon success of the RPC. Returns a non-OK status if the RPC failed due to connectivity issues with the Llama. Returns OK if the RPC succeeded. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00336">336</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00168">active_llama_addr_idx_</a>, <a class="el" href="stopwatch_8h_source.html#l00105">impala::MonotonicStopWatch::ElapsedTime()</a>, <a class="el" href="resource-broker_8h_source.html#l00164">llama_addresses_</a>, <a class="el" href="resource-broker_8h_source.html#l00262">llama_client_cache_</a>, <a class="el" href="resource-broker_8h_source.html#l00269">llama_handle_</a>, <a class="el" href="resource-broker_8cc_source.html#l00286">LlamaHasRestarted()</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="resource-broker_8cc_source.html#l00438">ReRegisterWithLlama()</a>, <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>, <a class="el" href="resource-broker_8cc_source.html#l00391">SendLlamaRpc()</a>, <a class="el" href="stopwatch_8h_source.html#l00081">impala::MonotonicStopWatch::Start()</a>, <a class="el" href="collection-metrics_8h_source.html#l00112">impala::StatsMetric&lt; T &gt;::Update()</a>, and <a class="el" href="logging_8h_source.html#l00056">VLOG_RPC</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, <a class="el" href="resource-broker_8cc_source.html#l00766">RefreshLlamaNodes()</a>, <a class="el" href="resource-broker_8cc_source.html#l00666">Release()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>.</p>

</div>
</div>
<a class="anchor" id="ad42346d67de3cda6f3ae50b0910c488d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::NMNotification </td>
          <td>(</td>
          <td class="paramtype">const llama::TLlamaNMNotificationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaNMNotificationResponse &amp;&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Handles asynchronous notifications from the Llama Node Manager (NM) auxiliary service, in particular, incoming Yarn container allocations that are going to claim resources. TODO: Implement once NM service is fully functional. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00762">762</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a942a5a76e066d9574dd17092e3ba20fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::RefreshLlamaNodes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Retrieves the nodes known to Llama and stores them in llama_nodes_. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00766">766</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00269">llama_handle_</a>, <a class="el" href="resource-broker_8h_source.html#l00272">llama_nodes_</a>, <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, <a class="el" href="llama-util_8cc_source.html#l00127">llama::LlamaStatusToImpalaStatus()</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, and <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00438">ReRegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="a5c717a7553f6a32e54ca88436d7714da"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::RegisterWithLlama </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Registers this resource broker with the Llama. Cycles through the list of Llama addresses to find the active Llama which is accepting requests (if any). Returns a non-OK status if registration with any of the Llama's did not succeed within FLAGS_llama_registration_timeout_s seconds. Registration with the Llama is idempotent with respect to the llama_client_id_ (see comment on llama_client_id_ for details). </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00204">204</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00168">active_llama_addr_idx_</a>, <a class="el" href="resource-broker_8h_source.html#l00184">active_llama_handle_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00180">active_llama_metric_</a>, <a class="el" href="status_8cc_source.html#l00184">impala::Status::GetDetail()</a>, <a class="el" href="resource-broker_8h_source.html#l00164">llama_addresses_</a>, <a class="el" href="resource-broker_8h_source.html#l00172">llama_callback_address_</a>, <a class="el" href="resource-broker_8h_source.html#l00262">llama_client_cache_</a>, <a class="el" href="resource-broker_8h_source.html#l00255">llama_client_id_</a>, <a class="el" href="resource-broker_8h_source.html#l00269">llama_handle_</a>, <a class="el" href="resource-broker_8h_source.html#l00266">llama_registration_lock_</a>, <a class="el" href="llama-util_8cc_source.html#l00127">llama::LlamaStatusToImpalaStatus()</a>, <a class="el" href="time_8h_source.html#l00041">impala::MonotonicSeconds()</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>, <a class="el" href="time_8cc_source.html#l00021">impala::SleepForMs()</a>, and <a class="el" href="uid-util_8h_source.html#l00038">impala::UUIDToTUniqueId()</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00438">ReRegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="ac5a74c3cf3a91d95638220314c44731b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::Release </td>
          <td>(</td>
          <td class="paramtype">const TResourceBrokerReleaseRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TResourceBrokerReleaseResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Releases resources acquired from Llama for this reservation and all associated expansion requests across <em>all</em> nodes. Should therefore only be called once per query. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00666">666</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00378">allocated_requests_</a>, <a class="el" href="resource-broker_8h_source.html#l00371">allocated_requests_lock_</a>, <a class="el" href="resource-broker_8cc_source.html#l00636">ClearRequests()</a>, <a class="el" href="resource-broker_8cc_source.html#l00328">CreateLlamaReleaseRequest()</a>, <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, <a class="el" href="llama-util_8cc_source.html#l00127">llama::LlamaStatusToImpalaStatus()</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="resource-broker_8h_source.html#l00247">requests_released_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00188">reservation_rpc_time_metric_</a>, <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>, and <a class="el" href="logging_8h_source.html#l00057">VLOG_QUERY</a>.</p>

</div>
</div>
<a class="anchor" id="abb60d4cc0e5c92c900861a4f4e8d693f"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LlamaReqType , typename LlamaRespType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::ReRegisterWithLlama </td>
          <td>(</td>
          <td class="paramtype">const LlamaReqType &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LlamaRespType *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Re-registers with Llama to recover from the Llama being unreachable. Handles both Llama restart and failover. This function is a template to allow specialization on the Llama request/response type. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00438">438</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8cc_source.html#l00766">RefreshLlamaNodes()</a>, <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>, and <a class="el" href="status_8h_source.html#l00242">RETURN_IF_ERROR</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>.</p>

</div>
</div>
<a class="anchor" id="a25def71cd830f5d5f398ad7801237d50"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::ReRegisterWithLlama </td>
          <td>(</td>
          <td class="paramtype">const llama::TLlamaAMGetNodesRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMGetNodesResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00445">445</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="a661415ec36606ea6262b639c621c4cf8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Status.html">Status</a> impala::ResourceBroker::Reserve </td>
          <td>(</td>
          <td class="paramtype">const TResourceBrokerReservationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TResourceBrokerReservationResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Requests resources from Llama. Blocks until the request has been granted or denied. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00569">569</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8cc_source.html#l00310">CreateLlamaReservationRequest()</a>, <a class="el" href="stopwatch_8h_source.html#l00105">impala::MonotonicStopWatch::ElapsedTime()</a>, <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, <a class="el" href="llama-util_8cc_source.html#l00127">llama::LlamaStatusToImpalaStatus()</a>, <a class="el" href="status_8h_source.html#l00087">impala::Status::OK</a>, <a class="el" href="status_8h_source.html#l00172">impala::Status::ok()</a>, <a class="el" href="resource-broker_8h_source.html#l00340">pending_requests_</a>, <a class="el" href="resource-broker_8h_source.html#l00334">pending_requests_lock_</a>, <a class="el" href="pretty-printer_8h_source.html#l00033">impala::PrettyPrinter::Print()</a>, <a class="el" href="resource-broker_8h_source.html#l00307">impala::ResourceBroker::PendingRequest::request_id()</a>, <a class="el" href="resource-broker_8h_source.html#l00308">impala::ResourceBroker::PendingRequest::reservation_id()</a>, <a class="el" href="resource-broker_8h_source.html#l00204">reservation_requests_failed_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00200">reservation_requests_fulfilled_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00207">reservation_requests_rejected_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00211">reservation_requests_timedout_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00197">reservation_requests_total_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00194">reservation_response_time_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00188">reservation_rpc_time_metric_</a>, <a class="el" href="stopwatch_8h_source.html#l00081">impala::MonotonicStopWatch::Start()</a>, <a class="el" href="collection-metrics_8h_source.html#l00112">impala::StatsMetric&lt; T &gt;::Update()</a>, <a class="el" href="logging_8h_source.html#l00057">VLOG_QUERY</a>, <a class="el" href="logging_8h_source.html#l00056">VLOG_RPC</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="afe30a78120647287056faa110820c25c"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename LlamaReqType , typename LlamaRespType &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::SendLlamaRpc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *&#160;</td>
          <td class="paramname"><em>llama_client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const LlamaReqType &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LlamaRespType *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sends the given Llama RPC request via the given client. This function must be specialized on the Llama request/response types. Throws a TException. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00391">391</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>.</p>

</div>
</div>
<a class="anchor" id="ae69e80760f5cbae5583e862162b99502"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::SendLlamaRpc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *&#160;</td>
          <td class="paramname"><em>llama_client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const llama::TLlamaAMGetNodesRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMGetNodesResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00399">399</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ae53503b23012b4022eabe7128a11d674"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::SendLlamaRpc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *&#160;</td>
          <td class="paramname"><em>llama_client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const llama::TLlamaAMReservationRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMReservationResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00409">409</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

</div>
</div>
<a class="anchor" id="ab557aeffffb0b758e5bea6949d965b2e"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::SendLlamaRpc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *&#160;</td>
          <td class="paramname"><em>llama_client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const llama::TLlamaAMReservationExpansionRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMReservationExpansionResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00419">419</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a48cb59ad77a9a35fedca5acac5215ba2"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::SendLlamaRpc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ClientConnection.html">ClientConnection</a>&lt; llama::LlamaAMServiceClient &gt; *&#160;</td>
          <td class="paramname"><em>llama_client</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const llama::TLlamaAMReleaseRequest &amp;&#160;</td>
          <td class="paramname"><em>request</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">llama::TLlamaAMReleaseResponse *&#160;</td>
          <td class="paramname"><em>response</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00429">429</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

</div>
</div>
<a class="anchor" id="a3a9ba760d68b2bdc4c9afd68cdc567fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::set_scheduler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classimpala_1_1Scheduler.html">Scheduler</a> *&#160;</td>
          <td class="paramname"><em>scheduler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00096">96</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00176">scheduler_</a>.</p>

</div>
</div>
<a class="anchor" id="a40ab0a2508ebd057f9947b4a09bdb392"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void impala::ResourceBroker::UnregisterQueryResourceMgr </td>
          <td>(</td>
          <td class="paramtype">const TUniqueId &amp;&#160;</td>
          <td class="paramname"><em>query_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrements the reference count for a particular <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a>. If this is the last reference (i.e. the ref count goes to 0), the <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a> is deleted. It's an error to call this with a query_id that does not have a registered <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a>. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00793">793</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00388">query_resource_mgrs_</a>, and <a class="el" href="resource-broker_8h_source.html#l00381">query_resource_mgrs_lock_</a>.</p>

<p>Referenced by <a class="el" href="plan-fragment-executor_8cc_source.html#l00071">impala::PlanFragmentExecutor::~PlanFragmentExecutor()</a>.</p>

</div>
</div>
<a class="anchor" id="a695622288d18a987e71f5133e0667000"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classbool.html">bool</a> impala::ResourceBroker::WaitForNotification </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ResourceBroker.html#abac98ca868a97e61f640c14371bc3f46">ResourceMap</a> *&#160;</td>
          <td class="paramname"><em>resources</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classbool.html">bool</a> *&#160;</td>
          <td class="paramname"><em>timed_out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classimpala_1_1ResourceBroker_1_1PendingRequest.html">PendingRequest</a> *&#160;</td>
          <td class="paramname"><em>reservation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Wait for a reservation or expansion request to be fulfilled by the Llama via an async call into <a class="el" href="classimpala_1_1LlamaNotificationThriftIf.html#ae66b5184fb97eecbc2148522047da5e8">LlamaNotificationThriftIf::AMNotification()</a>, or for a timeout to occur (in which case *timed_out is set to true). If the request is fulfilled, resources and reservation_id are populated. </p>

<p>Definition at line <a class="el" href="resource-broker_8cc_source.html#l00472">472</a> of file <a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a>.</p>

<p>References <a class="el" href="resource-broker_8h_source.html#l00241">allocated_memory_metric_</a>, <a class="el" href="resource-broker_8h_source.html#l00378">allocated_requests_</a>, <a class="el" href="resource-broker_8h_source.html#l00371">allocated_requests_lock_</a>, <a class="el" href="resource-broker_8h_source.html#l00244">allocated_vcpus_metric_</a>, <a class="el" href="promise_8h_source.html#l00059">impala::Promise&lt; T &gt;::Get()</a>, <a class="el" href="resource-broker_8cc_source.html#l00450">impala::ResourceBroker::PendingRequest::GetResources()</a>, <a class="el" href="resource-broker_8h_source.html#l00310">impala::ResourceBroker::PendingRequest::is_expansion()</a>, <a class="el" href="resource-broker_8h_source.html#l00340">pending_requests_</a>, <a class="el" href="resource-broker_8h_source.html#l00334">pending_requests_lock_</a>, <a class="el" href="resource-broker_8h_source.html#l00296">impala::ResourceBroker::PendingRequest::promise()</a>, <a class="el" href="resource-broker_8h_source.html#l00307">impala::ResourceBroker::PendingRequest::request_id()</a>, and <a class="el" href="resource-broker_8h_source.html#l00308">impala::ResourceBroker::PendingRequest::reservation_id()</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="a7523e83c46ffa8c93c3dd10321b5c8fd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int impala::ResourceBroker::active_llama_addr_idx_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Indexes into llama_addresses_ indicating the currently active Llama. Protected by llama_registration_lock_. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00168">168</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="a34da4ee1e1c67d4aefa45ed15c69070b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#afcf5d0484c3833cf0f4f6c681412e398">StringProperty</a>* impala::ResourceBroker::active_llama_handle_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Llama handle received from the active Llama upon registration. Set to "none" while not registered with Llama. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00184">184</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a0730bf0f19ea7dad5562d9aeced4df99"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#afcf5d0484c3833cf0f4f6c681412e398">StringProperty</a>* impala::ResourceBroker::active_llama_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Address of the active Llama. A Llama is considered active once we have successfully registered with it. Set to "none" while registering with the Llama. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00180">180</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="acf702f177d0b6f11c31d0e9e0d2db56c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#a0ac05a476d08e3a556ef87c24d693af1">UIntGauge</a>* impala::ResourceBroker::allocated_memory_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total amount of memory currently allocated by Llama to this node. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00241">241</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00636">ClearRequests()</a>, <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="a99f92bb4485bacda3270216f480fbab7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ResourceBroker.html#ae3c5f34e30f1dc3b3b9122a141aefaf5">AllocatedRequestMap</a> impala::ResourceBroker::allocated_requests_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00378">378</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00636">ClearRequests()</a>, <a class="el" href="resource-broker_8cc_source.html#l00666">Release()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="a701360ab5e21dac4ce7ea968013abadf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::mutex impala::ResourceBroker::allocated_requests_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protectes allocated_requests_. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00371">371</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00636">ClearRequests()</a>, <a class="el" href="resource-broker_8cc_source.html#l00666">Release()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="ac0ebd2724e61ae0bcf539ad8cf56cf38"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#a0ac05a476d08e3a556ef87c24d693af1">UIntGauge</a>* impala::ResourceBroker::allocated_vcpus_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of vcpu cores currently allocated by Llama to this node. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00244">244</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00636">ClearRequests()</a>, <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="ab2d9429dd657d9c1e68a52a0a98367e5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::expansion_requests_failed_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Expansion requests that failed due to a malformed request or an internal error in Llama. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00231">231</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a55ddb1066c623744d72ff3739aff9f5b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::expansion_requests_fulfilled_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of fulfilled expansion requests. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00227">227</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="ac9d91d40a9070e10f54c2610c34f924c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::expansion_requests_rejected_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of well-formed expansion requests rejected by the central scheduler. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00234">234</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c3d22bd10d3daa33bd289adde7782cb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::expansion_requests_timedout_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of well-formed expansion requests that did not get fulfilled within the timeout period. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00238">238</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a630ee49a24793bbed51db52d5f7e068d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::expansion_requests_total_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of expansion requests. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00224">224</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a2f7fe372f509bbef0ffe9e84d58ebcd7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt;double&gt;* impala::ResourceBroker::expansion_response_time_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Accumulated statistics on the time taken to complete an expansion request (granted or denied). The time includes the request RPC to Llama and the time the requesting thread waits on the pending_requests_'s promise. The metric does not include requests that timed out. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00221">221</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a76cb0d1826b49793b67a6c69bff1db06"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt;double&gt;* impala::ResourceBroker::expansion_rpc_time_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Accumulated statistics on the time taken to RPC an expansion request and receive an acknowledgement from Llama. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00215">215</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="afd757296aa096be7bb8d25cbde4c1285"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;TNetworkAddress&gt; impala::ResourceBroker::llama_addresses_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Llama availability group. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00164">164</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00302">Close()</a>, <a class="el" href="resource-broker_8h_source.html#l00113">has_standby_llama()</a>, <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>, <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="ae44644eae8cb901d2fc02fd98dd0d122"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">TNetworkAddress impala::ResourceBroker::llama_callback_address_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Address of thrift server started in this resource broker to handle Llama notifications. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00172">172</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="a97d40782a608cd464a09320ba19cbbb5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::scoped_ptr&lt;<a class="el" href="classimpala_1_1ThriftServer.html">ThriftServer</a>&gt; impala::ResourceBroker::llama_callback_server_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00259">259</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00302">Close()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>.</p>

</div>
</div>
<a class="anchor" id="a83bcc5d2873069e6fadd8d912b5f01a2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;llama::LlamaNotificationServiceIf&gt; impala::ResourceBroker::llama_callback_thrift_iface_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thrift API implementation which proxies Llama notifications onto this <a class="el" href="classimpala_1_1ResourceBroker.html">ResourceBroker</a>. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00258">258</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>.</p>

</div>
</div>
<a class="anchor" id="af39436bc450fae778143525af4b376ea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::scoped_ptr&lt;<a class="el" href="classimpala_1_1ClientCache.html">ClientCache</a>&lt;llama::LlamaAMServiceClient&gt; &gt; impala::ResourceBroker::llama_client_cache_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cache of Llama client connections. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00262">262</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00302">Close()</a>, <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="ac7335ca4cb78dd0c94262683bbb11289"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::uuids::uuid impala::ResourceBroker::llama_client_id_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Client id used to register with Llama. Set in <a class="el" href="classimpala_1_1ResourceBroker.html#a539dbf49f28e8b4486218eb3b563182a">Init()</a>. Used to communicate to Llama whether this Impalad has restarted. Registration with Llama is idempotent if the same llama_client_id_ is passed, i.e., the same Llama handle is returned and resource allocations are preserved. From Llama's perspective an unknown llama_client_id_ indicates a new registration and all resources allocated by this Impalad under a different llama_client_id_ are consider lost and will be released. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00255">255</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="ae7fd6192aba5ae524c723d32343804a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">llama::TUniqueId impala::ResourceBroker::llama_handle_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handle received from Llama during registration. Set in <a class="el" href="classimpala_1_1ResourceBroker.html#a5c717a7553f6a32e54ca88436d7714da">RegisterWithLlama()</a>. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00269">269</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00691">AMNotification()</a>, <a class="el" href="resource-broker_8cc_source.html#l00328">CreateLlamaReleaseRequest()</a>, <a class="el" href="resource-broker_8cc_source.html#l00310">CreateLlamaReservationRequest()</a>, <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, <a class="el" href="resource-broker_8cc_source.html#l00336">LlamaRpc()</a>, <a class="el" href="resource-broker_8cc_source.html#l00766">RefreshLlamaNodes()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="a617f4592442383de35f23e94ce6dfb31"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;std::string&gt; impala::ResourceBroker::llama_nodes_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>List of nodes registered with Llama. Set in <a class="el" href="classimpala_1_1ResourceBroker.html#a942a5a76e066d9574dd17092e3ba20fe" title="Retrieves the nodes known to Llama and stores them in llama_nodes_. ">RefreshLlamaNodes()</a>. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00272">272</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8h_source.html#l00091">llama_nodes()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00766">RefreshLlamaNodes()</a>.</p>

</div>
</div>
<a class="anchor" id="adae716281df80e64f0ee222b9784f264"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::mutex impala::ResourceBroker::llama_registration_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Lock to ensure that only a single registration with Llama is sent, e.g., when multiple concurrent requests realize that Llama has restarted. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00266">266</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00691">AMNotification()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00204">RegisterWithLlama()</a>.</p>

</div>
</div>
<a class="anchor" id="ae32e2e6a125d739fa15e77d4f6de28dc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1MetricGroup.html">MetricGroup</a>* impala::ResourceBroker::metrics_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00174">174</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>.</p>

</div>
</div>
<a class="anchor" id="a02511adc8b156edb160533527edcce9e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ResourceBroker.html#a7624a16056e33855586aade1c76ea09c">PendingRequestMap</a> impala::ResourceBroker::pending_requests_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00340">340</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00691">AMNotification()</a>, <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="a452e18532a741a10dfa64e6ac58bc729"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::mutex impala::ResourceBroker::pending_requests_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protects pending_requests_. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00334">334</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00691">AMNotification()</a>, <a class="el" href="resource-broker_8cc_source.html#l00503">Expand()</a>, <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00472">WaitForNotification()</a>.</p>

</div>
</div>
<a class="anchor" id="aae54d739345788e7d4929828d3f593f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1ResourceBroker.html#a77799f9a86d4f1f6707333899a26bce3">QueryResourceMgrsMap</a> impala::ResourceBroker::query_resource_mgrs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Map from query ID to a (ref_count, QueryResourceMgr*) pair, i.e. one <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a> per query. The refererence count is always non-zero - once it hits zero the entry in the map is removed and the <a class="el" href="classimpala_1_1QueryResourceMgr.html" title="Only CPU-heavy threads need be managed using this class. ">QueryResourceMgr</a> is deleted. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00388">388</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00779">GetQueryResourceMgr()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00793">UnregisterQueryResourceMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a26aed4ffd908fd4882c4ded3d29eac44"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::mutex impala::ResourceBroker::query_resource_mgrs_lock_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Protects query_resource_mgrs_. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00381">381</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00779">GetQueryResourceMgr()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00793">UnregisterQueryResourceMgr()</a>.</p>

</div>
</div>
<a class="anchor" id="a0c442b1a7d0a88686d57853b889e8b41"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::requests_released_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of fulfilled reservation requests that have been released. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00247">247</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00666">Release()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a7b81e77222ad7df3485db8551084d68f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::reservation_requests_failed_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Reservation requests that failed due to a malformed request or an internal error in Llama. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00204">204</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a0804621474d2150b65a1f6eb4c384646"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::reservation_requests_fulfilled_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of fulfilled reservation requests. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00200">200</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a79587bbb49612d9644328b1d1702b100"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::reservation_requests_rejected_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of well-formed reservation requests rejected by the central scheduler. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00207">207</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a78b20e64f265f83204185e15ab04de50"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::reservation_requests_timedout_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Number of well-formed reservation requests that did not get fulfilled within the timeout period. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00211">211</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a8a7778b4a46ce7245eea75005ec14e45"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceimpala.html#ae72a16e1b3afb603ff4b5b4d78f0f0d0">IntCounter</a>* impala::ResourceBroker::reservation_requests_total_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Total number of reservation requests. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00197">197</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b38c4368e876904a6a7f7f643581cd3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt;double&gt;* impala::ResourceBroker::reservation_response_time_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Accumulated statistics on the time taken to complete a reservation request (granted or denied). The time includes the request RPC to Llama and the time the requesting thread waits on the pending_requests_'s promise. The metric does not include requests that timed out. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00194">194</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a3a081d1c45c55ade7bde75ce7265b4b5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1StatsMetric.html">StatsMetric</a>&lt;double&gt;* impala::ResourceBroker::reservation_rpc_time_metric_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Accumulated statistics on the time taken to RPC a reservation request and receive an acknowledgement from Llama. </p>

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00188">188</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00666">Release()</a>, <a class="el" href="resource-broker_8cc_source.html#l00569">Reserve()</a>, and <a class="el" href="resource-broker_8cc_source.html#l00089">ResourceBroker()</a>.</p>

</div>
</div>
<a class="anchor" id="a4c6255918c3dffed5506a456b3e4fa2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classimpala_1_1Scheduler.html">Scheduler</a>* impala::ResourceBroker::scheduler_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="resource-broker_8h_source.html#l00176">176</a> of file <a class="el" href="resource-broker_8h_source.html">resource-broker.h</a>.</p>

<p>Referenced by <a class="el" href="resource-broker_8cc_source.html#l00691">AMNotification()</a>, <a class="el" href="resource-broker_8cc_source.html#l00182">Init()</a>, and <a class="el" href="resource-broker_8h_source.html#l00096">set_scheduler()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>be/src/resourcebroker/<a class="el" href="resource-broker_8h_source.html">resource-broker.h</a></li>
<li>be/src/resourcebroker/<a class="el" href="resource-broker_8cc_source.html">resource-broker.cc</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceimpala.html">impala</a></li><li class="navelem"><a class="el" href="classimpala_1_1ResourceBroker.html">ResourceBroker</a></li>
    <li class="footer">Generated on Thu May 7 2015 16:10:49 for Impala by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
