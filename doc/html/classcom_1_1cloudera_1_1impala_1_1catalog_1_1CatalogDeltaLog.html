<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Impala: com.cloudera.impala.catalog.CatalogDeltaLog Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Impala
   </div>
   <div id="projectbrief">Impalaistheopensource,nativeanalyticdatabaseforApacheHadoop.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">com.cloudera.impala.catalog.CatalogDeltaLog Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for com.cloudera.impala.catalog.CatalogDeltaLog:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog__coll__graph.svg" width="263" height="304"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aa16f04b5411faafda7bf4e25a9c98cee"><td class="memItemLeft" align="right" valign="top">synchronized void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html#aa16f04b5411faafda7bf4e25a9c98cee">addRemovedObject</a> (TCatalogObject catalogObject)</td></tr>
<tr class="separator:aa16f04b5411faafda7bf4e25a9c98cee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20e1a57950343abb66d11c7bcc7b5b2d"><td class="memItemLeft" align="right" valign="top">synchronized void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html#a20e1a57950343abb66d11c7bcc7b5b2d">garbageCollect</a> (long currentCatalogVersion)</td></tr>
<tr class="separator:a20e1a57950343abb66d11c7bcc7b5b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf28d53606c80ea193f8bb583636387b"><td class="memItemLeft" align="right" valign="top">synchronized boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html#aaf28d53606c80ea193f8bb583636387b">wasObjectRemovedAfter</a> (TCatalogObject catalogObject)</td></tr>
<tr class="separator:aaf28d53606c80ea193f8bb583636387b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a11d7ecf7bfa5a54b50edf934562fb95d"><td class="memItemLeft" align="right" valign="top">boolean&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html#a11d7ecf7bfa5a54b50edf934562fb95d">objectNamesMatch</a> (TCatalogObject first, TCatalogObject second)</td></tr>
<tr class="separator:a11d7ecf7bfa5a54b50edf934562fb95d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abe33a9eebec471e8cb2b9ea64e0e6e53"><td class="memItemLeft" align="right" valign="top">SortedMap&lt; Long, TCatalogObject &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html#abe33a9eebec471e8cb2b9ea64e0e6e53">removedCatalogObjects_</a></td></tr>
<tr class="separator:abe33a9eebec471e8cb2b9ea64e0e6e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The impalad catalog cache can be modified by either a state store update or by a direct ("fast") update that applies the result of a catalog operation to the cache out-of-band of a state store update. This thread safe log tracks the divergence (due to direct updates to the cache) of this impalad's cache from the last state store update. This log is needed to ensure work is never undone. For example, consider the following sequence of events: t1: [Direct Update] - Add item A - (<a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html">Catalog</a> Version 9) t2: [Direct Update] - Drop item A - (<a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html">Catalog</a> Version 10) t3: [StateStore Update] - (From <a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html">Catalog</a> Version 9) This log is used to ensure the state store update in t3 does not undo the drop in t2.</p>
<p>Currently this only tracks objects that were dropped, since the catalog cache can be queried to check if an object was added. TODO: Also track object additions from async operations. This could be used to to "replay" the log in the case of a catalog reset ("invalidate metadata"). Currently, the catalog may briefly go back in time if "invalidate metadata" is run concurrently with async catalog operations. </p>

<p>Definition at line <a class="el" href="CatalogDeltaLog_8java_source.html#l00043">43</a> of file <a class="el" href="CatalogDeltaLog_8java_source.html">CatalogDeltaLog.java</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="aa16f04b5411faafda7bf4e25a9c98cee"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">synchronized void com.cloudera.impala.catalog.CatalogDeltaLog.addRemovedObject </td>
          <td>(</td>
          <td class="paramtype">TCatalogObject&#160;</td>
          <td class="paramname"><em>catalogObject</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Adds a new item to the map of removed catalog objects. </p>

<p>Definition at line <a class="el" href="CatalogDeltaLog_8java_source.html#l00052">52</a> of file <a class="el" href="CatalogDeltaLog_8java_source.html">CatalogDeltaLog.java</a>.</p>

</div>
</div>
<a class="anchor" id="a20e1a57950343abb66d11c7bcc7b5b2d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">synchronized void com.cloudera.impala.catalog.CatalogDeltaLog.garbageCollect </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>currentCatalogVersion</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Given the current catalog version, removes all items with catalogVersion &lt; currectCatalogVersion. Such objects do not need to be tracked in the delta log anymore because they are consistent with the state store's view of the catalog. </p>

<p>Definition at line <a class="el" href="CatalogDeltaLog_8java_source.html#l00063">63</a> of file <a class="el" href="CatalogDeltaLog_8java_source.html">CatalogDeltaLog.java</a>.</p>

<p>References <a class="el" href="CatalogDeltaLog_8java_source.html#l00046">com.cloudera.impala.catalog.CatalogDeltaLog.removedCatalogObjects_</a>.</p>

</div>
</div>
<a class="anchor" id="a11d7ecf7bfa5a54b50edf934562fb95d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boolean com.cloudera.impala.catalog.CatalogDeltaLog.objectNamesMatch </td>
          <td>(</td>
          <td class="paramtype">TCatalogObject&#160;</td>
          <td class="paramname"><em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TCatalogObject&#160;</td>
          <td class="paramname"><em>second</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns true if the two objects have the same object type and name. TODO: Use global object IDs everywhere instead of tracking catalog objects by name. </p>

<p>Definition at line <a class="el" href="CatalogDeltaLog_8java_source.html#l00094">94</a> of file <a class="el" href="CatalogDeltaLog_8java_source.html">CatalogDeltaLog.java</a>.</p>

<p>Referenced by <a class="el" href="CatalogDeltaLog_8java_source.html#l00077">com.cloudera.impala.catalog.CatalogDeltaLog.wasObjectRemovedAfter()</a>.</p>

</div>
</div>
<a class="anchor" id="aaf28d53606c80ea193f8bb583636387b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">synchronized boolean com.cloudera.impala.catalog.CatalogDeltaLog.wasObjectRemovedAfter </td>
          <td>(</td>
          <td class="paramtype">TCatalogObject&#160;</td>
          <td class="paramname"><em>catalogObject</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Checks if a matching catalog object was removed in a catalog version after this object's catalog version. Returns true if there was a matching object that was removed after this object, false otherwise. </p>

<p>Definition at line <a class="el" href="CatalogDeltaLog_8java_source.html#l00077">77</a> of file <a class="el" href="CatalogDeltaLog_8java_source.html">CatalogDeltaLog.java</a>.</p>

<p>References <a class="el" href="CatalogDeltaLog_8java_source.html#l00094">com.cloudera.impala.catalog.CatalogDeltaLog.objectNamesMatch()</a>, and <a class="el" href="CatalogDeltaLog_8java_source.html#l00046">com.cloudera.impala.catalog.CatalogDeltaLog.removedCatalogObjects_</a>.</p>

<p>Referenced by <a class="el" href="ImpaladCatalog_8java_source.html#l00231">com.cloudera.impala.catalog.ImpaladCatalog.addCatalogObject()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a class="anchor" id="abe33a9eebec471e8cb2b9ea64e0e6e53"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">SortedMap&lt;Long, TCatalogObject&gt; com.cloudera.impala.catalog.CatalogDeltaLog.removedCatalogObjects_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">      <span class="keyword">new</span> TreeMap&lt;Long, TCatalogObject&gt;()</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="CatalogDeltaLog_8java_source.html#l00046">46</a> of file <a class="el" href="CatalogDeltaLog_8java_source.html">CatalogDeltaLog.java</a>.</p>

<p>Referenced by <a class="el" href="CatalogDeltaLog_8java_source.html#l00063">com.cloudera.impala.catalog.CatalogDeltaLog.garbageCollect()</a>, and <a class="el" href="CatalogDeltaLog_8java_source.html#l00077">com.cloudera.impala.catalog.CatalogDeltaLog.wasObjectRemovedAfter()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>fe/src/main/java/com/cloudera/impala/catalog/<a class="el" href="CatalogDeltaLog_8java_source.html">CatalogDeltaLog.java</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecom.html">com</a></li><li class="navelem"><a class="el" href="namespacecom_1_1cloudera.html">cloudera</a></li><li class="navelem"><a class="el" href="namespacecom_1_1cloudera_1_1impala.html">impala</a></li><li class="navelem"><a class="el" href="namespacecom_1_1cloudera_1_1impala_1_1catalog.html">catalog</a></li><li class="navelem"><a class="el" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html">CatalogDeltaLog</a></li>
    <li class="footer">Generated on Thu May 7 2015 16:10:44 for Impala by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
