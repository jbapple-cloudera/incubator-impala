<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Impala: fe/src/main/java/com/cloudera/impala/catalog/ImpaladCatalog.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Impala
   </div>
   <div id="projectbrief">Impalaistheopensource,nativeanalyticdatabaseforApacheHadoop.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('ImpaladCatalog_8java_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ImpaladCatalog.java</div>  </div>
</div><!--header-->
<div class="contents">
<a href="ImpaladCatalog_8java.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// Copyright 2012 Cloudera Inc.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// you may not use this file except in compliance with the License.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// You may obtain a copy of the License at</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// http://www.apache.org/licenses/LICENSE-2.0</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Unless required by applicable law or agreed to in writing, software</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// See the License for the specific language governing permissions and</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// limitations under the License.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">package </span>com.cloudera.impala.catalog;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">import</span> java.util.concurrent.atomic.AtomicBoolean;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">import</span> org.apache.hadoop.fs.Path;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">import</span> org.apache.hadoop.hive.metastore.api.MetaException;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">import</span> org.apache.hadoop.hive.metastore.api.NoSuchObjectException;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">import</span> org.apache.log4j.Logger;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">import</span> org.apache.thrift.TException;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1MetaStoreClientPool_1_1MetaStoreClient.html">com.cloudera.impala.catalog.MetaStoreClientPool.MetaStoreClient</a>;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">import</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException.html">com.cloudera.impala.common.ImpalaException</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TCatalogObject;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TCatalogObjectType;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TDataSource;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TDatabase;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TFunction;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TPrivilege;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TRole;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TTable;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TUniqueId;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TUpdateCatalogCacheRequest;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">import</span> com.cloudera.impala.thrift.TUpdateCatalogCacheResponse;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html">   64</a></span>&#160;<span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html">ImpaladCatalog</a> <span class="keyword">extends</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html">Catalog</a> {</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a1ce01847ba646a805775c5d676a2ce3a">   65</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a1ce01847ba646a805775c5d676a2ce3a">LOG</a> = Logger.getLogger(ImpaladCatalog.class);</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd42c0f57077c1d1b593684a1abe99ba">   66</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> TUniqueId <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd42c0f57077c1d1b593684a1abe99ba">INITIAL_CATALOG_SERVICE_ID</a> = <span class="keyword">new</span> TUniqueId(0L, 0L);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">// The last known Catalog Service ID. If the ID changes, it indicates the CatalogServer</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// has restarted.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a62c624348d64f2122522f05a210e9387">   70</a></span>&#160;  <span class="keyword">private</span> TUniqueId <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a62c624348d64f2122522f05a210e9387">catalogServiceId_</a> = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd42c0f57077c1d1b593684a1abe99ba">INITIAL_CATALOG_SERVICE_ID</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">// The catalog version received in the last StateStore heartbeat. It is guaranteed</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">// all objects in the catalog have at a minimum, this version. Because updates may</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// be applied out of band of a StateStore heartbeat, it is possible the catalog</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// contains some objects &gt; than this version.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a29ab482e32765cbc83a9b4d917611cd5">   76</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a29ab482e32765cbc83a9b4d917611cd5">lastSyncedCatalogVersion_</a> = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#aa7cb009b38d01fd1980615935644498b">Catalog.INITIAL_CATALOG_VERSION</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// Flag to determine if the Catalog is ready to accept user requests. See isReady().</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ac96c8895c0f0bd271add9a85511fec04">   79</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> AtomicBoolean <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ac96c8895c0f0bd271add9a85511fec04">isReady_</a> = <span class="keyword">new</span> AtomicBoolean(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// Tracks modifications to this Impalad&#39;s catalog from direct updates to the cache.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9341f75fc511dc4b8c69162279749c96">   82</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html">CatalogDeltaLog</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9341f75fc511dc4b8c69162279749c96">catalogDeltaLog_</a> = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html">CatalogDeltaLog</a>();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="comment">// Object that is used to synchronize on and signal when a catalog update is received.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aefbbd96fcd48df015dc5f94edbafc684">   85</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> Object <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aefbbd96fcd48df015dc5f94edbafc684">catalogUpdateEventNotifier_</a> = <span class="keyword">new</span> Object();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ad50d5b1a50796a6b446dd6c49c9603a3">   91</a></span>&#160;  <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ad50d5b1a50796a6b446dd6c49c9603a3">ImpaladCatalog</a>() {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    super(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a31c03bd54edd9bbad61b29659b8b15c4">  112</a></span>&#160;  <span class="keyword">public</span> <span class="keyword">synchronized</span> TUpdateCatalogCacheResponse <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a31c03bd54edd9bbad61b29659b8b15c4">updateCatalog</a>(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    TUpdateCatalogCacheRequest req) <span class="keywordflow">throws</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogException.html">CatalogException</a> {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// Check for changes in the catalog service ID.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a62c624348d64f2122522f05a210e9387">catalogServiceId_</a>.equals(req.getCatalog_service_id())) {</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">boolean</span> firstRun = catalogServiceId_.equals(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd42c0f57077c1d1b593684a1abe99ba">INITIAL_CATALOG_SERVICE_ID</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a62c624348d64f2122522f05a210e9387">catalogServiceId_</a> = req.getCatalog_service_id();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordflow">if</span> (!firstRun) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <span class="comment">// Throw an exception which will trigger a full topic update request.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">throw</span> <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogException.html">CatalogException</a>(<span class="stringliteral">&quot;Detected catalog service ID change. Aborting &quot;</span> +</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="stringliteral">&quot;updateCatalog()&quot;</span>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// First process all updates</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordtype">long</span> newCatalogVersion = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a29ab482e32765cbc83a9b4d917611cd5">lastSyncedCatalogVersion_</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (TCatalogObject catalogObject: req.getUpdated_objects()) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">if</span> (catalogObject.getType() == TCatalogObjectType.CATALOG) {</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        newCatalogVersion = catalogObject.getCatalog_version();</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;          <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aea9b7f6be4ca617535276bce8e202839">addCatalogObject</a>(catalogObject);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        } <span class="keywordflow">catch</span> (Exception e) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          LOG.error(<span class="stringliteral">&quot;Error adding catalog object: &quot;</span> + e.getMessage(), e);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      }</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// Now remove all objects from the catalog. Removing a database before removing</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// its child tables/functions is fine. If that happens, the removal of the child</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// object will be a no-op.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">for</span> (TCatalogObject catalogObject: req.getRemoved_objects()) {</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af46371ee31196cd333d2f75de654a6e5">removeCatalogObject</a>(catalogObject, newCatalogVersion);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a29ab482e32765cbc83a9b4d917611cd5">lastSyncedCatalogVersion_</a> = newCatalogVersion;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// Cleanup old entries in the log.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    catalogDeltaLog_.garbageCollect(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a29ab482e32765cbc83a9b4d917611cd5">lastSyncedCatalogVersion_</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    isReady_.set(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// Notify all the threads waiting on a catalog update.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">synchronized</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aefbbd96fcd48df015dc5f94edbafc684">catalogUpdateEventNotifier_</a>) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      catalogUpdateEventNotifier_.notifyAll();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">new</span> TUpdateCatalogCacheResponse(<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a62c624348d64f2122522f05a210e9387">catalogServiceId_</a>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ae85932a2f39a1ff03505b6211dc6b8ea">  164</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ae85932a2f39a1ff03505b6211dc6b8ea">waitForCatalogUpdate</a>(<span class="keywordtype">long</span> timeoutMs) {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">synchronized</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aefbbd96fcd48df015dc5f94edbafc684">catalogUpdateEventNotifier_</a>) {</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        catalogUpdateEventNotifier_.wait(timeoutMs);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      } <span class="keywordflow">catch</span> (InterruptedException e) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="comment">// Ignore</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  @Override</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a3cb610c0b5d476885908ad42c9ef3738">  181</a></span>&#160;  <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html">Table</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a3cb610c0b5d476885908ad42c9ef3738">getTable</a>(String dbName, String tableName)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <span class="keywordflow">throws</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogException.html">CatalogException</a> {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html">Table</a> table = super.getTable(dbName, tableName);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keywordflow">if</span> (table == null) <span class="keywordflow">return</span> null;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordflow">if</span> (table.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html#a1cf86992d49453aecc5a843d2c7ad78f">isLoaded</a>() &amp;&amp; table instanceof <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1IncompleteTable.html">IncompleteTable</a>) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="comment">// If there were problems loading this table&#39;s metadata, throw an exception</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="comment">// when it is accessed.</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException.html">ImpalaException</a> cause = ((<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1IncompleteTable.html">IncompleteTable</a>) table).getCause();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keywordflow">if</span> (cause instanceof <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1TableLoadingException.html">TableLoadingException</a>) <span class="keywordflow">throw</span> (TableLoadingException) cause;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> TableLoadingException(<span class="stringliteral">&quot;Missing metadata for table: &quot;</span> + tableName, cause);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordflow">return</span> table;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ab11c9c0c2d7800819234562bf9fca9fa">  205</a></span>&#160;  <span class="keyword">public</span> Path <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ab11c9c0c2d7800819234562bf9fca9fa">getTablePath</a>(org.apache.hadoop.hive.metastore.api.Table msTbl)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      throws NoSuchObjectException, MetaException, TException {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1MetaStoreClientPool_1_1MetaStoreClient.html">MetaStoreClient</a> client = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a7d121b32b2a0b0a720520e286998ee21">getMetaStoreClient</a>();</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <span class="comment">// If the table did not have its path set, build the path based on the the</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      <span class="comment">// location property of the parent database.</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keywordflow">if</span> (msTbl.getSd().getLocation() == null || msTbl.getSd().getLocation().isEmpty()) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        String dbLocation =</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            client.getHiveClient().getDatabase(msTbl.getDbName()).getLocationUri();</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> Path(dbLocation, msTbl.getTableName().toLowerCase());</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">new</span> Path(msTbl.getSd().getLocation());</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    } <span class="keywordflow">finally</span> {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      client.release();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aea9b7f6be4ca617535276bce8e202839">  231</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aea9b7f6be4ca617535276bce8e202839">addCatalogObject</a>(TCatalogObject catalogObject)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">throws</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1TableLoadingException.html">TableLoadingException</a>, <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1DatabaseNotFoundException.html">DatabaseNotFoundException</a> {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// This item is out of date and should not be applied to the catalog.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9341f75fc511dc4b8c69162279749c96">catalogDeltaLog_</a>.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html#aaf28d53606c80ea193f8bb583636387b">wasObjectRemovedAfter</a>(catalogObject)) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      LOG.debug(String.format(<span class="stringliteral">&quot;Skipping update because a matching object was removed &quot;</span> +</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <span class="stringliteral">&quot;in a later catalog version: %s&quot;</span>, catalogObject));</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">switch</span>(catalogObject.getType()) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">case</span> DATABASE:</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a8639266ae9f3ea363ded8ac388f38c46">addDb</a>(catalogObject.getDb(), catalogObject.getCatalog_version());</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <span class="keywordflow">case</span> TABLE:</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      <span class="keywordflow">case</span> VIEW:</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd6adc39e1ca850583bef9abb73564ab">addTable</a>(catalogObject.getTable(), catalogObject.getCatalog_version());</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">case</span> FUNCTION:</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a4cda82b0b03e5ef8a3e983b2895a9103">addFunction</a>(catalogObject.getFn(), catalogObject.getCatalog_version());</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">case</span> DATA_SOURCE:</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a7c3a2e34d33a9301ab8b6ff0de65d293">addDataSource</a>(catalogObject.getData_source(), catalogObject.getCatalog_version());</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      <span class="keywordflow">case</span> ROLE:</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role.html">Role</a> role = Role.fromThrift(catalogObject.getRole());</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        role.setCatalogVersion(catalogObject.getCatalog_version());</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        authPolicy_.addRole(role);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">case</span> PRIVILEGE:</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1RolePrivilege.html">RolePrivilege</a> privilege =</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            RolePrivilege.fromThrift(catalogObject.getPrivilege());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        privilege.setCatalogVersion(catalogObject.getCatalog_version());</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;          authPolicy_.addPrivilege(privilege);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        } <span class="keywordflow">catch</span> (<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogException.html">CatalogException</a> e) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          LOG.error(<span class="stringliteral">&quot;Error adding privilege: &quot;</span>, e);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <span class="keywordflow">case</span> HDFS_CACHE_POOL:</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool.html">HdfsCachePool</a> cachePool = <span class="keyword">new</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool.html">HdfsCachePool</a>(catalogObject.getCache_pool());</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        cachePool.setCatalogVersion(catalogObject.getCatalog_version());</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        hdfsCachePools_.add(cachePool);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalStateException(</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="stringliteral">&quot;Unexpected TCatalogObjectType: &quot;</span> + catalogObject.getType());</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af46371ee31196cd333d2f75de654a6e5">  290</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af46371ee31196cd333d2f75de654a6e5">removeCatalogObject</a>(TCatalogObject catalogObject,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordtype">long</span> currentCatalogUpdateVersion) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// The TCatalogObject associated with a drop operation from a state store</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// heartbeat will always have a version of zero. Because no update from</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// the state store can contain both a drop and an addition of the same object,</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// we can assume the drop version is the current catalog version of this update.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">// If the TCatalogObject contains a version that != 0, it indicates the drop</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// came from a direct update.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">long</span> dropCatalogVersion = catalogObject.getCatalog_version() == 0 ?</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        currentCatalogUpdateVersion : catalogObject.getCatalog_version();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">switch</span>(catalogObject.getType()) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="keywordflow">case</span> DATABASE:</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a6e34c2bdb539742800ca535c31a57ab5">removeDb</a>(catalogObject.getDb(), dropCatalogVersion);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="keywordflow">case</span> TABLE:</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">case</span> VIEW:</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a23cd2aaf99ad94bd50f938f73bf037fe">removeTable</a>(catalogObject.getTable(), dropCatalogVersion);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="keywordflow">case</span> FUNCTION:</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#adb4e17042aac6b024f94a0fde75af462">removeFunction</a>(catalogObject.getFn(), dropCatalogVersion);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="keywordflow">case</span> DATA_SOURCE:</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af6f27183cefff56ddc78178ebeefac45">removeDataSource</a>(catalogObject.getData_source(), dropCatalogVersion);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="keywordflow">case</span> ROLE:</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aa65b9d61736d016ab7b0823982ba8b17">removeRole</a>(catalogObject.getRole(), dropCatalogVersion);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">case</span> PRIVILEGE:</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9d385ff60501b513fdb04d1816fd49de">removePrivilege</a>(catalogObject.getPrivilege(), dropCatalogVersion);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      <span class="keywordflow">case</span> HDFS_CACHE_POOL:</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool.html">HdfsCachePool</a> existingItem =</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            hdfsCachePools_.get(catalogObject.getCache_pool().getPool_name());</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">if</span> (existingItem.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool.html#a3ec8ab96822a8f274293c248ce91b7d9">getCatalogVersion</a>() &gt; catalogObject.getCatalog_version()) {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          hdfsCachePools_.remove(catalogObject.getCache_pool().getPool_name());</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalStateException(</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <span class="stringliteral">&quot;Unexpected TCatalogObjectType: &quot;</span> + catalogObject.getType());</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">if</span> (catalogObject.getCatalog_version() &gt; <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a29ab482e32765cbc83a9b4d917611cd5">lastSyncedCatalogVersion_</a>) {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      catalogDeltaLog_.addRemovedObject(catalogObject);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div>
<div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a8639266ae9f3ea363ded8ac388f38c46">  338</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a8639266ae9f3ea363ded8ac388f38c46">addDb</a>(TDatabase thriftDb, <span class="keywordtype">long</span> catalogVersion) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">Db</a> existingDb = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">getDb</a>(thriftDb.getDb_name());</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (existingDb == null ||</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        existingDb.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html#a1f4733fb3eca22da074087314c4f5a63">getCatalogVersion</a>() &lt; catalogVersion) {</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">Db</a> newDb = Db.fromTDatabase(thriftDb, <span class="keyword">this</span>);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      newDb.setCatalogVersion(catalogVersion);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a8639266ae9f3ea363ded8ac388f38c46">addDb</a>(newDb);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd6adc39e1ca850583bef9abb73564ab">  348</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd6adc39e1ca850583bef9abb73564ab">addTable</a>(TTable thriftTable, <span class="keywordtype">long</span> catalogVersion)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="keywordflow">throws</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1TableLoadingException.html">TableLoadingException</a> {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">Db</a> db = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">getDb</a>(thriftTable.db_name);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (db == null) {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      LOG.debug(<span class="stringliteral">&quot;Parent database of table does not exist: &quot;</span> +</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;          thriftTable.db_name + <span class="stringliteral">&quot;.&quot;</span> + thriftTable.tbl_name);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html">Table</a> newTable = Table.fromThrift(db, thriftTable);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    newTable.setCatalogVersion(catalogVersion);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    db.addTable(newTable);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a4cda82b0b03e5ef8a3e983b2895a9103">  362</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a4cda82b0b03e5ef8a3e983b2895a9103">addFunction</a>(TFunction fn, <span class="keywordtype">long</span> catalogVersion) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function.html">Function</a> <span class="keyword">function</span> = Function.fromThrift(fn);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    function.setCatalogVersion(catalogVersion);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">Db</a> db = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">getDb</a>(<span class="keyword">function</span>.getFunctionName().<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">getDb</a>());</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">if</span> (db == null) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;      LOG.debug(<span class="stringliteral">&quot;Parent database of function does not exist: &quot;</span> + function.getName());</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function.html">Function</a> existingFn = db.getFunction(fn.getSignature());</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (existingFn == null ||</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        existingFn.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function.html#a1fbad3f4e9baa14c0240c971bafaea1a">getCatalogVersion</a>() &lt; catalogVersion) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      db.addFunction(<span class="keyword">function</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  }</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div>
<div class="line"><a name="l00377"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a7c3a2e34d33a9301ab8b6ff0de65d293">  377</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a7c3a2e34d33a9301ab8b6ff0de65d293">addDataSource</a>(TDataSource thrift, <span class="keywordtype">long</span> catalogVersion) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1DataSource.html">DataSource</a> dataSource = DataSource.fromThrift(thrift);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    dataSource.setCatalogVersion(catalogVersion);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a7c3a2e34d33a9301ab8b6ff0de65d293">addDataSource</a>(dataSource);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div>
<div class="line"><a name="l00383"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af6f27183cefff56ddc78178ebeefac45">  383</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af6f27183cefff56ddc78178ebeefac45">removeDataSource</a>(TDataSource thrift, <span class="keywordtype">long</span> dropCatalogVersion) {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af6f27183cefff56ddc78178ebeefac45">removeDataSource</a>(thrift.getName());</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a6e34c2bdb539742800ca535c31a57ab5">  387</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a6e34c2bdb539742800ca535c31a57ab5">removeDb</a>(TDatabase thriftDb, <span class="keywordtype">long</span> dropCatalogVersion) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">Db</a> db = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">getDb</a>(thriftDb.getDb_name());</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keywordflow">if</span> (db != null &amp;&amp; db.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html#a1f4733fb3eca22da074087314c4f5a63">getCatalogVersion</a>() &lt; dropCatalogVersion) {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a6e34c2bdb539742800ca535c31a57ab5">removeDb</a>(db.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html#af3bf6ada05f4568dc6572c618d182c89">getName</a>());</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div>
<div class="line"><a name="l00394"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a23cd2aaf99ad94bd50f938f73bf037fe">  394</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a23cd2aaf99ad94bd50f938f73bf037fe">removeTable</a>(TTable thriftTable, <span class="keywordtype">long</span> dropCatalogVersion) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">Db</a> db = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">getDb</a>(thriftTable.db_name);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// The parent database doesn&#39;t exist, nothing to do.</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">if</span> (db == null) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html">Table</a> table = db.getTable(thriftTable.getTbl_name());</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">if</span> (table != null &amp;&amp; table.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html#a300fad43a6c30387141ea5b7567b5cf2">getCatalogVersion</a>() &lt; dropCatalogVersion) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      db.removeTable(thriftTable.tbl_name);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#adb4e17042aac6b024f94a0fde75af462">  405</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#adb4e17042aac6b024f94a0fde75af462">removeFunction</a>(TFunction thriftFn, <span class="keywordtype">long</span> dropCatalogVersion) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">Db</a> db = <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">getDb</a>(thriftFn.name.getDb_name());</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// The parent database doesn&#39;t exist, nothing to do.</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (db == null) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// If the function exists and it has a catalog version less than the</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// version of the drop, remove the function.</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function.html">Function</a> fn = db.getFunction(thriftFn.getSignature());</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (fn != null &amp;&amp; fn.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function.html#a1fbad3f4e9baa14c0240c971bafaea1a">getCatalogVersion</a>() &lt; dropCatalogVersion) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      db.removeFunction(thriftFn.getSignature());</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aa65b9d61736d016ab7b0823982ba8b17">  418</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aa65b9d61736d016ab7b0823982ba8b17">removeRole</a>(TRole thriftRole, <span class="keywordtype">long</span> dropCatalogVersion) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role.html">Role</a> existingRole = authPolicy_.getRole(thriftRole.getRole_name());</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// version of the drop, remove the function.</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (existingRole != null &amp;&amp; existingRole.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role.html#a5642096f2701e9fafc324bdcf85b66d4">getCatalogVersion</a>() &lt; dropCatalogVersion) {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      authPolicy_.removeRole(thriftRole.getRole_name());</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div>
<div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9d385ff60501b513fdb04d1816fd49de">  426</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9d385ff60501b513fdb04d1816fd49de">removePrivilege</a>(TPrivilege thriftPrivilege, <span class="keywordtype">long</span> dropCatalogVersion) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role.html">Role</a> role = authPolicy_.getRole(thriftPrivilege.getRole_id());</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (role == null) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1RolePrivilege.html">RolePrivilege</a> existingPrivilege =</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        role.getPrivilege(thriftPrivilege.getPrivilege_name());</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// version of the drop, remove the function.</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (existingPrivilege != null &amp;&amp;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        existingPrivilege.<a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1RolePrivilege.html#aa05ba4016a015437f42e86396899cef7">getCatalogVersion</a>() &lt; dropCatalogVersion) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      role.removePrivilege(thriftPrivilege.getPrivilege_name());</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a5d4e5c9f41aa84138e545b4adfc2753d">  443</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">boolean</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a5d4e5c9f41aa84138e545b4adfc2753d">isReady</a>() { <span class="keywordflow">return</span> isReady_.get(); }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// Only used for testing.</span></div>
<div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a22077f6af21a841dd00ff34190065604">  446</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a22077f6af21a841dd00ff34190065604">setIsReady</a>() { isReady_.set(<span class="keyword">true</span>); }</div>
<div class="line"><a name="l00447"></a><span class="lineno"><a class="line" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ad89b77b9dcfab4c7d2a9e470d16107f5">  447</a></span>&#160;  <span class="keyword">public</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1AuthorizationPolicy.html">AuthorizationPolicy</a> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ad89b77b9dcfab4c7d2a9e470d16107f5">getAuthPolicy</a>() { <span class="keywordflow">return</span> <a class="code" href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#aeb99f5c71a955d80cb9369bf3cc3a67f">authPolicy_</a>; }</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a31c03bd54edd9bbad61b29659b8b15c4"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a31c03bd54edd9bbad61b29659b8b15c4">com.cloudera.impala.catalog.ImpaladCatalog.updateCatalog</a></div><div class="ttdeci">synchronized TUpdateCatalogCacheResponse updateCatalog(TUpdateCatalogCacheRequest req)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00112">ImpaladCatalog.java:112</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html">com.cloudera.impala.catalog.Catalog</a></div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8java_source.html#l00053">Catalog.java:53</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html">com.cloudera.impala.catalog.Table</a></div><div class="ttdef"><b>Definition:</b> <a href="Table_8java_source.html#l00051">Table.java:51</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1DataSource_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1DataSource.html">com.cloudera.impala.catalog.DataSource</a></div><div class="ttdef"><b>Definition:</b> <a href="DataSource_8java_source.html#l00027">DataSource.java:27</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_aa65b9d61736d016ab7b0823982ba8b17"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aa65b9d61736d016ab7b0823982ba8b17">com.cloudera.impala.catalog.ImpaladCatalog.removeRole</a></div><div class="ttdeci">void removeRole(TRole thriftRole, long dropCatalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00418">ImpaladCatalog.java:418</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_af6f27183cefff56ddc78178ebeefac45"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af6f27183cefff56ddc78178ebeefac45">com.cloudera.impala.catalog.ImpaladCatalog.removeDataSource</a></div><div class="ttdeci">void removeDataSource(TDataSource thrift, long dropCatalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00383">ImpaladCatalog.java:383</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db_html_af3bf6ada05f4568dc6572c618d182c89"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html#af3bf6ada05f4568dc6572c618d182c89">com.cloudera.impala.catalog.Db.getName</a></div><div class="ttdeci">String getName()</div><div class="ttdef"><b>Definition:</b> <a href="Db_8java_source.html#l00081">Db.java:81</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table_html_a300fad43a6c30387141ea5b7567b5cf2"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html#a300fad43a6c30387141ea5b7567b5cf2">com.cloudera.impala.catalog.Table.getCatalogVersion</a></div><div class="ttdeci">long getCatalogVersion()</div><div class="ttdef"><b>Definition:</b> <a href="Table_8java_source.html#l00408">Table.java:408</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1IncompleteTable_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1IncompleteTable.html">com.cloudera.impala.catalog.IncompleteTable</a></div><div class="ttdef"><b>Definition:</b> <a href="IncompleteTable_8java_source.html#l00037">IncompleteTable.java:37</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a4cda82b0b03e5ef8a3e983b2895a9103"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a4cda82b0b03e5ef8a3e983b2895a9103">com.cloudera.impala.catalog.ImpaladCatalog.addFunction</a></div><div class="ttdeci">void addFunction(TFunction fn, long catalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00362">ImpaladCatalog.java:362</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a5d4e5c9f41aa84138e545b4adfc2753d"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a5d4e5c9f41aa84138e545b4adfc2753d">com.cloudera.impala.catalog.ImpaladCatalog.isReady</a></div><div class="ttdeci">boolean isReady()</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00443">ImpaladCatalog.java:443</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_ab11c9c0c2d7800819234562bf9fca9fa"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ab11c9c0c2d7800819234562bf9fca9fa">com.cloudera.impala.catalog.ImpaladCatalog.getTablePath</a></div><div class="ttdeci">Path getTablePath(org.apache.hadoop.hive.metastore.api.Table msTbl)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00205">ImpaladCatalog.java:205</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog_html_a5658ea435839f2c30e9c25f045be3270"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a5658ea435839f2c30e9c25f045be3270">com.cloudera.impala.catalog.Catalog.getDb</a></div><div class="ttdeci">Db getDb(String dbName)</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8java_source.html#l00115">Catalog.java:115</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_ad50d5b1a50796a6b446dd6c49c9603a3"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ad50d5b1a50796a6b446dd6c49c9603a3">com.cloudera.impala.catalog.ImpaladCatalog.ImpaladCatalog</a></div><div class="ttdeci">ImpaladCatalog()</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00091">ImpaladCatalog.java:91</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_af46371ee31196cd333d2f75de654a6e5"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#af46371ee31196cd333d2f75de654a6e5">com.cloudera.impala.catalog.ImpaladCatalog.removeCatalogObject</a></div><div class="ttdeci">void removeCatalogObject(TCatalogObject catalogObject, long currentCatalogUpdateVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00290">ImpaladCatalog.java:290</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a1ce01847ba646a805775c5d676a2ce3a"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a1ce01847ba646a805775c5d676a2ce3a">com.cloudera.impala.catalog.ImpaladCatalog.LOG</a></div><div class="ttdeci">static final Logger LOG</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00065">ImpaladCatalog.java:65</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1RolePrivilege_html_aa05ba4016a015437f42e86396899cef7"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1RolePrivilege.html#aa05ba4016a015437f42e86396899cef7">com.cloudera.impala.catalog.RolePrivilege.getCatalogVersion</a></div><div class="ttdeci">synchronized long getCatalogVersion()</div><div class="ttdef"><b>Definition:</b> <a href="RolePrivilege_8java_source.html#l00113">RolePrivilege.java:113</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1AuthorizationPolicy_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1AuthorizationPolicy.html">com.cloudera.impala.catalog.AuthorizationPolicy</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthorizationPolicy_8java_source.html#l00055">AuthorizationPolicy.java:55</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_aefbbd96fcd48df015dc5f94edbafc684"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aefbbd96fcd48df015dc5f94edbafc684">com.cloudera.impala.catalog.ImpaladCatalog.catalogUpdateEventNotifier_</a></div><div class="ttdeci">final Object catalogUpdateEventNotifier_</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00085">ImpaladCatalog.java:85</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role.html">com.cloudera.impala.catalog.Role</a></div><div class="ttdef"><b>Definition:</b> <a href="Role_8java_source.html#l00030">Role.java:30</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_ad89b77b9dcfab4c7d2a9e470d16107f5"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ad89b77b9dcfab4c7d2a9e470d16107f5">com.cloudera.impala.catalog.ImpaladCatalog.getAuthPolicy</a></div><div class="ttdeci">AuthorizationPolicy getAuthPolicy()</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00447">ImpaladCatalog.java:447</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a3cb610c0b5d476885908ad42c9ef3738"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a3cb610c0b5d476885908ad42c9ef3738">com.cloudera.impala.catalog.ImpaladCatalog.getTable</a></div><div class="ttdeci">Table getTable(String dbName, String tableName)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00181">ImpaladCatalog.java:181</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog_html_aaf28d53606c80ea193f8bb583636387b"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html#aaf28d53606c80ea193f8bb583636387b">com.cloudera.impala.catalog.CatalogDeltaLog.wasObjectRemovedAfter</a></div><div class="ttdeci">synchronized boolean wasObjectRemovedAfter(TCatalogObject catalogObject)</div><div class="ttdef"><b>Definition:</b> <a href="CatalogDeltaLog_8java_source.html#l00077">CatalogDeltaLog.java:77</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html">com.cloudera.impala.catalog.ImpaladCatalog</a></div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00064">ImpaladCatalog.java:64</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool.html">com.cloudera.impala.catalog.HdfsCachePool</a></div><div class="ttdef"><b>Definition:</b> <a href="HdfsCachePool_8java_source.html#l00028">HdfsCachePool.java:28</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db_html_a1f4733fb3eca22da074087314c4f5a63"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html#a1f4733fb3eca22da074087314c4f5a63">com.cloudera.impala.catalog.Db.getCatalogVersion</a></div><div class="ttdeci">long getCatalogVersion()</div><div class="ttdef"><b>Definition:</b> <a href="Db_8java_source.html#l00292">Db.java:292</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog_html_aa7cb009b38d01fd1980615935644498b"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#aa7cb009b38d01fd1980615935644498b">com.cloudera.impala.catalog.Catalog.INITIAL_CATALOG_VERSION</a></div><div class="ttdeci">static final long INITIAL_CATALOG_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8java_source.html#l00057">Catalog.java:57</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function_html_a1fbad3f4e9baa14c0240c971bafaea1a"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function.html#a1fbad3f4e9baa14c0240c971bafaea1a">com.cloudera.impala.catalog.Function.getCatalogVersion</a></div><div class="ttdeci">long getCatalogVersion()</div><div class="ttdef"><b>Definition:</b> <a href="Function_8java_source.html#l00286">Function.java:286</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role_html_a5642096f2701e9fafc324bdcf85b66d4"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Role.html#a5642096f2701e9fafc324bdcf85b66d4">com.cloudera.impala.catalog.Role.getCatalogVersion</a></div><div class="ttdeci">synchronized long getCatalogVersion()</div><div class="ttdef"><b>Definition:</b> <a href="Role_8java_source.html#l00134">Role.java:134</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a62c624348d64f2122522f05a210e9387"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a62c624348d64f2122522f05a210e9387">com.cloudera.impala.catalog.ImpaladCatalog.catalogServiceId_</a></div><div class="ttdeci">TUniqueId catalogServiceId_</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00070">ImpaladCatalog.java:70</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a22077f6af21a841dd00ff34190065604"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a22077f6af21a841dd00ff34190065604">com.cloudera.impala.catalog.ImpaladCatalog.setIsReady</a></div><div class="ttdeci">void setIsReady()</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00446">ImpaladCatalog.java:446</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_aea9b7f6be4ca617535276bce8e202839"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#aea9b7f6be4ca617535276bce8e202839">com.cloudera.impala.catalog.ImpaladCatalog.addCatalogObject</a></div><div class="ttdeci">void addCatalogObject(TCatalogObject catalogObject)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00231">ImpaladCatalog.java:231</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Function.html">com.cloudera.impala.catalog.Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8java_source.html#l00041">Function.java:41</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_afd6adc39e1ca850583bef9abb73564ab"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd6adc39e1ca850583bef9abb73564ab">com.cloudera.impala.catalog.ImpaladCatalog.addTable</a></div><div class="ttdeci">void addTable(TTable thriftTable, long catalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00348">ImpaladCatalog.java:348</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a9341f75fc511dc4b8c69162279749c96"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9341f75fc511dc4b8c69162279749c96">com.cloudera.impala.catalog.ImpaladCatalog.catalogDeltaLog_</a></div><div class="ttdeci">final CatalogDeltaLog catalogDeltaLog_</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00082">ImpaladCatalog.java:82</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1DatabaseNotFoundException_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1DatabaseNotFoundException.html">com.cloudera.impala.catalog.DatabaseNotFoundException</a></div><div class="ttdef"><b>Definition:</b> <a href="DatabaseNotFoundException_8java_source.html#l00021">DatabaseNotFoundException.java:21</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_ac96c8895c0f0bd271add9a85511fec04"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ac96c8895c0f0bd271add9a85511fec04">com.cloudera.impala.catalog.ImpaladCatalog.isReady_</a></div><div class="ttdeci">final AtomicBoolean isReady_</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00079">ImpaladCatalog.java:79</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog_html_aeb99f5c71a955d80cb9369bf3cc3a67f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#aeb99f5c71a955d80cb9369bf3cc3a67f">com.cloudera.impala.catalog.Catalog.authPolicy_</a></div><div class="ttdeci">AuthorizationPolicy authPolicy_</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8java_source.html#l00067">Catalog.java:67</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a23cd2aaf99ad94bd50f938f73bf037fe"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a23cd2aaf99ad94bd50f938f73bf037fe">com.cloudera.impala.catalog.ImpaladCatalog.removeTable</a></div><div class="ttdeci">void removeTable(TTable thriftTable, long dropCatalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00394">ImpaladCatalog.java:394</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogException_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogException.html">com.cloudera.impala.catalog.CatalogException</a></div><div class="ttdef"><b>Definition:</b> <a href="CatalogException_8java_source.html#l00022">CatalogException.java:22</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_afd42c0f57077c1d1b593684a1abe99ba"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#afd42c0f57077c1d1b593684a1abe99ba">com.cloudera.impala.catalog.ImpaladCatalog.INITIAL_CATALOG_SERVICE_ID</a></div><div class="ttdeci">static final TUniqueId INITIAL_CATALOG_SERVICE_ID</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00066">ImpaladCatalog.java:66</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a7c3a2e34d33a9301ab8b6ff0de65d293"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a7c3a2e34d33a9301ab8b6ff0de65d293">com.cloudera.impala.catalog.ImpaladCatalog.addDataSource</a></div><div class="ttdeci">void addDataSource(TDataSource thrift, long catalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00377">ImpaladCatalog.java:377</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool_html_a3ec8ab96822a8f274293c248ce91b7d9"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1HdfsCachePool.html#a3ec8ab96822a8f274293c248ce91b7d9">com.cloudera.impala.catalog.HdfsCachePool.getCatalogVersion</a></div><div class="ttdeci">long getCatalogVersion()</div><div class="ttdef"><b>Definition:</b> <a href="HdfsCachePool_8java_source.html#l00057">HdfsCachePool.java:57</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1CatalogDeltaLog.html">com.cloudera.impala.catalog.CatalogDeltaLog</a></div><div class="ttdef"><b>Definition:</b> <a href="CatalogDeltaLog_8java_source.html#l00043">CatalogDeltaLog.java:43</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a29ab482e32765cbc83a9b4d917611cd5"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a29ab482e32765cbc83a9b4d917611cd5">com.cloudera.impala.catalog.ImpaladCatalog.lastSyncedCatalogVersion_</a></div><div class="ttdeci">long lastSyncedCatalogVersion_</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00076">ImpaladCatalog.java:76</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_adb4e17042aac6b024f94a0fde75af462"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#adb4e17042aac6b024f94a0fde75af462">com.cloudera.impala.catalog.ImpaladCatalog.removeFunction</a></div><div class="ttdeci">void removeFunction(TFunction thriftFn, long dropCatalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00405">ImpaladCatalog.java:405</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Db.html">com.cloudera.impala.catalog.Db</a></div><div class="ttdef"><b>Definition:</b> <a href="Db_8java_source.html#l00044">Db.java:44</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a6e34c2bdb539742800ca535c31a57ab5"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a6e34c2bdb539742800ca535c31a57ab5">com.cloudera.impala.catalog.ImpaladCatalog.removeDb</a></div><div class="ttdeci">void removeDb(TDatabase thriftDb, long dropCatalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00387">ImpaladCatalog.java:387</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1RolePrivilege_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1RolePrivilege.html">com.cloudera.impala.catalog.RolePrivilege</a></div><div class="ttdef"><b>Definition:</b> <a href="RolePrivilege_8java_source.html#l00033">RolePrivilege.java:33</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog_html_a7d121b32b2a0b0a720520e286998ee21"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Catalog.html#a7d121b32b2a0b0a720520e286998ee21">com.cloudera.impala.catalog.Catalog.getMetaStoreClient</a></div><div class="ttdeci">MetaStoreClient getMetaStoreClient()</div><div class="ttdef"><b>Definition:</b> <a href="Catalog_8java_source.html#l00326">Catalog.java:326</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a9d385ff60501b513fdb04d1816fd49de"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a9d385ff60501b513fdb04d1816fd49de">com.cloudera.impala.catalog.ImpaladCatalog.removePrivilege</a></div><div class="ttdeci">void removePrivilege(TPrivilege thriftPrivilege, long dropCatalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00426">ImpaladCatalog.java:426</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1TableLoadingException_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1TableLoadingException.html">com.cloudera.impala.catalog.TableLoadingException</a></div><div class="ttdef"><b>Definition:</b> <a href="TableLoadingException_8java_source.html#l00021">TableLoadingException.java:21</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1MetaStoreClientPool_1_1MetaStoreClient_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1MetaStoreClientPool_1_1MetaStoreClient.html">com.cloudera.impala.catalog.MetaStoreClientPool.MetaStoreClient</a></div><div class="ttdef"><b>Definition:</b> <a href="MetaStoreClientPool_8java_source.html#l00049">MetaStoreClientPool.java:49</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_ae85932a2f39a1ff03505b6211dc6b8ea"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#ae85932a2f39a1ff03505b6211dc6b8ea">com.cloudera.impala.catalog.ImpaladCatalog.waitForCatalogUpdate</a></div><div class="ttdeci">void waitForCatalogUpdate(long timeoutMs)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00164">ImpaladCatalog.java:164</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException_html"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1common_1_1ImpalaException.html">com.cloudera.impala.common.ImpalaException</a></div><div class="ttdef"><b>Definition:</b> <a href="ImpalaException_8java_source.html#l00022">ImpalaException.java:22</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog_html_a8639266ae9f3ea363ded8ac388f38c46"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1ImpaladCatalog.html#a8639266ae9f3ea363ded8ac388f38c46">com.cloudera.impala.catalog.ImpaladCatalog.addDb</a></div><div class="ttdeci">void addDb(TDatabase thriftDb, long catalogVersion)</div><div class="ttdef"><b>Definition:</b> <a href="ImpaladCatalog_8java_source.html#l00338">ImpaladCatalog.java:338</a></div></div>
<div class="ttc" id="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table_html_a1cf86992d49453aecc5a843d2c7ad78f"><div class="ttname"><a href="classcom_1_1cloudera_1_1impala_1_1catalog_1_1Table.html#a1cf86992d49453aecc5a843d2c7ad78f">com.cloudera.impala.catalog.Table.isLoaded</a></div><div class="ttdeci">boolean isLoaded()</div><div class="ttdef"><b>Definition:</b> <a href="Table_8java_source.html#l00416">Table.java:416</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_ca2797c59c2e868cd2eca72571423f6a.html">fe</a></li><li class="navelem"><a class="el" href="dir_9456c03c9c6e5a96e843b28fc5c6395b.html">src</a></li><li class="navelem"><a class="el" href="dir_31c8d7a6e8855be2d8d6fa4227c487c3.html">main</a></li><li class="navelem"><a class="el" href="dir_d2615d3423c50009d0fa2801d3e0150c.html">java</a></li><li class="navelem"><a class="el" href="dir_df2af9fb37a2f3aedd0dd3e7b116eedc.html">com</a></li><li class="navelem"><a class="el" href="dir_48ee7e70be44cce637301d7ac948c4e1.html">cloudera</a></li><li class="navelem"><a class="el" href="dir_c062777d65f1b5dc463ca31df638b83a.html">impala</a></li><li class="navelem"><a class="el" href="dir_3961720ebee40fc7eeb8c4cf66135aca.html">catalog</a></li><li class="navelem"><a class="el" href="ImpaladCatalog_8java.html">ImpaladCatalog.java</a></li>
    <li class="footer">Generated on Thu May 7 2015 16:10:38 for Impala by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
